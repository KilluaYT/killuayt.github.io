(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{"+AAq":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("Hs9Z"),i=s("/G9H"),n=s("yun6");const o=e=>{const{beatmap:t,modifier:s,showConvertMode:o=!1,showTitle:a=!0}=e,l=Object(n.e)(t.difficulty_rating),c=t.convert&&!o?"osu":t.mode;let u="beatmap-icon";null!=s&&(u+=` beatmap-icon--${s}`),a&&(u+=" beatmap-icon--with-hover js-beatmap-tooltip");const d={"--diff":Object(n.d)(t.difficulty_rating)};return i.createElement("div",{className:u,"data-beatmap-title":a?t.version:null,"data-difficulty":l,"data-stars":r.round(t.difficulty_rating,2),style:d},i.createElement("i",{className:`fal fa-extra-mode-${c}`}))}},"+bOe":function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return o}));var r=s("/DQ7");function i(){o(!1)}function n(){o(!0)}function o(e,t){const s=document.querySelector(".js-blackout");s instanceof HTMLElement&&(s.style.opacity=e&&null!=t?String(t):"",Object(r.c)(s,e))}},"+kdZ":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return n}));var r=s("is6n");function i(e){var t;if(!(e instanceof HTMLElement))return;const s=null!==(t=e.closest(".js-forum-post"))&&void 0!==t?t:e.closest("form");if(!(s instanceof HTMLElement))return;const r=s.querySelector("[name=body]");return r instanceof HTMLTextAreaElement?r:void 0}class n{constructor(){Object.defineProperty(this,"handleClear",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{this.clearInput(i(t))}}),Object.defineProperty(this,"handlePageLoad",{enumerable:!0,configurable:!0,writable:!0,value:()=>{for(const e of document.querySelectorAll(".js-forum-post-input"))this.handleRestore(null,e)}}),Object.defineProperty(this,"handlePostSaved",{enumerable:!0,configurable:!0,writable:!0,value:e=>{this.clearInput(i(e.target))}}),Object.defineProperty(this,"handleRestore",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{const s=i(t);if(null==s)return;const n=this.getKeyFromInput(s);if(null==n)return;const o=localStorage.getItem(n);if(null!=o&&(s.value=o),n.startsWith("forum-post-input:topic:")){const e=`forum-topic-reply--${Object(r.a)().pathname}--text`,t=localStorage.getItem(e);null!=t&&(localStorage.removeItem(e),localStorage.setItem(n,t),s.value=t)}}}),Object.defineProperty(this,"onInput",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=e.currentTarget;if(!(t instanceof HTMLTextAreaElement))return;const s=this.getKeyFromInput(t);null!=s&&(""===t.value?localStorage.removeItem(s):localStorage.setItem(s,t.value))}}),e(document).on("input change",".js-forum-post-input",this.onInput).on("turbolinks:load",this.handlePageLoad).on("ajax:success",".js-forum-post-input--form",this.handlePostSaved),e.subscribe("forum-post-input:restore",this.handleRestore),e.subscribe("forum-post-input:clear",this.handleClear)}clearInput(e){if(null==e)return;const t=this.getKeyFromInput(e);null!=t&&localStorage.removeItem(t)}getKeyFromInput(e){return this.prefixKey(e.dataset.forumPostInputId)}prefixKey(e){if(null!=e&&""!==e)return`forum-post-input:${e}`}}}).call(this,s("5wds"))},"/DQ7":function(e,t,s){"use strict";function r(e){null==e||e.setAttribute("data-visibility","visible")}function i(e){null==e||e.setAttribute("data-visibility","hidden")}function n(e,t){if(null==e)return;((null!=t?t:!function(e){return"hidden"!==(null==e?void 0:e.getAttribute("data-visibility"))}(e))?r:i)(e)}s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return n}))},"/cCk":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("f4vq"),i=s("/G9H"),n=s("cX0L");class o extends i.PureComponent{constructor(){super(...arguments),Object.defineProperty(this,"eventId",{enumerable:!0,configurable:!0,writable:!0,value:`admin-menu-${Object(n.a)()}`})}render(){var e;if(!(null===(e=r.a.currentUser)||void 0===e?void 0:e.is_admin))return null;const t=this.props.items.map(e=>i.createElement(e.component,Object.assign({key:`${e.icon}-${e.text}`,className:"admin-menu-item"},e.props),i.createElement("span",{className:"admin-menu-item__content"},i.createElement("span",{className:"admin-menu-item__label admin-menu-item__label--icon"},i.createElement("span",{className:e.icon})),i.createElement("span",{className:"admin-menu-item__label admin-menu-item__label--text"},e.text))));return i.createElement("div",{className:"admin-menu"},i.createElement("button",{className:"admin-menu__button js-menu","data-menu-target":`admin-menu-${this.eventId}`},i.createElement("span",{className:"fas fa-angle-up"}),i.createElement("span",{className:"admin-menu__button-icon fas fa-tools"})),i.createElement("div",{className:"admin-menu__menu js-menu","data-menu-id":`admin-menu-${this.eventId}`,"data-visibility":"hidden"},t))}}},"/cS6":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var r=s("sHNI"),i=s("Hs9Z"),n=s("vcN5"),o=s("/G9H"),a=s("tSlR"),l=s("dTpI"),c=s("cX0L"),u=s("ss8h");class d extends o.Component{constructor(e){super(e),Object.defineProperty(this,"bn",{enumerable:!0,configurable:!0,writable:!0,value:"beatmap-discussion-editor-insertion-menu"}),Object.defineProperty(this,"eventId",{enumerable:!0,configurable:!0,writable:!0,value:`editor-insertion-menu-${Object(c.a)()}`}),Object.defineProperty(this,"hideInsertMenuTimer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hoveredBlock",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"insertPosition",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"insertRef",{enumerable:!0,configurable:!0,writable:!0,value:o.createRef()}),Object.defineProperty(this,"mouseOver",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scrollContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"throttledContainerMouseExit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"throttledContainerMouseMove",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"throttledMenuMouseEnter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"throttledMenuMouseExit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"throttledScroll",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"containerMouseMove",{enumerable:!0,configurable:!0,writable:!0,value:e=>{if(!e.originalEvent)return;const t=e.originalEvent.clientY,s=this.scrollContainer.children[0].children;let r=0;for(const n of s){if(t<n.getBoundingClientRect().top){if(r>0){const e=s[r-1];t<e.getBoundingClientRect().top+e.getBoundingClientRect().height/2&&r--}break}r<s.length-1&&r++}this.hoveredBlock=s[r];const i=this.hoveredBlock.getBoundingClientRect();t>i.top+i.height/2?this.insertPosition="below":this.insertPosition="above",this.updatePosition(),this.showMenu(),this.startHideTimer()}}),Object.defineProperty(this,"forceHideMenu",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.mouseOver=!1,this.hideMenu()}}),Object.defineProperty(this,"hideMenu",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.insertRef.current&&!this.mouseOver&&(this.insertRef.current.style.display="none")}}),Object.defineProperty(this,"insertBlock",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t,s,r,i,n,o;const c=this.context,u=null===(t=this.hoveredBlock)||void 0===t?void 0:t.lastChild,d=e.currentTarget.dataset.discussionType,p=null===(s=this.props.currentBeatmap)||void 0===s?void 0:s.id;let m;switch(d){case"suggestion":case"problem":case"praise":m={beatmapId:p,children:[{text:""}],discussionType:d,type:"embed"};break;case"paragraph":m={children:[{text:""}],type:"paragraph"}}if(!m||!u)return;let h,b=l.b.toSlateNode(c,u);if(a.g.isText(b)&&""===b.text||a.b.isElement(b)&&a.a.isEmpty(c,b))if("above"===this.insertPosition){const e=null===(i=null===(r=this.hoveredBlock)||void 0===r?void 0:r.previousSibling)||void 0===i?void 0:i.lastChild;null!=e?(b=l.b.toSlateNode(c,e),h=a.a.end(c,l.b.findPath(c,b))):h={offset:0,path:[]}}else{const e=null===(o=null===(n=this.hoveredBlock)||void 0===n?void 0:n.previousSibling)||void 0===o?void 0:o.lastChild;null!=e?(b=l.b.toSlateNode(c,e),h=a.a.start(c,l.b.findPath(c,b))):h=a.a.end(c,[])}else{const e=l.b.findPath(c,b);h="above"===this.insertPosition?a.a.start(c,e):a.a.end(c,e)}a.h.insertNodes(c,m,{at:h})}}),Object.defineProperty(this,"insertButton",{enumerable:!0,configurable:!0,writable:!0,value:e=>{let t="fas fa-question";switch(e){case"praise":case"problem":case"suggestion":t=r.a[e];break;case"paragraph":t="fas fa-indent"}return o.createElement("button",{className:`${this.bn}__menu-button ${this.bn}__menu-button--${e}`,"data-discussion-type":e,onClick:this.insertBlock,title:osu.trans(`beatmaps.discussions.review.insert-block.${e}`),type:"button"},o.createElement("i",{className:t}))}}),Object.defineProperty(this,"menuMouseEnter",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.mouseOver=!0}}),Object.defineProperty(this,"menuMouseLeave",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.mouseOver=!1,this.startHideTimer()}}),this.throttledContainerMouseExit=Object(i.throttle)(()=>{setTimeout(this.hideMenu,100)},10),this.throttledContainerMouseMove=Object(i.throttle)(this.containerMouseMove,10),this.throttledMenuMouseEnter=Object(i.throttle)(this.menuMouseEnter,10),this.throttledMenuMouseExit=Object(i.throttle)(this.menuMouseLeave,10),this.throttledScroll=Object(i.throttle)(this.forceHideMenu,10)}componentDidMount(){this.insertRef.current&&(e(this.insertRef.current).on(`mouseenter.${this.eventId}`,this.throttledMenuMouseEnter),e(this.insertRef.current).on(`mouseleave.${this.eventId}`,this.throttledMenuMouseExit)),e(window).on(`scroll.${this.eventId}`,this.throttledScroll)}componentDidUpdate(){this.forceHideMenu()}componentWillUnmount(){e(window).off(`.${this.eventId}`),this.scrollContainer&&e(this.scrollContainer).off(`.${this.eventId}`),this.insertRef.current&&e(this.insertRef.current).off(`.${this.eventId}`)}render(){return o.createElement(n.a,null,o.createElement("div",{ref:this.insertRef,className:`${this.bn}`},o.createElement("div",{className:`${this.bn}__body`},o.createElement("i",{className:"fas fa-plus"}),o.createElement("div",{className:`${this.bn}__buttons`},this.insertButton("suggestion"),this.insertButton("problem"),this.insertButton("praise"),this.insertButton("paragraph")))))}setScrollContainer(t){this.scrollContainer&&e(this.scrollContainer).off(`.${this.eventId}`),this.scrollContainer=t,e(this.scrollContainer).on(`mousemove.${this.eventId}`,this.throttledContainerMouseMove),e(this.scrollContainer).on(`mouseleave.${this.eventId}`,this.throttledContainerMouseExit),e(this.scrollContainer).on(`scroll.${this.eventId}`,this.throttledScroll)}showMenu(){this.insertRef.current&&(this.insertRef.current.style.display="flex")}startHideTimer(){this.hideInsertMenuTimer&&window.clearTimeout(this.hideInsertMenuTimer),this.hideInsertMenuTimer=window.setTimeout(this.hideMenu,2e3)}updatePosition(){if(!this.scrollContainer||!this.hoveredBlock||!this.insertRef.current)return;const e=this.hoveredBlock.getBoundingClientRect(),t=this.scrollContainer.getBoundingClientRect();this.insertRef.current.style.left=`${t.left+15}px`,this.insertRef.current.style.width=`${t.width-30}px`,"above"===this.insertPosition?this.insertRef.current.style.top=`${e.top-10}px`:"below"===this.insertPosition&&(this.insertRef.current.style.top=`${e.top+e.height-10}px`)}}Object.defineProperty(d,"contextType",{enumerable:!0,configurable:!0,writable:!0,value:u.a})}).call(this,s("5wds"))},"/ijE":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("9JFa"),i=s("0h6b"),n=s("/G9H");function o({banner:e}){return null==e?null:n.createElement("a",{className:"profile-tournament-banner",href:Object(i.route)("tournaments.show",{tournament:e.tournament_id})},n.createElement(r.a,{className:"profile-tournament-banner__image",src:e.image}))}},"/jJF":function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return o})),s.d(t,"c",(function(){return a})),s.d(t,"d",(function(){return l}));var r=s("f4vq"),i=s("phBA");const n=(e,t,s)=>{"abort"!==t&&(r.a.userLogin.showOnError(e,s)||r.a.userVerification.showOnError(e,s)||osu.popup(osu.xhrErrorMessage(e),"danger"))},o=(e,t)=>{n(t.jqXHR,t.textStatus,()=>{var e;return null===(e=t.submit)||void 0===e?void 0:e.call(t)})},a=e=>(t,s)=>{n(t,s,e)},l=e=>a(Object(i.c)(e))},"0VTr":function(e,t,s){"use strict";(function(e){var r=s("QUfv"),i=s("G27q"),n=s("WLnA"),o=s("0h6b"),a=s("Hs9Z"),l=s("lv9K"),c=s("f4vq"),u=s("tz7b"),d=s("8gxX"),p=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let m=class{constructor(){Object.defineProperty(this,"connectionStatus",{enumerable:!0,configurable:!0,writable:!0,value:"disconnected"}),Object.defineProperty(this,"hasConnectedOnce",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"userId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"active",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"endpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"retryDelay",{enumerable:!0,configurable:!0,writable:!0,value:new d.a}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"ws",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"xhr",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"xhrLoadingState",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"handleNewEvent",{enumerable:!0,configurable:!0,writable:!0,value:t=>{const s=this.parseMessageEvent(t);null!=s&&((e=>"logout"===e.event)(s)?(this.destroy(),c.a.userLoginObserver.logout()):(e=>"verified"===e.event)(s)?e.publish("user-verification:success"):Object(n.a)(new u.a(s)))}}),Object.defineProperty(this,"reconnectWebSocket",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.connectionStatus="disconnected",this.active&&(this.timeout.connectWebSocket=window.setTimeout(Object(l.f)(()=>{this.ws=null,this.connectWebSocket()}),this.retryDelay.get()))}}),Object.defineProperty(this,"startWebSocket",{enumerable:!0,configurable:!0,writable:!0,value:()=>{if(null!=this.endpoint)return this.connectWebSocket();this.xhrLoadingState.startWebSocket||(window.clearTimeout(this.timeout.startWebSocket),this.xhrLoadingState.startWebSocket=!0,this.xhr.startWebSocket=e.get(Object(o.route)("notifications.endpoint")).always(Object(l.f)(()=>{this.xhrLoadingState.startWebSocket=!1})).done(Object(l.f)(e=>{this.retryDelay.reset(),this.endpoint=e.url,this.connectWebSocket()})).fail(Object(l.f)(e=>{401!==e.status?this.timeout.startWebSocket=window.setTimeout(this.startWebSocket,this.retryDelay.get()):this.destroy()})))}}),Object(l.p)(this),Object(l.t)(()=>this.isConnected,e=>Object(n.a)(new i.a(e)),{fireImmediately:!0})}get isConnected(){return"connected"===this.connectionStatus}boot(){this.active=null!=this.userId,this.active&&this.startWebSocket()}handleDispatchAction(e){var t,s;(null===(t=this.ws)||void 0===t?void 0:t.readyState)===WebSocket.OPEN&&e instanceof r.a&&(null===(s=this.ws)||void 0===s||s.send(JSON.stringify(e.message)))}setUserId(e){e!==this.userId&&(this.active&&this.destroy(),this.userId=e,this.boot())}connectWebSocket(){if(!this.active||null==this.endpoint||null!=this.ws)return;this.connectionStatus="connecting",window.clearTimeout(this.timeout.connectWebSocket);const e=document.querySelector("meta[name=csrf-token]");if(null==e)return;const t=e.getAttribute("content");this.ws=new WebSocket(`${this.endpoint}?csrf=${t}`),this.ws.addEventListener("open",Object(l.f)(()=>{this.retryDelay.reset(),this.connectionStatus="connected",this.hasConnectedOnce=!0})),this.ws.addEventListener("close",this.reconnectWebSocket),this.ws.addEventListener("message",this.handleNewEvent)}destroy(){this.connectionStatus="disconnecting",this.userId=null,this.active=!1,Object(a.forEach)(this.xhr,e=>null==e?void 0:e.abort()),Object(a.forEach)(this.timeout,e=>window.clearTimeout(e)),null!=this.ws&&(this.ws.close(),this.ws=null),this.connectionStatus="disconnected"}parseMessageEvent(e){try{const t=JSON.parse(e.data);if(Object(u.b)(t))return t;console.debug("message missing event type.")}catch(t){console.debug("Failed parsing data:",e.data)}}};p([l.q],m.prototype,"connectionStatus",void 0),p([l.q],m.prototype,"hasConnectedOnce",void 0),p([l.q],m.prototype,"active",void 0),p([l.h],m.prototype,"isConnected",null),p([l.f],m.prototype,"connectWebSocket",null),p([l.f],m.prototype,"destroy",null),p([l.f],m.prototype,"reconnectWebSocket",void 0),m=p([n.b],m),t.a=m}).call(this,s("5wds"))},"0e0v":function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var r=s("jEEn"),i=s("0h6b"),n=s("Hs9Z"),o=s("f4vq"),a=s("/G9H"),l=s("uWCK"),c=s("AJEZ");function u(){}class d extends a.PureComponent{render(){var e,t,s;const u=a.createElement(l.a,{modifiers:["full"],user:this.props.user});return a.createElement("div",{className:"profile-info"},a.createElement("div",{className:"profile-info__bg",style:{backgroundImage:osu.urlPresence(this.props.coverUrl)}}),this.props.user.id===(null===(e=o.a.currentUser)||void 0===e?void 0:e.id)?a.createElement("a",{className:"profile-info__avatar",href:`${Object(i.route)("account.edit")}#avatar`,title:osu.trans("users.show.change_avatar")},u):a.createElement("div",{className:"profile-info__avatar"},u),a.createElement("div",{className:"profile-info__details"},a.createElement("h1",{className:"profile-info__name"},a.createElement("span",{className:"u-ellipsis-pre-overflow"},this.props.user.username),a.createElement("div",{className:"profile-info__previous-usernames"},this.previousUsernames())),this.renderTitle(),a.createElement("div",{className:"profile-info__icon-group"},a.createElement("div",{className:"profile-info__icons"},this.props.user.is_supporter&&a.createElement("span",{className:"profile-info__icon profile-info__icon--supporter",title:osu.trans("users.show.is_supporter")},n(this.props.user.support_level).times(e=>a.createElement("span",{key:e,className:"fas fa-heart"}))),a.createElement(c.a,{groups:this.props.user.groups,modifiers:"profile-page",wrapper:"profile-info__icon"})),a.createElement("div",{className:"profile-info__icons profile-info__icons--flag"},null!=(null===(t=this.props.user.country)||void 0===t?void 0:t.code)&&a.createElement("a",{className:"profile-info__flag profile-info__flag--country",href:Object(i.route)("rankings",{country:this.props.user.country.code,mode:this.props.currentMode,type:"performance"})},a.createElement("span",{className:"profile-info__flag-flag"},a.createElement(r.a,{country:this.props.user.country})),a.createElement("span",{className:"profile-info__flag-text"},this.props.user.country.name))))),a.createElement("div",{className:"profile-info__bar hidden-xs",style:{backgroundColor:null!==(s=this.props.user.profile_colour)&&void 0!==s?s:""}}))}renderTitle(){var e;if(null==this.props.user.title)return null;const t={children:this.props.user.title,className:"profile-info__title",style:{color:null!==(e=this.props.user.profile_colour)&&void 0!==e?e:void 0}};return null!=this.props.user.title_url?a.createElement("a",Object.assign({href:this.props.user.title_url},t)):a.createElement("span",Object.assign({},t))}previousUsernames(){if(null==this.props.user.previous_usernames||0===this.props.user.previous_usernames.length)return null;const e=this.props.user.previous_usernames.join(", ");return a.createElement("div",{className:"profile-previous-usernames"},a.createElement("a",{className:"profile-previous-usernames__icon profile-previous-usernames__icon--with-title",onClick:u,title:`${osu.trans("users.show.previous_usernames")}: ${e}`},a.createElement("span",{className:"fas fa-address-card"})),a.createElement("div",{className:"profile-previous-usernames__icon profile-previous-usernames__icon--plain"},a.createElement("span",{className:"fas fa-address-card"})),a.createElement("div",{className:"profile-previous-usernames__content"},a.createElement("div",{className:"profile-previous-usernames__title"},osu.trans("users.show.previous_usernames")),a.createElement("div",{className:"profile-previous-usernames__names"},e)))}}},"0h6b":function(e,t,s){"use strict";s.r(t),s.d(t,"route",(function(){return I})),s.d(t,"link_to_route",(function(){return A}));var r=s("Hs9Z"),i=s("is6n");const n={url:"https://osu.ppy.sh",port:null,defaults:{},routes:{"admin.beatmapsets.covers":{uri:"admin/beatmapsets/{beatmapset}/covers",methods:["GET","HEAD"]},"admin.beatmapsets.covers.regenerate":{uri:"admin/beatmapsets/{beatmapset}/covers/regenerate",methods:["POST"]},"admin.beatmapsets.covers.remove":{uri:"admin/beatmapsets/{beatmapset}/covers/remove",methods:["POST"]},"admin.beatmapsets.show":{uri:"admin/beatmapsets/{beatmapset}",methods:["GET","HEAD"]},"admin.beatmapsets.update":{uri:"admin/beatmapsets/{beatmapset}",methods:["PUT","PATCH"]},"admin.contests.get-zip":{uri:"admin/contests/{contest}/zip",methods:["POST"]},"admin.contests.index":{uri:"admin/contests",methods:["GET","HEAD"]},"admin.contests.show":{uri:"admin/contests/{contest}",methods:["GET","HEAD"]},"admin.user-contest-entries.destroy":{uri:"admin/user-contest-entries/{user_contest_entry}",methods:["DELETE"]},"admin.user-contest-entries.restore":{uri:"admin/user-contest-entries/{user_contest_entry}/restore",methods:["POST"]},"admin.logs.index":{uri:"admin/logs",methods:["GET","HEAD"]},"admin.root":{uri:"admin",methods:["GET","HEAD"]},"admin.forum.forum-covers.index":{uri:"admin/forum/forum-covers",methods:["GET","HEAD"]},"admin.forum.forum-covers.store":{uri:"admin/forum/forum-covers",methods:["POST"]},"admin.forum.forum-covers.update":{uri:"admin/forum/forum-covers/{forum_cover}",methods:["PUT","PATCH"]},"artists.tracks.index":{uri:"beatmaps/artists/tracks",methods:["GET","HEAD"]},"artists.index":{uri:"beatmaps/artists",methods:["GET","HEAD"]},"artists.show":{uri:"beatmaps/artists/{artist}",methods:["GET","HEAD"]},"tracks.show":{uri:"beatmaps/artists/tracks/{track}",methods:["GET","HEAD"]},"packs.index":{uri:"beatmaps/packs",methods:["GET","HEAD"]},"packs.show":{uri:"beatmaps/packs/{pack}",methods:["GET","HEAD"]},"packs.raw":{uri:"beatmaps/packs/{pack}/raw",methods:["GET","HEAD"]},"beatmaps.":{uri:"beatmaps/{beatmap}/scores/users/{user}",methods:["GET","HEAD"]},"beatmaps.scores":{uri:"beatmaps/{beatmap}/scores",methods:["GET","HEAD"]},"beatmaps.update-owner":{uri:"beatmaps/{beatmap}/update-owner",methods:["PUT"]},"beatmaps.show":{uri:"beatmaps/{beatmap}",methods:["GET","HEAD"]},"redirect:beatmapsets.discussions.index":{uri:"beatmapsets/beatmap-discussions",methods:["GET","HEAD"]},"redirect:beatmapsets.discussions.destroy":{uri:"beatmapsets/beatmap-discussions/{beatmap_discussion}",methods:["DELETE"]},"redirect:beatmapsets.discussions.show":{uri:"beatmapsets/beatmap-discussions/{beatmap_discussion}",methods:["GET","HEAD"]},"redirect:beatmapsets.discussions.vote":{uri:"beatmapsets/beatmap-discussions/{beatmap_discussion}/vote",methods:["PUT"]},"redirect:beatmapsets.discussions.restore":{uri:"beatmapsets/beatmap-discussions/{beatmap_discussion}/restore",methods:["POST"]},"redirect:beatmapsets.discussions.deny-kudosu":{uri:"beatmapsets/beatmap-discussions/{beatmap_discussion}/deny-kudosu",methods:["POST"]},"redirect:beatmapsets.discussions.allow-kudosu":{uri:"beatmapsets/beatmap-discussions/{beatmap_discussion}/allow-kudosu",methods:["POST"]},"redirect:beatmapsets.discussions.posts.destroy":{uri:"beatmapsets/beatmap-discussion-posts/{beatmap_discussion_post}",methods:["DELETE"]},"redirect:beatmapsets.discussions.posts.store":{uri:"beatmapsets/beatmap-discussion-posts/{beatmap_discussion_post}",methods:["POST"]},"redirect:beatmapsets.discussions.posts.update":{uri:"beatmapsets/beatmap-discussion-posts/{beatmap_discussion_post}",methods:["PUT"]},"redirect:beatmapsets.discussions.posts.restore":{uri:"beatmapsets/beatmap-discussion-posts/{beatmap_discussion_post}/restore",methods:["POST"]},"redirect:beatmapsets.discussions.posts.index":{uri:"beatmapsets/beatmap-discussion-posts",methods:["GET","HEAD"]},"beatmapsets.events.index":{uri:"beatmapsets/events",methods:["GET","HEAD"]},"beatmapsets.redirect:follows.index":{uri:"beatmapsets/watches",methods:["GET","HEAD"]},"beatmapsets.watches.update":{uri:"beatmapsets/watches/{watch}",methods:["PUT","PATCH"]},"beatmapsets.watches.destroy":{uri:"beatmapsets/watches/{watch}",methods:["DELETE"]},"beatmapsets.discussions.vote":{uri:"beatmapsets/discussions/{discussion}/vote",methods:["PUT"]},"beatmapsets.discussions.restore":{uri:"beatmapsets/discussions/{discussion}/restore",methods:["POST"]},"beatmapsets.discussions.deny-kudosu":{uri:"beatmapsets/discussions/{discussion}/deny-kudosu",methods:["POST"]},"beatmapsets.discussions.allow-kudosu":{uri:"beatmapsets/discussions/{discussion}/allow-kudosu",methods:["POST"]},"beatmapsets.discussions.posts.restore":{uri:"beatmapsets/discussions/posts/{post}/restore",methods:["POST"]},"beatmapsets.discussions.posts.index":{uri:"beatmapsets/discussions/posts",methods:["GET","HEAD"]},"beatmapsets.discussions.posts.store":{uri:"beatmapsets/discussions/posts",methods:["POST"]},"beatmapsets.discussions.posts.show":{uri:"beatmapsets/discussions/posts/{post}",methods:["GET","HEAD"]},"beatmapsets.discussions.posts.update":{uri:"beatmapsets/discussions/posts/{post}",methods:["PUT","PATCH"]},"beatmapsets.discussions.posts.destroy":{uri:"beatmapsets/discussions/posts/{post}",methods:["DELETE"]},"beatmapsets.discussions.votes.index":{uri:"beatmapsets/discussions/votes",methods:["GET","HEAD"]},"beatmapsets.discussions.index":{uri:"beatmapsets/discussions",methods:["GET","HEAD"]},"beatmapsets.discussions.show":{uri:"beatmapsets/discussions/{discussion}",methods:["GET","HEAD"]},"beatmapsets.discussions.destroy":{uri:"beatmapsets/discussions/{discussion}",methods:["DELETE"]},"beatmapsets.favourites.store":{uri:"beatmapsets/{beatmapset}/favourites",methods:["POST"]},"beatmapsets.search":{uri:"beatmapsets/search/{filters?}",methods:["GET","HEAD"]},"beatmapsets.discussion":{uri:"beatmapsets/{beatmapset}/discussion/{beatmap?}/{mode?}/{filter?}",methods:["GET","HEAD"]},"beatmapsets.discussion.review":{uri:"beatmapsets/{beatmapset}/discussion/review",methods:["POST"]},"beatmapsets.discussion-lock":{uri:"beatmapsets/{beatmapset}/discussion-lock",methods:["POST"]},"beatmapsets.discussion-unlock":{uri:"beatmapsets/{beatmapset}/discussion-unlock",methods:["POST"]},"beatmapsets.download":{uri:"beatmapsets/{beatmapset}/download",methods:["GET","HEAD"]},"beatmapsets.love":{uri:"beatmapsets/{beatmapset}/love",methods:["PUT"]},"beatmapsets.remove-from-loved":{uri:"beatmapsets/{beatmapset}/love",methods:["DELETE"]},"beatmapsets.nominate":{uri:"beatmapsets/{beatmapset}/nominate",methods:["PUT"]},"beatmapsets.index":{uri:"beatmapsets",methods:["GET","HEAD"]},"beatmapsets.show":{uri:"beatmapsets/{beatmapset}",methods:["GET","HEAD"]},"beatmapsets.update":{uri:"beatmapsets/{beatmapset}",methods:["PUT","PATCH"]},"beatmapsets.destroy":{uri:"beatmapsets/{beatmapset}",methods:["DELETE"]},"scores.download":{uri:"scores/{mode}/{score}/download",methods:["GET","HEAD"]},"scores.show":{uri:"scores/{mode}/{score}",methods:["GET","HEAD"]},"client-verifications.create":{uri:"client-verifications/create",methods:["GET","HEAD"]},"client-verifications.store":{uri:"client-verifications",methods:["POST"]},"comments.index":{uri:"comments",methods:["GET","HEAD"]},"comments.store":{uri:"comments",methods:["POST"]},"comments.show":{uri:"comments/{comment}",methods:["GET","HEAD"]},"comments.update":{uri:"comments/{comment}",methods:["PUT","PATCH"]},"comments.destroy":{uri:"comments/{comment}",methods:["DELETE"]},"comments.pin":{uri:"comments/{comment}/pin",methods:["POST"]},"comments.restore":{uri:"comments/{comment}/restore",methods:["POST"]},"comments.vote":{uri:"comments/{comment}/vote",methods:["POST"]},"contests.index":{uri:"community/contests",methods:["GET","HEAD"]},"contests.show":{uri:"community/contests/{contest}",methods:["GET","HEAD"]},"contest-entries.vote":{uri:"community/contest-entries/{contest_entry}/vote",methods:["PUT"]},"contest-entries.store":{uri:"community/contest-entries",methods:["POST"]},"contest-entries.destroy":{uri:"community/contest-entries/{contest_entry}",methods:["DELETE"]},"livestreams.promote":{uri:"community/livestreams/promote",methods:["POST"]},"livestreams.index":{uri:"community/livestreams",methods:["GET","HEAD"]},"matches.show":{uri:"community/matches/{match}",methods:["GET","HEAD"]},"tournaments.unregister":{uri:"community/tournaments/{tournament}/unregister",methods:["POST"]},"tournaments.register":{uri:"community/tournaments/{tournament}/register",methods:["POST"]},"tournaments.index":{uri:"community/tournaments",methods:["GET","HEAD"]},"tournaments.show":{uri:"community/tournaments/{tournament}",methods:["GET","HEAD"]},"forum.forum-covers.store":{uri:"community/forums/forum-covers",methods:["POST"]},"forum.forum-covers.update":{uri:"community/forums/forum-covers/{forum_cover}",methods:["PUT","PATCH"]},"forum.forum-covers.destroy":{uri:"community/forums/forum-covers/{forum_cover}",methods:["DELETE"]},"forum.posts.raw":{uri:"community/forums/posts/{post}/raw",methods:["GET","HEAD"]},"forum.posts.restore":{uri:"community/forums/posts/{post}/restore",methods:["POST"]},"forum.posts.show":{uri:"community/forums/posts/{post}",methods:["GET","HEAD"]},"forum.posts.edit":{uri:"community/forums/posts/{post}/edit",methods:["GET","HEAD"]},"forum.posts.update":{uri:"community/forums/posts/{post}",methods:["PUT","PATCH"]},"forum.posts.destroy":{uri:"community/forums/posts/{post}",methods:["DELETE"]},"forum.topics.logs.index":{uri:"community/forums/topics/{topic}/logs",methods:["GET","HEAD"]},"forum.topics.edit-poll.store":{uri:"community/forums/topics/{topic}/edit-poll",methods:["POST"]},"forum.topics.edit-poll":{uri:"community/forums/topics/{topic}/edit-poll",methods:["GET","HEAD"]},"forum.topics.issue-tag":{uri:"community/forums/topics/{topic}/issue-tag",methods:["POST"]},"forum.topics.lock":{uri:"community/forums/topics/{topic}/lock",methods:["POST"]},"forum.topics.move":{uri:"community/forums/topics/{topic}/move",methods:["POST"]},"forum.topics.pin":{uri:"community/forums/topics/{topic}/pin",methods:["POST"]},"forum.topics.reply":{uri:"community/forums/topics/{topic}/reply",methods:["POST"]},"forum.topics.restore":{uri:"community/forums/topics/{topic}/restore",methods:["POST"]},"forum.topics.vote":{uri:"community/forums/topics/{topic}/vote",methods:["POST"]},"forum.topics.vote-feature":{uri:"community/forums/topics/{topic}/vote-feature",methods:["POST"]},"forum.preview":{uri:"community/forums/topics/preview",methods:["POST"]},"forum.topics.create":{uri:"community/forums/topics/create",methods:["GET","HEAD"]},"forum.topics.store":{uri:"community/forums/topics",methods:["POST"]},"forum.topics.show":{uri:"community/forums/topics/{topic}",methods:["GET","HEAD"]},"forum.topics.update":{uri:"community/forums/topics/{topic}",methods:["PUT","PATCH"]},"forum.topics.destroy":{uri:"community/forums/topics/{topic}",methods:["DELETE"]},"forum.topic-covers.store":{uri:"community/forums/topic-covers",methods:["POST"]},"forum.topic-covers.update":{uri:"community/forums/topic-covers/{topic_cover}",methods:["PUT","PATCH"]},"forum.topic-covers.destroy":{uri:"community/forums/topic-covers/{topic_cover}",methods:["DELETE"]},"forum.redirect:follows.index":{uri:"community/forums/topic-watches",methods:["GET","HEAD"]},"forum.topic-watches.update":{uri:"community/forums/topic-watches/{topic_watch}",methods:["PUT","PATCH"]},"forum.forums.mark-as-read":{uri:"community/forums/mark-as-read",methods:["POST"]},"forum.forums.index":{uri:"community/forums",methods:["GET","HEAD"]},"forum.forums.show":{uri:"community/forums/{forum}",methods:["GET","HEAD"]},"chat.ack":{uri:"community/chat/ack",methods:["POST"]},"chat.new":{uri:"community/chat/new",methods:["POST"]},"chat.presence":{uri:"community/chat/presence",methods:["GET","HEAD"]},"chat.updates":{uri:"community/chat/updates",methods:["GET","HEAD"]},"chat.channels.messages.index":{uri:"community/chat/channels/{channel}/messages",methods:["GET","HEAD"]},"chat.channels.messages.store":{uri:"community/chat/channels/{channel}/messages",methods:["POST"]},"chat.channels.join":{uri:"community/chat/channels/{channel}/users/{user}",methods:["PUT"]},"chat.channels.part":{uri:"community/chat/channels/{channel}/users/{user}",methods:["DELETE"]},"chat.channels.mark-as-read":{uri:"community/chat/channels/{channel}/mark-as-read/{message}",methods:["PUT"]},"chat.channels.index":{uri:"community/chat/channels",methods:["GET","HEAD"]},"chat.channels.show":{uri:"community/chat/channels/{channel}",methods:["GET","HEAD"]},"chat.index":{uri:"community/chat",methods:["GET","HEAD"]},"groups.show":{uri:"groups/{group}",methods:["GET","HEAD"]},"account.edit":{uri:"home/account/edit",methods:["GET","HEAD"]},"account.avatar":{uri:"home/account/avatar",methods:["POST"]},"account.cover":{uri:"home/account/cover",methods:["POST"]},"account.email":{uri:"home/account/email",methods:["PUT"]},"account.notification-options":{uri:"home/account/notification-options",methods:["PUT"]},"account.options":{uri:"home/account/options",methods:["PUT"]},"account.password":{uri:"home/account/password",methods:["PUT"]},"account.reissue-code":{uri:"home/account/reissue-code",methods:["POST"]},"account.sessions.destroy":{uri:"home/account/sessions/{session}",methods:["DELETE"]},"account.":{uri:"home/account/verify",methods:["GET","HEAD"]},"account.verify":{uri:"home/account/verify",methods:["POST"]},"account.update":{uri:"home/account",methods:["PUT"]},"quick-search":{uri:"home/quick-search",methods:["GET","HEAD"]},search:{uri:"home/search",methods:["GET","HEAD"]},"bbcode-preview":{uri:"home/bbcode-preview",methods:["POST"]},"changelog.build":{uri:"home/changelog/{stream}/{build}",methods:["GET","HEAD"]},"changelog.index":{uri:"home/changelog",methods:["GET","HEAD"]},"changelog.show":{uri:"home/changelog/{changelog}",methods:["GET","HEAD"]},download:{uri:"home/download",methods:["GET","HEAD"]},"set-locale":{uri:"home/set-locale",methods:["POST"]},"support-the-game":{uri:"home/support",methods:["GET","HEAD"]},testflight:{uri:"home/testflight",methods:["GET","HEAD"]},"password-reset":{uri:"home/password-reset",methods:["GET","HEAD"]},"download-quota-check":{uri:"home/download-quota-check",methods:["GET","HEAD"]},"blocks.store":{uri:"home/blocks",methods:["POST"]},"blocks.destroy":{uri:"home/blocks/{block}",methods:["DELETE"]},"friends.index":{uri:"home/friends",methods:["GET","HEAD"]},"friends.store":{uri:"home/friends",methods:["POST"]},"friends.destroy":{uri:"home/friends/{friend}",methods:["DELETE"]},"news.index":{uri:"home/news",methods:["GET","HEAD"]},"news.store":{uri:"home/news",methods:["POST"]},"news.show":{uri:"home/news/{news}",methods:["GET","HEAD"]},"news.update":{uri:"home/news/{news}",methods:["PUT","PATCH"]},"messages.users.show":{uri:"home/messages/users/{user}",methods:["GET","HEAD"]},"follows.store":{uri:"home/follows",methods:["POST"]},"follows.index":{uri:"home/follows/{subtype?}",methods:["GET","HEAD"]},"follows.destroy":{uri:"home/follows",methods:["DELETE"]},"notifications.index":{uri:"notifications",methods:["GET","HEAD"]},"notifications.endpoint":{uri:"notifications/endpoint",methods:["GET","HEAD"]},"notifications.mark-read":{uri:"notifications/mark-read",methods:["POST"]},legal:{uri:"legal/{locale?}/{path?}",methods:["GET","HEAD"]},"multiplayer.rooms.show":{uri:"multiplayer/rooms/{room}",methods:["GET","HEAD"]},"oauth.authorized-clients.destroy":{uri:"oauth/authorized-clients/{authorized_client}",methods:["DELETE"]},"oauth.clients.index":{uri:"oauth/clients",methods:["GET","HEAD"]},"oauth.clients.store":{uri:"oauth/clients",methods:["POST"]},"oauth.clients.update":{uri:"oauth/clients/{client}",methods:["PUT","PATCH"]},"oauth.clients.destroy":{uri:"oauth/clients/{client}",methods:["DELETE"]},"oauth.clients.reset-secret":{uri:"oauth/clients/{client}/reset-secret",methods:["POST"]},rankings:{uri:"rankings/{mode?}/{type?}",methods:["GET","HEAD"]},"reports.store":{uri:"reports",methods:["POST"]},login:{uri:"session",methods:["POST"]},logout:{uri:"session",methods:["DELETE"]},"users.check-username-availability":{uri:"users/check-username-availability",methods:["POST"]},"users.check-username-exists":{uri:"users/check-username-exists",methods:["POST"]},"users.disabled":{uri:"users/disabled",methods:["GET","HEAD"]},"users.card":{uri:"users/{user}/card",methods:["GET","HEAD"]},"users.page":{uri:"users/{user}/page",methods:["PUT"]},"users.multiplayer.index":{uri:"users/{user}/multiplayer",methods:["GET","HEAD"]},"users.modding.index":{uri:"users/{user}/modding",methods:["GET","HEAD"]},"users.modding.posts":{uri:"users/{user}/modding/posts",methods:["GET","HEAD"]},"users.modding.votes-given":{uri:"users/{user}/modding/votes-given",methods:["GET","HEAD"]},"users.modding.votes-received":{uri:"users/{user}/modding/votes-received",methods:["GET","HEAD"]},"users.kudosu":{uri:"users/{user}/kudosu",methods:["GET","HEAD"]},"users.recent-activity":{uri:"users/{user}/recent_activity",methods:["GET","HEAD"]},"users.scores":{uri:"users/{user}/scores/{type}",methods:["GET","HEAD"]},"users.beatmapsets":{uri:"users/{user}/beatmapsets/{type}",methods:["GET","HEAD"]},"users.posts":{uri:"users/{user}/posts",methods:["GET","HEAD"]},"users.show":{uri:"users/{user}/{mode?}",methods:["GET","HEAD"]},"users.store":{uri:"users",methods:["POST"]},"wiki.sitemap":{uri:"wiki/{locale}/Sitemap",methods:["GET","HEAD"]},"wiki.image":{uri:"wiki/images/{path}",methods:["GET","HEAD"]},"wiki.show":{uri:"wiki/{locale?}/{path?}",methods:["GET","HEAD"]},"wiki-suggestions":{uri:"wiki-suggestions",methods:["GET","HEAD"]},"store.redirect:store.products.index":{uri:"store",methods:["GET","HEAD"]},"store.products.index":{uri:"store/listing",methods:["GET","HEAD"]},"store.invoice.show":{uri:"store/invoice/{invoice}",methods:["GET","HEAD"]},"store.":{uri:"store/products/{product}/notification-request",methods:["DELETE"]},"store.notification-request":{uri:"store/products/{product}/notification-request",methods:["POST"]},"store.cart.show":{uri:"store/cart",methods:["GET","HEAD"]},"store.cart.store":{uri:"store/cart",methods:["POST"]},"store.checkout.store":{uri:"store/checkout",methods:["POST"]},"store.checkout.show":{uri:"store/checkout/{checkout}",methods:["GET","HEAD"]},"store.orders.index":{uri:"store/orders",methods:["GET","HEAD"]},"store.orders.destroy":{uri:"store/orders/{order}",methods:["DELETE"]},"store.redirect:store.products.show":{uri:"store/product/{product}",methods:["GET","HEAD"]},"store.products.show":{uri:"store/products/{product}",methods:["GET","HEAD"]},"payments.paypal.approved":{uri:"payments/paypal/approved",methods:["GET","HEAD"]},"payments.paypal.declined":{uri:"payments/paypal/declined",methods:["GET","HEAD"]},"payments.paypal.create":{uri:"payments/paypal/create",methods:["POST"]},"payments.paypal.completed":{uri:"payments/paypal/completed",methods:["GET","HEAD"]},"payments.paypal.ipn":{uri:"payments/paypal/ipn",methods:["POST"]},"payments.xsolla.completed":{uri:"payments/xsolla/completed",methods:["GET","HEAD"]},"payments.xsolla.token":{uri:"payments/xsolla/token",methods:["POST"]},"payments.xsolla.callback":{uri:"payments/xsolla/callback",methods:["POST"]},"payments.centili.callback":{uri:"payments/centili/callback",methods:["POST","GET","HEAD"]},"payments.centili.completed":{uri:"payments/centili/completed",methods:["GET","HEAD"]},"payments.centili.failed":{uri:"payments/centili/failed",methods:["GET","HEAD"]},"payments.shopify.callback":{uri:"payments/shopify/callback",methods:["POST"]},home:{uri:"home",methods:["GET","HEAD"]},"redirect:home":{uri:"/",methods:["GET","HEAD"]},"redirect:forum.posts.show":{uri:"forum/p/{post}",methods:["GET","HEAD"]},"redirect:forum.posts.show:":{uri:"po/{post}",methods:["GET","HEAD"]},"redirect:forum.topics.show":{uri:"forum/t/{topic}",methods:["GET","HEAD"]},"redirect:forum.forums.show":{uri:"forum/{forum}",methods:["GET","HEAD"]},"redirect:beatmaps.show":{uri:"b/{beatmap}",methods:["GET","HEAD"]},"redirect:groups.show":{uri:"g/{group}",methods:["GET","HEAD"]},"redirect:beatmapsets.show":{uri:"s/{beatmapset}",methods:["GET","HEAD"]},"redirect:users.show":{uri:"u/{user}",methods:["GET","HEAD"]},"redirect:forum.forums.index":{uri:"forum",methods:["GET","HEAD"]},"redirect:matches.show":{uri:"mp/{match}",methods:["GET","HEAD"]},"redirect:wiki.show":{uri:"help/wiki/{path?}",methods:["GET","HEAD"]},"api.beatmaps.lookup":{uri:"api/v2/beatmaps/lookup",methods:["GET","HEAD"]},"api.beatmaps.":{uri:"api/v2/beatmaps/{beatmap}/scores/users/{user}",methods:["GET","HEAD"]},"api.beatmaps.scores":{uri:"api/v2/beatmaps/{beatmap}/scores",methods:["GET","HEAD"]},"api.beatmaps.solo.score-tokens.store":{uri:"api/v2/beatmaps/{beatmap}/solo/scores",methods:["POST"]},"api.beatmaps.solo.scores.store":{uri:"api/v2/beatmaps/{beatmap}/solo/scores/{token}",methods:["PUT"]},"api.beatmaps.index":{uri:"api/v2/beatmaps",methods:["GET","HEAD"]},"api.beatmaps.show":{uri:"api/v2/beatmaps/{beatmap}",methods:["GET","HEAD"]},"api.beatmapsets.events.index":{uri:"api/v2/beatmapsets/events",methods:["GET","HEAD"]},"api.beatmapsets.discussions.posts.index":{uri:"api/v2/beatmapsets/discussions/posts",methods:["GET","HEAD"]},"api.beatmapsets.discussions.votes.index":{uri:"api/v2/beatmapsets/discussions/votes",methods:["GET","HEAD"]},"api.beatmapsets.discussions.index":{uri:"api/v2/beatmapsets/discussions",methods:["GET","HEAD"]},"api.beatmapsets.favourites.store":{uri:"api/v2/beatmapsets/{beatmapset}/favourites",methods:["POST"]},"api.comments.index":{uri:"api/v2/comments",methods:["GET","HEAD"]},"api.comments.store":{uri:"api/v2/comments",methods:["POST"]},"api.comments.show":{uri:"api/v2/comments/{comment}",methods:["GET","HEAD"]},"api.comments.update":{uri:"api/v2/comments/{comment}",methods:["PUT","PATCH"]},"api.comments.destroy":{uri:"api/v2/comments/{comment}",methods:["DELETE"]},"api.comments.vote":{uri:"api/v2/comments/{comment}/vote",methods:["POST"]},"api.":{uri:"api/v2/users/{user}/recent_activity",methods:["GET","HEAD"]},"api.chat.new":{uri:"api/v2/chat/new",methods:["POST"]},"api.chat.updates":{uri:"api/v2/chat/updates",methods:["GET","HEAD"]},"api.chat.presence":{uri:"api/v2/chat/presence",methods:["GET","HEAD"]},"api.chat.channels.messages.index":{uri:"api/v2/chat/channels/{channel}/messages",methods:["GET","HEAD"]},"api.chat.channels.messages.store":{uri:"api/v2/chat/channels/{channel}/messages",methods:["POST"]},"api.chat.channels.join":{uri:"api/v2/chat/channels/{channel}/users/{user}",methods:["PUT"]},"api.chat.channels.part":{uri:"api/v2/chat/channels/{channel}/users/{user}",methods:["DELETE"]},"api.chat.channels.mark-as-read":{uri:"api/v2/chat/channels/{channel}/mark-as-read/{message}",methods:["PUT"]},"api.chat.channels.index":{uri:"api/v2/chat/channels",methods:["GET","HEAD"]},"api.chat.channels.store":{uri:"api/v2/chat/channels",methods:["POST"]},"api.chat.channels.show":{uri:"api/v2/chat/channels/{channel}",methods:["GET","HEAD"]},"api.changelog.build":{uri:"api/v2/changelog/{stream}/{build}",methods:["GET","HEAD"]},"api.changelog.index":{uri:"api/v2/changelog",methods:["GET","HEAD"]},"api.changelog.show":{uri:"api/v2/changelog/{changelog}",methods:["GET","HEAD"]},"api.forum.topics.reply":{uri:"api/v2/forums/topics/{topic}/reply",methods:["POST"]},"api.forum.topics.store":{uri:"api/v2/forums/topics",methods:["POST"]},"api.forum.topics.show":{uri:"api/v2/forums/topics/{topic}",methods:["GET","HEAD"]},"api.forum.topics.update":{uri:"api/v2/forums/topics/{topic}",methods:["PUT","PATCH"]},"api.forum.posts.update":{uri:"api/v2/forums/posts/{post}",methods:["PUT","PATCH"]},"api.matches.index":{uri:"api/v2/matches",methods:["GET","HEAD"]},"api.matches.show":{uri:"api/v2/matches/{match}",methods:["GET","HEAD"]},"api.rooms.index":{uri:"api/v2/rooms/{mode?}",methods:["GET","HEAD"]},"api.rooms.join":{uri:"api/v2/rooms/{room}/users/{user}",methods:["PUT"]},"api.rooms.part":{uri:"api/v2/rooms/{room}/users/{user}",methods:["DELETE"]},"api.rooms.":{uri:"api/v2/rooms/{room}/leaderboard",methods:["GET","HEAD"]},"api.rooms.playlist.":{uri:"api/v2/rooms/{room}/playlist/{playlist}/scores/users/{user}",methods:["GET","HEAD"]},"api.rooms.playlist.scores.index":{uri:"api/v2/rooms/{room}/playlist/{playlist}/scores",methods:["GET","HEAD"]},"api.rooms.playlist.scores.store":{uri:"api/v2/rooms/{room}/playlist/{playlist}/scores",methods:["POST"]},"api.rooms.playlist.scores.show":{uri:"api/v2/rooms/{room}/playlist/{playlist}/scores/{score}",methods:["GET","HEAD"]},"api.rooms.playlist.scores.update":{uri:"api/v2/rooms/{room}/playlist/{playlist}/scores/{score}",methods:["PUT","PATCH"]},"api.reports.store":{uri:"api/v2/reports",methods:["POST"]},"api.rooms.store":{uri:"api/v2/rooms",methods:["POST"]},"api.rooms.show":{uri:"api/v2/rooms/{room}",methods:["GET","HEAD"]},"api.seasonal-backgrounds.index":{uri:"api/v2/seasonal-backgrounds",methods:["GET","HEAD"]},"api.scores.download":{uri:"api/v2/scores/{mode}/{score}/download",methods:["GET","HEAD"]},"api.scores.show":{uri:"api/v2/scores/{mode}/{score}",methods:["GET","HEAD"]},"api.beatmapsets.show":{uri:"api/v2/beatmapsets/{beatmapset}",methods:["GET","HEAD"]},"api.friends.index":{uri:"api/v2/friends",methods:["GET","HEAD"]},"api.me":{uri:"api/v2/me/{mode?}",methods:["GET","HEAD"]},"api.oauth.tokens.current":{uri:"api/v2/oauth/tokens/current",methods:["DELETE"]},"api.news.index":{uri:"api/v2/news",methods:["GET","HEAD"]},"api.news.show":{uri:"api/v2/news/{news}",methods:["GET","HEAD"]},"api.notifications.index":{uri:"api/v2/notifications",methods:["GET","HEAD"]},"api.notifications.mark-read":{uri:"api/v2/notifications/mark-read",methods:["POST"]},"api.spotlights.index":{uri:"api/v2/spotlights",methods:["GET","HEAD"]},"api.users.show":{uri:"api/v2/users/{user}/{mode?}",methods:["GET","HEAD"]},"api.users.index":{uri:"api/v2/users",methods:["GET","HEAD"]},"api.wiki.show":{uri:"api/v2/wiki/{locale}/{path}",methods:["GET","HEAD"]},"interop.":{uri:"_lio/artist-tracks/reindex-all",methods:["POST"]},"interop.user-achievement":{uri:"_lio/user-achievement/{user}/{achievement}/{beatmap?}",methods:["POST"]},"interop.users.store":{uri:"_lio/users",methods:["POST"]},"interop.beatmapsets.broadcast-new":{uri:"_lio/beatmapsets/{beatmapset}/broadcast-new",methods:["POST"]},"interop.beatmapsets.broadcast-revive":{uri:"_lio/beatmapsets/{beatmapset}/broadcast-revive",methods:["POST"]},"interop.beatmapsets.disqualify":{uri:"_lio/beatmapsets/{beatmapset}/disqualify",methods:["POST"]},"interop.beatmapsets.destroy":{uri:"_lio/beatmapsets/{beatmapset}",methods:["DELETE"]},"interop.indexing.bulk.store":{uri:"_lio/indexing/bulk",methods:["POST"]},"interop.user-groups.store":{uri:"_lio/user-group",methods:["POST"]},"interop.user-groups.destroy":{uri:"_lio/user-group",methods:["DELETE"]},"interop.user-groups.store-default":{uri:"_lio/user-default-group",methods:["POST"]},"oauth.passport.token":{uri:"oauth/token",methods:["POST"]},"oauth.authorizations.authorize":{uri:"oauth/authorize",methods:["GET","HEAD"]},"oauth.":{uri:"oauth/authorize",methods:["DELETE"]}}};function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e}).apply(this,arguments)}"undefined"!=typeof window&&void 0!==window.Ziggy&&Object.assign(n.routes,window.Ziggy.routes);var a=Object.prototype.hasOwnProperty,l=Array.isArray,c=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),u=function(e,t){for(var s=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(s[r]=e[r]);return s},d={arrayToObject:u,assign:function(e,t){return Object.keys(t).reduce((function(e,s){return e[s]=t[s],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],s=[],r=0;r<t.length;++r)for(var i=t[r],n=i.obj[i.prop],o=Object.keys(n),a=0;a<o.length;++a){var c=o[a],u=n[c];"object"==typeof u&&null!==u&&-1===s.indexOf(u)&&(t.push({obj:n,prop:c}),s.push(u))}return function(e){for(;e.length>1;){var t=e.pop(),s=t.obj[t.prop];if(l(s)){for(var r=[],i=0;i<s.length;++i)void 0!==s[i]&&r.push(s[i]);t.obj[t.prop]=r}}}(t),e},decode:function(e,t,s){var r=e.replace(/\+/g," ");if("iso-8859-1"===s)return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch(e){return r}},encode:function(e,t,s){if(0===e.length)return e;var r=e;if("symbol"==typeof e?r=Symbol.prototype.toString.call(e):"string"!=typeof e&&(r=String(e)),"iso-8859-1"===s)return escape(r).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var i="",n=0;n<r.length;++n){var o=r.charCodeAt(n);45===o||46===o||95===o||126===o||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122?i+=r.charAt(n):o<128?i+=c[o]:o<2048?i+=c[192|o>>6]+c[128|63&o]:o<55296||o>=57344?i+=c[224|o>>12]+c[128|o>>6&63]+c[128|63&o]:(o=65536+((1023&o)<<10|1023&r.charCodeAt(n+=1)),i+=c[240|o>>18]+c[128|o>>12&63]+c[128|o>>6&63]+c[128|63&o])}return i},isBuffer:function(e){return!(!e||"object"!=typeof e||!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e)))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(l(e)){for(var s=[],r=0;r<e.length;r+=1)s.push(t(e[r]));return s}return t(e)},merge:function e(t,s,r){if(!s)return t;if("object"!=typeof s){if(l(t))t.push(s);else{if(!t||"object"!=typeof t)return[t,s];(r&&(r.plainObjects||r.allowPrototypes)||!a.call(Object.prototype,s))&&(t[s]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(s);var i=t;return l(t)&&!l(s)&&(i=u(t,r)),l(t)&&l(s)?(s.forEach((function(s,i){if(a.call(t,i)){var n=t[i];n&&"object"==typeof n&&s&&"object"==typeof s?t[i]=e(n,s,r):t.push(s)}else t[i]=s})),t):Object.keys(s).reduce((function(t,i){var n=s[i];return t[i]=a.call(t,i)?e(t[i],n,r):n,t}),i)}},p=String.prototype.replace,m=/%20/g,h={RFC1738:"RFC1738",RFC3986:"RFC3986"},b=d.assign({default:h.RFC3986,formatters:{RFC1738:function(e){return p.call(e,m,"+")},RFC3986:function(e){return String(e)}}},h),f=Object.prototype.hasOwnProperty,v={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},g=Array.isArray,y=Array.prototype.push,_=function(e,t){y.apply(e,g(t)?t:[t])},w=Date.prototype.toISOString,O=b.default,j={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:d.encode,encodeValuesOnly:!1,format:O,formatter:b.formatters[O],indices:!1,serializeDate:function(e){return w.call(e)},skipNulls:!1,strictNullHandling:!1},E=function e(t,s,r,i,n,o,a,l,c,u,p,m,h){var b,f=t;if("function"==typeof a?f=a(s,f):f instanceof Date?f=u(f):"comma"===r&&g(f)&&(f=d.maybeMap(f,(function(e){return e instanceof Date?u(e):e})).join(",")),null===f){if(i)return o&&!m?o(s,j.encoder,h,"key"):s;f=""}if("string"==typeof(b=f)||"number"==typeof b||"boolean"==typeof b||"symbol"==typeof b||"bigint"==typeof b||d.isBuffer(f))return o?[p(m?s:o(s,j.encoder,h,"key"))+"="+p(o(f,j.encoder,h,"value"))]:[p(s)+"="+p(String(f))];var v,y=[];if(void 0===f)return y;if(g(a))v=a;else{var w=Object.keys(f);v=l?w.sort(l):w}for(var O=0;O<v.length;++O){var E=v[O],P=f[E];if(!n||null!==P){var k=g(f)?"function"==typeof r?r(s,E):s:s+(c?"."+E:"["+E+"]");_(y,e(P,k,r,i,n,o,a,l,c,u,p,m,h))}}return y},P=Object.prototype.hasOwnProperty,k=Array.isArray,N={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:d.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},S=function(e){return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(parseInt(t,10))}))},x=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},T=function(e,t,s,r){if(e){var i=s.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,n=/(\[[^[\]]*])/g,o=s.depth>0&&/(\[[^[\]]*])/.exec(i),a=o?i.slice(0,o.index):i,l=[];if(a){if(!s.plainObjects&&P.call(Object.prototype,a)&&!s.allowPrototypes)return;l.push(a)}for(var c=0;s.depth>0&&null!==(o=n.exec(i))&&c<s.depth;){if(c+=1,!s.plainObjects&&P.call(Object.prototype,o[1].slice(1,-1))&&!s.allowPrototypes)return;l.push(o[1])}return o&&l.push("["+i.slice(o.index)+"]"),function(e,t,s,r){for(var i=r?t:x(t,s),n=e.length-1;n>=0;--n){var o,a=e[n];if("[]"===a&&s.parseArrays)o=[].concat(i);else{o=s.plainObjects?Object.create(null):{};var l="["===a.charAt(0)&&"]"===a.charAt(a.length-1)?a.slice(1,-1):a,c=parseInt(l,10);s.parseArrays||""!==l?!isNaN(c)&&a!==l&&String(c)===l&&c>=0&&s.parseArrays&&c<=s.arrayLimit?(o=[])[c]=i:o[l]=i:o={0:i}}i=o}return i}(l,t,s,r)}};class C{constructor(e,t,s){var r;this.name=e,this.definition=t,this.bindings=null!=(r=t.bindings)?r:{},this.config=s}get template(){return`${this.config.absolute?this.definition.domain?`${this.config.url.match(/^\w+:\/\//)[0]}${this.definition.domain}${this.config.port?":"+this.config.port:""}`:this.config.url:""}/${this.definition.uri}`.replace(/\/+$/,"")}get parameterSegments(){var e,t;return null!=(e=null===(t=this.template.match(/{[^}?]+\??}/g))||void 0===t?void 0:t.map(e=>({name:e.replace(/{|\??}/g,""),required:!/\?}$/.test(e)})))?e:[]}matchesUrl(e){if(!this.definition.methods.includes("GET"))return!1;const t=this.template.replace(/\/{[^}?]*\?}/g,"(/[^/?]+)?").replace(/{[^}]+}/g,"[^/?]+").replace(/^\w+:\/\//,"");return new RegExp(`^${t}$`).test(e.replace(/\/+$/,"").split("?").shift())}compile(e){return this.parameterSegments.length?this.template.replace(/{([^}?]+)\??}/g,(t,s)=>{var r;if([null,void 0].includes(e[s])&&this.parameterSegments.find(({name:e})=>e===s).required)throw new Error(`Ziggy error: '${s}' parameter is required for route '${this.name}'.`);return encodeURIComponent(null!=(r=e[s])?r:"")}).replace(/\/+$/,""):this.template}}class M extends String{constructor(e,t,s=!0,r){var i;if(super(),this.t=null!=(i=null!=r?r:Ziggy)?i:null===globalThis||void 0===globalThis?void 0:globalThis.Ziggy,this.t=o({},this.t,{absolute:s}),e){if(!this.t.routes[e])throw new Error(`Ziggy error: route '${e}' is not in the route list.`);this.i=new C(e,this.t.routes[e],this.t),this.u=this.s(t)}}toString(){const e=Object.keys(this.u).filter(e=>!this.i.parameterSegments.some(({name:t})=>t===e)).filter(e=>"_query"!==e).reduce((e,t)=>o({},e,{[t]:this.u[t]}),{});return this.i.compile(this.u)+function(e,t){var s,r=e,i=function(e){if(!e)return j;if(null!=e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||j.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var s=b.default;if(void 0!==e.format){if(!f.call(b.formatters,e.format))throw new TypeError("Unknown format option provided.");s=e.format}var r=b.formatters[s],i=j.filter;return("function"==typeof e.filter||g(e.filter))&&(i=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:j.addQueryPrefix,allowDots:void 0===e.allowDots?j.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:j.charsetSentinel,delimiter:void 0===e.delimiter?j.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:j.encode,encoder:"function"==typeof e.encoder?e.encoder:j.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:j.encodeValuesOnly,filter:i,formatter:r,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:j.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:j.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:j.strictNullHandling}}(t);"function"==typeof i.filter?r=(0,i.filter)("",r):g(i.filter)&&(s=i.filter);var n=[];if("object"!=typeof r||null===r)return"";var o=v[t&&t.arrayFormat in v?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices"];s||(s=Object.keys(r)),i.sort&&s.sort(i.sort);for(var a=0;a<s.length;++a){var l=s[a];i.skipNulls&&null===r[l]||_(n,E(r[l],l,o,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.formatter,i.encodeValuesOnly,i.charset))}var c=n.join(i.delimiter),u=!0===i.addQueryPrefix?"?":"";return i.charsetSentinel&&(u+="iso-8859-1"===i.charset?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),c.length>0?u+c:""}(o({},e,this.u._query),{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0,encoder:(e,t)=>"boolean"==typeof e?Number(e):t(e)})}current(e,t){const s=this.t.absolute?this.l.host+this.l.pathname:this.l.pathname.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"),[r,i]=Object.entries(this.t.routes).find(([t,r])=>new C(e,r,this.t).matchesUrl(s))||[void 0,void 0];if(!e)return r;const n=new RegExp(`^${e.replace(".","\\.").replace("*",".*")}$`).test(r);if([null,void 0].includes(t)||!n)return n;const o=new C(r,i,this.t);t=this.s(t,o);const a=this.h(i);return!(!Object.values(t).every(e=>!e)||Object.values(a).length)||Object.entries(t).every(([e,t])=>a[e]==t)}get l(){var e,t,s,r,i,n;const{host:o="",pathname:a="",search:l=""}="undefined"!=typeof window?window.location:{};return{host:null!=(e=null===(t=this.t.location)||void 0===t?void 0:t.host)?e:o,pathname:null!=(s=null===(r=this.t.location)||void 0===r?void 0:r.pathname)?s:a,search:null!=(i=null===(n=this.t.location)||void 0===n?void 0:n.search)?i:l}}get params(){return this.h(this.t.routes[this.current()])}has(e){return Object.keys(this.t.routes).includes(e)}s(e={},t=this.i){e=["string","number"].includes(typeof e)?[e]:e;const s=t.parameterSegments.filter(({name:e})=>!this.t.defaults[e]);return Array.isArray(e)?e=e.reduce((e,t,r)=>o({},e,s[r]?{[s[r].name]:t}:{[t]:""}),{}):1!==s.length||e[s[0].name]||!e.hasOwnProperty(Object.values(t.bindings)[0])&&!e.hasOwnProperty("id")||(e={[s[0].name]:e}),o({},this.p(t),this.v(e,t.bindings))}p(e){return e.parameterSegments.filter(({name:e})=>this.t.defaults[e]).reduce((e,{name:t},s)=>o({},e,{[t]:this.t.defaults[t]}),{})}v(e,t={}){return Object.entries(e).reduce((e,[s,r])=>{if(!r||"object"!=typeof r||Array.isArray(r)||"_query"===s)return o({},e,{[s]:r});if(!r.hasOwnProperty(t[s])){if(!r.hasOwnProperty("id"))throw new Error(`Ziggy error: object passed as '${s}' parameter is missing route model binding key '${t[s]}'.`);t[s]="id"}return o({},e,{[s]:r[t[s]]})},{})}h(e){var t;let s=this.l.pathname.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"");const r=(e,t="",s)=>{const[r,i]=[e,t].map(e=>e.split(s));return i.reduce((e,t,s)=>/^{[^}?]+\??}$/.test(t)&&r[s]?o({},e,{[t.replace(/^{|\??}$/g,"")]:r[s]}):e,{})};return o({},r(this.l.host,e.domain,"."),r(s,e.uri,"/"),function(e,t){var s=N;if(""===e||null==e)return s.plainObjects?Object.create(null):{};for(var r="string"==typeof e?function(e,t){var s,r={},i=(t.ignoreQueryPrefix?e.replace(/^\?/,""):e).split(t.delimiter,1/0===t.parameterLimit?void 0:t.parameterLimit),n=-1,o=t.charset;if(t.charsetSentinel)for(s=0;s<i.length;++s)0===i[s].indexOf("utf8=")&&("utf8=%E2%9C%93"===i[s]?o="utf-8":"utf8=%26%2310003%3B"===i[s]&&(o="iso-8859-1"),n=s,s=i.length);for(s=0;s<i.length;++s)if(s!==n){var a,l,c=i[s],u=c.indexOf("]="),p=-1===u?c.indexOf("="):u+1;-1===p?(a=t.decoder(c,N.decoder,o,"key"),l=t.strictNullHandling?null:""):(a=t.decoder(c.slice(0,p),N.decoder,o,"key"),l=d.maybeMap(x(c.slice(p+1),t),(function(e){return t.decoder(e,N.decoder,o,"value")}))),l&&t.interpretNumericEntities&&"iso-8859-1"===o&&(l=S(l)),c.indexOf("[]=")>-1&&(l=k(l)?[l]:l),r[a]=P.call(r,a)?d.combine(r[a],l):l}return r}(e,s):e,i=s.plainObjects?Object.create(null):{},n=Object.keys(r),o=0;o<n.length;++o){var a=n[o],l=T(a,r[a],s,"string"==typeof e);i=d.merge(i,l,s)}return d.compact(i)}(null===(t=this.l.search)||void 0===t?void 0:t.replace(/^\?/,"")))}valueOf(){return this.toString()}check(e){return this.has(e)}}var R=function(e,t,s,r){const i=new M(e,t,s,r);return e?i.toString():i};const D=Object(i.a)();function I(e,t,s){return null==t&&(t={}),R(e,t,s,n).toString()}function A(e,t,s,i){const n=I(e,s),o=document.createElement("a");return o.textContent=t,o.href=n,null!=i&&Object(r.forEach)(i,(e,t)=>{null!=e&&o.setAttribute(t,e.toString())}),o.outerHTML}n.port=+D.port||null,n.url=D.origin},"205K":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("mkgZ");class i extends r.a{constructor(e){super(),Object.defineProperty(this,"json",{enumerable:!0,configurable:!0,writable:!0,value:e})}}},"2Kkx":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));const r="js-mobile-toggle--active";class i{constructor(){Object.defineProperty(this,"toggle",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=e.currentTarget;if(!(t instanceof HTMLElement))return;const s=t.dataset.mobileToggleTarget;if(null==s)return;const i=document.querySelector(`.js-mobile-toggle[data-mobile-toggle-id=${s}]`);if(!(i instanceof HTMLElement))return;const n=!t.classList.contains(r);t.classList.toggle(r,n),i.classList.toggle("hidden-xs",!n)}}),e(document).on("click",".js-mobile-toggle",this.toggle)}}}).call(this,s("5wds"))},"2LKk":function(e,t,s){"use strict";(function(e,r){s.d(t,"a",(function(){return _}));var i,n,o,a=s("UVl7"),l=s("2b+G"),c=s("O0zI"),u=s("stCr"),d=s("4PZ6"),p=s("4QOX"),m=s("f4vq"),h=s("/G9H"),b=s("I8Ok"),f=s("PPOh"),v=s("tX/w"),g=function(e,t){return function(){return e.apply(t,arguments)}},y={}.hasOwnProperty;i=h.createElement,n=m.a.dataStore.commentStore,o=m.a.dataStore.uiState;var _=function(t){function s(){return this.renderFollowToggle=g(this.renderFollowToggle,this),this.renderShowDeletedToggle=g(this.renderShowDeletedToggle,this),this.renderComments=g(this.renderComments,this),this.renderComment=g(this.renderComment,this),this.render=g(this.render,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)y.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.prototype.render=function(){return i(p.a,null,(t=this,function(){var s,r;return s=o.comments.topLevelCommentIds.map((function(e){return n.comments.get(e)})),r=o.comments.pinnedCommentIds.map((function(e){return n.comments.get(e)})),Object(b.div)({className:Object(v.a)("comments",t.props.modifiers),id:"comments"},Object(b.h2)({className:"comments__title"},osu.trans("comments.title"),Object(b.span)({className:"comments__count"},osu.formatNumber(o.comments.total))),r.length>0?Object(b.div)({className:"comments__items comments__items--pinned"},t.renderComments(r,!0)):void 0,Object(b.div)({className:"comments__new"},i(l.a,{commentableType:t.props.commentableType,commentableId:t.props.commentableId,focus:!1,modifiers:t.props.modifiers})),Object(b.div)({className:"comments__items comments__items--toolbar"},i(u.a,{modifiers:t.props.modifiers}),Object(b.div)({className:Object(v.a)("sort",t.props.modifiers)},Object(b.div)({className:"sort__items"},t.renderFollowToggle(),t.renderShowDeletedToggle()))),s.length>0?Object(b.div)({className:"comments__items "+(null!=o.comments.loadingSort?"comments__items--loading":"")},t.renderComments(s,!1),i(d.a,{comments:s,modifiers:["top"]}),i(c.a,{commentableType:t.props.commentableType,commentableId:t.props.commentableId,comments:s,total:o.comments.topLevelCount,sort:o.comments.currentSort,modifiers:e.concat("top",t.props.modifiers)})):Object(b.div)({className:"comments__items comments__items--empty"},osu.trans("comments.empty")))}));var t},s.prototype.renderComment=function(e,t){return null==t&&(t=!1),e.isDeleted&&!m.a.userPreferences.get("comments_show_deleted")?null:i(a.a,{key:e.id,comment:e,depth:0,modifiers:this.props.modifiers,expandReplies:!t&&null})},s.prototype.renderComments=function(e,t){var s,r,i,n;for(n=[],r=0,i=e.length;r<i;r++)(s=e[r]).pinned===t&&n.push(this.renderComment(s,t));return n},s.prototype.renderShowDeletedToggle=function(){return Object(b.button)({type:"button",className:"sort__item sort__item--button",onClick:this.toggleShowDeleted},Object(b.span)({className:"sort__item-icon"},Object(b.span)({className:m.a.userPreferences.get("comments_show_deleted")?"fas fa-check-square":"far fa-square"})),osu.trans("common.buttons.show_deleted"))},s.prototype.renderFollowToggle=function(){var e,t,s;return o.comments.userFollow?(e="fas fa-eye-slash",s=osu.trans("common.buttons.watch.to_0")):(e="fas fa-eye",s=osu.trans("common.buttons.watch.to_1")),t=this.props.loadingFollow?i(f.a,{modifiers:["center-inline"]}):Object(b.span)({className:e}),Object(b.button)({type:"button",className:"sort__item sort__item--button",onClick:this.toggleFollow,disabled:this.props.loadingFollow},Object(b.span)({className:"sort__item-icon"},t),s)},s.prototype.toggleShowDeleted=function(){return m.a.userPreferences.set("comments_show_deleted",!m.a.userPreferences.get("comments_show_deleted"))},s.prototype.toggleFollow=function(){return r.publish("comments:toggle-follow")},s}(h.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},"2b+G":function(e,t,s){"use strict";(function(e,r){s.d(t,"a",(function(){return v}));var i,n,o=s("C+VY"),a=s("/G9H"),l=s("LQV2"),c=s.n(l),u=s("I8Ok"),d=s("PPOh"),p=s("uWCK"),m=s("/jJF"),h=s("tX/w"),b=function(e,t){return function(){return e.apply(t,arguments)}},f={}.hasOwnProperty;n=a.createElement,i="comment-editor";var v=function(t){function s(t){var r;this.post=b(this.post,this),this.onChange=b(this.onChange,this),this.mode=b(this.mode,this),this.isValid=b(this.isValid,this),this.handleKeyDownCallback=b(this.handleKeyDownCallback,this),this.close=b(this.close,this),this.buttonText=b(this.buttonText,this),this.render=b(this.render,this),this.componentWillUnmount=b(this.componentWillUnmount,this),this.componentDidMount=b(this.componentDidMount,this),s.__super__.constructor.call(this,t),this.textarea=a.createRef(),this.throttledPost=e.throttle(this.post,1e3),this.handleKeyDown=InputHandler.textarea(this.handleKeyDownCallback),this.state={message:null!=(r=this.props.message)?r:"",posting:!1}}return function(e,t){for(var s in t)f.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.prototype.componentDidMount=function(){var e,t,s;if(null==(e=this.props.focus)||e)return null!=(t=this.textarea.current)&&(t.selectionStart=-1),null!=(s=this.textarea.current)?s.focus():void 0},s.prototype.componentWillUnmount=function(){var e;return this.throttledPost.cancel(),null!=(e=this.xhr)?e.abort():void 0},s.prototype.render=function(){var e;return e=Object(h.a)(i,this.props.modifiers),"new"===this.mode()&&(e+=" "+i+"--fancy"),Object(u.div)({className:e},"new"===this.mode()?Object(u.div)({className:i+"__avatar"},n(p.a,{user:currentUser,modifiers:["full-circle"]})):void 0,n(c.a,{className:i+"__message",ref:this.textarea,value:this.state.message,placeholder:osu.trans("comments.placeholder."+this.mode()),onChange:this.onChange,onKeyDown:this.handleKeyDown,disabled:null==currentUser.id||this.state.posting}),Object(u.div)({className:i+"__footer"},Object(u.div)({className:i+"__footer-item "+i+"__footer-item--notice hidden-xs"},osu.trans("comments.editor.textarea_hint._",{action:osu.trans("comments.editor.textarea_hint."+this.mode())})),null!=this.props.close?Object(u.div)({className:i+"__footer-item"},n(o.a,{disabled:this.state.posting,modifiers:"comment-editor",props:{onClick:this.props.close},text:osu.trans("common.buttons.cancel")})):void 0,null!=currentUser.id?Object(u.div)({className:i+"__footer-item"},n(o.a,{disabled:this.state.posting||!this.isValid(),isBusy:this.state.posting,modifiers:"comment-editor",props:{onClick:this.throttledPost},text:{top:this.state.posting?n(d.a,{modifiers:"center-inline"}):this.buttonText()}})):Object(u.div)({className:i+"__footer-item"},n(o.a,{extraClasses:["js-user-link"],modifiers:"comment-editor",text:osu.trans("comments.guest_button."+this.mode())}))))},s.prototype.buttonText=function(){var e;return e=function(){switch(this.mode()){case"reply":return"reply";case"edit":return"save";case"new":return"post"}}.call(this),osu.trans("common.buttons."+e)},s.prototype.close=function(){var e;if(null!=this.props.close&&((null!=(e=this.props.message)?e:"")===this.state.message||confirm(osu.trans("common.confirmation_unsaved"))))return this.props.close()},s.prototype.handleKeyDownCallback=function(e,t){switch(e){case InputHandler.CANCEL:return this.close();case InputHandler.SUBMIT:return this.throttledPost()}},s.prototype.isValid=function(){return null!=this.state.message&&this.state.message.length>0},s.prototype.mode=function(){return null!=this.props.parent?"reply":null!=this.props.id?"edit":"new"},s.prototype.onChange=function(e){return this.setState({message:e.target.value})},s.prototype.post=function(){var e,t,s,i,n,o,a;if("edit"===this.mode()&&this.state.message===this.props.message)return"function"==typeof(e=this.props).close?e.close():void 0;switch(this.setState({posting:!0}),t={comment:{message:this.state.message}},this.mode()){case"reply":case"new":o=laroute.route("comments.store"),s="POST",t.comment.commentable_type=this.props.commentableType,t.comment.commentable_id=this.props.commentableId,t.comment.parent_id=null!=(n=this.props.parent)?n.id:void 0,a=this,i=function(e){return a.setState({message:""}),r.publish("comments:new",e)};break;case"edit":o=laroute.route("comments.update",{comment:this.props.id}),s="PUT",i=function(e){return r.publish("comment:updated",e)}}return this.xhr=r.ajax(o,{method:s,data:t}).always(function(e){return function(){return e.setState({posting:!1})}}(this)).done(function(e){return function(t){var s,r;return i(t),"function"==typeof(s=e.props).onPosted&&s.onPosted(e.mode()),"function"==typeof(r=e.props).close?r.close():void 0}}(this)).fail(Object(m.c)(this.post))},s}(a.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},"2etm":function(e,t,s){"use strict";s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return n}));const r={beatmap_owner_change:["fas fa-drafting-compass","fas fa-user-friends"],beatmapset_discussion:["fas fa-drafting-compass","fas fa-comment"],beatmapset_problem:["fas fa-drafting-compass","fas fa-exclamation-circle"],beatmapset_state:["fas fa-drafting-compass"],channel:["fas fa-comments"],comment:["fas fa-comment"],forum_topic_reply:["fas fa-comment-medical"],legacy_pm:["fas fa-envelope"],user_achievement_unlock:["fas fa-medal"],user_beatmapset_new:["fas fa-music"]},i={beatmap_owner_change:["fas fa-drafting-compass","fas fa-user-friends"],beatmapset_discussion_lock:["fas fa-drafting-compass","fas fa-lock"],beatmapset_discussion_post_new:["fas fa-drafting-compass","fas fa-comment-medical"],beatmapset_discussion_qualified_problem:["fas fa-drafting-compass","fas fa-exclamation-circle"],beatmapset_discussion_unlock:["fas fa-drafting-compass","fas fa-unlock"],beatmapset_disqualify:["fas fa-drafting-compass","far fa-times-circle"],beatmapset_love:["fas fa-drafting-compass","fas fa-heart"],beatmapset_nominate:["fas fa-drafting-compass","fas fa-vote-yea"],beatmapset_qualify:["fas fa-drafting-compass","fas fa-check"],beatmapset_rank:["fas fa-drafting-compass","fas fa-check-double"],beatmapset_remove_from_loved:["fas fa-drafting-compass","fas fa-heart-broken"],beatmapset_reset_nominations:["fas fa-drafting-compass","fas fa-undo"],channel_message:["fas fa-comments"],comment_new:["fas fa-comment"],comment_reply:["fas fa-reply"],forum_topic_reply:["fas fa-comment-medical"],legacy_pm:["fas fa-envelope"],user_achievement_unlock:["fas fa-trophy"],user_beatmapset_new:["fas fa-music"],user_beatmapset_revive:["fas fa-drum"]},n={beatmap_owner_change:["fas fa-user-edit"],beatmapset_discussion_lock:["fas fa-lock"],beatmapset_discussion_post_new:["fas fa-comment-medical"],beatmapset_discussion_qualified_problem:["fas fa-exclamation-circle"],beatmapset_discussion_unlock:["fas fa-unlock"],beatmapset_disqualify:["far fa-times-circle"],beatmapset_love:["fas fa-heart"],beatmapset_nominate:["fas fa-vote-yea"],beatmapset_qualify:["fas fa-check"],beatmapset_rank:["fas fa-check-double"],beatmapset_remove_from_loved:["fas fa-heart-broken"],beatmapset_reset_nominations:["fas fa-undo"],channel_message:["fas fa-comments"],comment_new:["fas fa-comment"],comment_reply:["fas fa-reply"],forum_topic_reply:["fas fa-comment-medical"],legacy_pm:["fas fa-envelope"],user_beatmapset_new:["fas fa-music"],user_beatmapset_revive:["fas fa-drum"]}},"2hxc":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("mkgZ");class i extends r.a{constructor(e){super(),Object.defineProperty(this,"json",{enumerable:!0,configurable:!0,writable:!0,value:e})}}},"3J26":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("7EfK");class i{constructor(){Object.defineProperty(this,"observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"formatElem",{enumerable:!0,configurable:!0,writable:!0,value:e=>{"1"!==e.dataset.localtime&&(e.dataset.localtime="1",e.classList.add("js-tooltip-time"),e.title=e.dateTime,e.innerText=r(e.dateTime).format("LLL"))}}),Object.defineProperty(this,"formatElems",{enumerable:!0,configurable:!0,writable:!0,value:e=>(null==e&&(e=this.getElems(document.body)),e.map(this.formatElem))}),Object.defineProperty(this,"getElems",{enumerable:!0,configurable:!0,writable:!0,value:e=>e instanceof HTMLElement?e instanceof HTMLTimeElement&&e.classList.contains("js-localtime")?[e]:[...e.querySelectorAll("time.js-localtime")]:[]}),Object.defineProperty(this,"mutationHandler",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=[];e.forEach(e=>{e.addedNodes.forEach(e=>{t.push(...this.getElems(e))})}),this.formatElems(t)}}),this.observer=new MutationObserver(this.mutationHandler),this.observer.observe(document,{childList:!0,subtree:!0})}}},"3Wjd":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));class r{constructor(){Object.defineProperty(this,"loaded",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"loading",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"abortLoading",{enumerable:!0,configurable:!0,writable:!0,value:()=>{for(const e of this.loading.values())e.abort()}}),Object.defineProperty(this,"forget",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t;this.loaded.delete(e),null===(t=this.loading.get(e))||void 0===t||t.abort()}}),e(document).on("turbolinks:before-cache",this.abortLoading)}load(t){if(this.loaded.has(t)||this.loading.has(t))return this.loading.get(t);const s=e.ajax(t,{cache:!0,dataType:"script"});return this.loading.set(t,s),s.done(()=>this.loaded.add(t)).always(()=>this.loading.delete(t)),s}loadSync(t){this.loaded.has(t)||(this.loading.has(t)&&this.forget(t),e.ajax(t,{async:!1,cache:!0,dataType:"script"}),this.loaded.add(t))}}}).call(this,s("5wds"))},"3XPW":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("/G9H"),i=s("tX/w");function n(e){const t=Object(i.a)("page-mode-link","profile-page",{"is-active":e.page===e.currentPage}),s=osu.trans(`users.show.extra.${e.page}.title`);return r.createElement("span",{className:t},r.createElement("span",{className:"fake-bold","data-content":s},s),r.createElement("span",{className:"page-mode-link__stripe"}))}},"3Zv4":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("y2EG"),i=s("71br"),n=s("f4vq");class o extends r.a{constructor(){super(-1,null),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:Object(i.a)()}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"legacy_pm"}),Object.defineProperty(this,"objectId",{enumerable:!0,configurable:!0,writable:!0,value:-1}),this.isRead=!1}get count(){var e,t;return null!==(t=null===(e=n.a.currentUser)||void 0===e?void 0:e.unread_pm_count)&&void 0!==t?t:0}}},"4PJi":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return l}));var r=s("0h6b"),i=s("f4vq"),n=s("/DQ7"),o=s("phBA");const a=e=>{var t;return 401===e.status&&"verify"===(null===(t=e.responseJSON)||void 0===t?void 0:t.authentication)};class l{constructor(){Object.defineProperty(this,"callback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"delayShow",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"delayShowCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"showOnError",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>!!a(e)&&(this.show(e.responseJSON.box,t),!0)}),Object.defineProperty(this,"autoSubmit",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var t;const s=this.inputBox;if(null==s)return;const i=s.value.replace(/\s/g,""),n=s.dataset.lastKey,o=parseInt(null!==(t=s.dataset.verificationKeyLength)&&void 0!==t?t:"",10);0===i.length&&this.setMessage(),o===i.length&&i!==n&&(s.dataset.lastKey=i,this.prepareForRequest("verifying"),this.request=e.post(Object(r.route)("account.verify"),{verification_key:i}).done(this.success).fail(this.error))}}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:e=>{this.setMessage(osu.xhrErrorMessage(e))}}),Object.defineProperty(this,"float",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,s)=>{e?(t.classList.add("js-user-verification--center"),t.style.paddingTop=""):(t.classList.remove("js-user-verification--center"),t.style.paddingTop=`${null!=s?s:0}px`)}}),Object.defineProperty(this,"isActive",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var e;return null===(e=this.modal)||void 0===e?void 0:e.classList.contains("js-user-verification--active")}}),Object.defineProperty(this,"onError",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>this.showOnError(t,Object(o.c)(e.target))}),Object.defineProperty(this,"prepareForRequest",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t;null===(t=this.request)||void 0===t||t.abort(),this.setMessage(osu.trans(`user_verification.box.${e}`),!0)}}),Object.defineProperty(this,"reissue",{enumerable:!0,configurable:!0,writable:!0,value:t=>{t.preventDefault(),this.prepareForRequest("issuing"),this.request=e.post(Object(r.route)("account.reissue-code")).done(e=>{this.setMessage(e.message)}).fail(this.error)}}),Object.defineProperty(this,"reposition",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var e,t;if(this.isActive()&&null!=this.modal)if(i.a.windowSize.isMobile)this.float(!0,this.modal);else{const s=null!==(t=null===(e=this.reference)||void 0===e?void 0:e.getBoundingClientRect().bottom)&&void 0!==t?t:0;this.float(s<0,this.modal,s)}}}),Object.defineProperty(this,"setDelayShow",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.delayShow=!0}}),Object.defineProperty(this,"setMessage",{enumerable:!0,configurable:!0,writable:!0,value:(e,t=!1)=>{const s=this.message;if(null==s)return;if(null==e||0===e.length)return void Object(n.b)(s);const r=this.messageText,i=this.messageSpinner;null!=r&&null!=i&&(r.textContent=e,Object(n.c)(i,t),Object(n.a)(s))}}),Object.defineProperty(this,"setModal",{enumerable:!0,configurable:!0,writable:!0,value:()=>{const e=document.querySelector(".js-user-verification");this.modal=e instanceof HTMLElement?e:void 0}}),Object.defineProperty(this,"show",{enumerable:!0,configurable:!0,writable:!0,value:(t,s)=>{this.delayShow?this.delayShowCallback=()=>this.show(t,s):(this.callback=s,null!=t&&e(".js-user-verification--box").html(t),this.$modal().modal({backdrop:"static",keyboard:!1,show:!0}).addClass("js-user-verification--active"),this.reposition())}}),Object.defineProperty(this,"showOnLoad",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.delayShow=!1,null!=this.delayShowCallback?(this.delayShowCallback(),this.delayShowCallback=void 0):this.isVerificationPage()&&this.show()}}),Object.defineProperty(this,"success",{enumerable:!0,configurable:!0,writable:!0,value:()=>{if(!this.isActive()||null==this.modal)return;const e=this.inputBox;if(null==e)return;this.$modal().modal("hide"),this.modal.classList.remove("js-user-verification--active");const t=this.callback;if(this.callback=void 0,this.setMessage(),e.value="",e.dataset.lastKey="",this.isVerificationPage())return osu.reloadPage();null==t||t()}}),e(document).on("ajax:error",this.onError).on("turbolinks:load",this.setModal).on("turbolinks:load",this.showOnLoad).on("turbolinks:visit",this.setDelayShow).on("input",".js-user-verification--input",this.autoSubmit).on("click",".js-user-verification--reissue",this.reissue),e.subscribe("user-verification:success",this.success),e(window).on("resize scroll",this.reposition)}get inputBox(){return document.querySelector(".js-user-verification--input")}get message(){return document.querySelector(".js-user-verification--message")}get messageSpinner(){return document.querySelector(".js-user-verification--message-spinner")}get messageText(){return document.querySelector(".js-user-verification--message-text")}get reference(){return document.querySelector(".js-user-verification--reference")}$modal(){return e(".js-user-verification")}isVerificationPage(){return null!=document.querySelector(".js-user-verification--on-load")}}}).call(this,s("5wds"))},"4PZ6":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("/G9H"),i=s("tX/w");class n extends r.Component{render(){const e=this.props.comments.filter(e=>null!=e.deletedAt).length;return 0===e?null:r.createElement("div",{className:Object(i.a)("deleted-comments-count",this.props.modifiers)},r.createElement("span",{className:"deleted-comments-count__icon"},r.createElement("span",{className:"far fa-trash-alt"})),osu.transChoice("comments.deleted_count",e))}}},"4cxI":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("0h6b"),i=s("/G9H"),n=s("tX/w");function o({group:e,modifiers:t}){if(null==e)return null;let s,o=e.name;if(null!=e.playmodes&&e.playmodes.length>0){s=i.createElement("div",{className:"user-group-badge__modes"},e.playmodes.map(e=>i.createElement("i",{key:e,className:`fal fa-extra-mode-${e}`}))),o+=` (${e.playmodes.map(e=>osu.trans(`beatmaps.mode.${e}`)).join(", ")})`}const a={children:s,className:Object(n.a)("user-group-badge",{probationary:e.is_probationary},e.identifier,t),"data-label":e.short_name,style:osu.groupColour(e),title:o};return e.has_listing?i.createElement("a",Object.assign({},a,{href:Object(r.route)("groups.show",{group:e.id})})):i.createElement("div",Object.assign({},a))}},"5AHq":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("/G9H");const i=r.createContext([])},"5b8Q":function(e,t,s){"use strict";(function(e){function r(){return window.setTimeout(i,0)}function i(){e.publish("osu:page:change")}s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return i}))}).call(this,s("5wds"))},"5e07":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const r=e=>e.toString().padStart(2,"0"),i={},n=(e,t)=>{var s;const n=Math.floor(e);if(i.time!==n||i.format!==t){i.format=t,i.time=n;const e=n%60,s=Math.floor(n/60);if("minute_minimal"===t)i.formatted=`'${s}:${r(e)}'`;else if("minute"===t)i.formatted=`'${r(s)}:${r(e)}'`;else{const n=s%60,o=Math.floor(s/60);i.formatted="hour_minimal"===t?`'${o}:${r(n)}:${r(e)}'`:`'${r(o)}:${r(n)}:${r(e)}'`}}return null!==(s=i.formatted)&&void 0!==s?s:""}},"5evE":function(e,t,s){"use strict";function r(e){return null==e.objectId||null==e.name||null==e.category?null:"user_achievement_unlock"===e.name?`achievement:${e.id}`:`${e.category}:${e.objectId}`}function i(e){var t;return null!==(t=n[e])&&void 0!==t?t:e}s.d(t,"b",(function(){return r})),s.d(t,"a",(function(){return i}));const n={beatmap_owner_change:"beatmap_owner_change",beatmapset_discussion_lock:"beatmapset_discussion",beatmapset_discussion_post_new:"beatmapset_discussion",beatmapset_discussion_qualified_problem:"beatmapset_problem",beatmapset_discussion_review_new:"beatmapset_discussion",beatmapset_discussion_unlock:"beatmapset_discussion",beatmapset_disqualify:"beatmapset_state",beatmapset_love:"beatmapset_state",beatmapset_nominate:"beatmapset_state",beatmapset_qualify:"beatmapset_state",beatmapset_rank:"beatmapset_state",beatmapset_remove_from_loved:"beatmapset_state",beatmapset_reset_nominations:"beatmapset_state",channel_message:"channel",comment_new:"comment",comment_reply:"comment",forum_topic_reply:"forum_topic_reply",legacy_pm:"legacy_pm",user_achievement_unlock:"user_achievement_unlock",user_beatmapset_new:"user_beatmapset_new",user_beatmapset_revive:"user_beatmapset_new"}},"6QPw":function(e,t,s){"use strict";var r=s("KUml"),i=s("3Zv4"),n=s("2etm"),o=s("mjdM"),a=s("/G9H");let l=class extends a.Component{constructor(){super(...arguments),Object.defineProperty(this,"handleMarkAsRead",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}render(){const e=new i.a;return 0===e.count?null:a.createElement(o.a,{icons:n.b.legacy_pm,item:e,message:osu.transChoice("notifications.item.legacy_pm.legacy_pm.legacy_pm",e.count),modifiers:["one"],url:"/forum/ucp.php?i=pm&folder=inbox",withCategory:!0,withCoverImage:!0})}};l=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o}([r.b],l),t.a=l},"6Xkg":function(e,t,s){"use strict";s.d(t,"a",(function(){return g}));var r=s("f7bm"),i=s("0h6b"),n=s("Hs9Z"),o=s("7EfK"),a=s("f4vq"),l=s("/G9H"),c=s("mk7q"),u=s("peKF"),d=s("tX/w");const p=["join_date","last_visit","playstyle","post_count","comments_count"],m=["location","interests","occupation"],h=["twitter","discord","website"],b={discord:e=>{var t;return{icon:"fab fa-discord",text:l.createElement(r.a,{showIcon:!0,value:null!==(t=e.discord)&&void 0!==t?t:""})}},interests:e=>({icon:"far fa-heart",text:e.interests}),location:e=>({icon:"fas fa-map-marker-alt",text:e.location}),occupation:e=>({icon:"fas fa-suitcase",text:e.occupation}),twitter:e=>({icon:"fab fa-twitter",text:`@${e.twitter}`,url:`https://twitter.com/${e.twitter}`}),website:e=>{var t;return{icon:"fas fa-link",text:(null!==(t=e.website)&&void 0!==t?t:"").replace(/^https?:\/\//,""),url:e.website}}},f={comments_count:e=>{var t;const s=osu.transChoice("users.show.comments_count.count",null!==(t=e.comments_count)&&void 0!==t?t:0),r=Object(i.route)("comments.index",{user_id:e.id});return{mappings:{link:l.createElement("a",{className:Object(d.a)("profile-links__value","link"),href:r},s)},pattern:osu.trans("users.show.comments_count._")}},join_date:e=>{const t=o(e.join_date),s=t.toISOString();let r,i,n="js-tooltip-time";return t.isBefore(o.utc([2008]))?(r=":date",i=osu.trans("users.show.first_members")):(n+=" profile-links__value",r=osu.trans("users.show.joined_at"),i=t.format(osu.trans("common.datetime.year_month.moment"))),{mappings:{date:l.createElement("span",{className:n,title:s},i)},pattern:r}},last_visit:e=>{var t;return e.is_online?{mappings:{},pattern:osu.trans("users.show.lastvisit_online")}:{mappings:{date:l.createElement("span",{className:"profile-links__value"},l.createElement(u.a,{dateTime:null!==(t=e.last_visit)&&void 0!==t?t:"",relative:!0}))},pattern:osu.trans("users.show.lastvisit")}},playstyle:e=>{const t=e.playstyle.map(e=>osu.trans(`common.device.${e}`)).join(", ");return{mappings:{devices:l.createElement("span",{className:"profile-links__value"},t)},pattern:osu.trans("users.show.plays_with")}},post_count:e=>{const t=osu.transChoice("users.show.post_count.count",e.post_count),s=Object(i.route)("users.posts",{user:e.id});return{mappings:{link:l.createElement("a",{className:Object(d.a)("profile-links__value","link"),href:s},t)},pattern:osu.trans("users.show.post_count._")}}};function v(e){return l.createElement("div",{className:"profile-links__item"},l.createElement("span",{className:"profile-links__icon",title:e.title},l.createElement("span",{className:`fa-fw ${e.icon}`})),null!=e.url?l.createElement("a",{className:"profile-links__value profile-links__value--link",href:e.url},e.text):l.createElement("span",{className:"profile-links__value"},e.text))}class g extends l.PureComponent{constructor(){super(...arguments),Object.defineProperty(this,"renderLink",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t;if(null==this.props.user[e])return null;const s=b[e](this.props.user);return null!==(t=s.title)&&void 0!==t||(s.title=osu.trans(`users.show.info.${e}`)),l.createElement(v,Object.assign({key:e},s))}}),Object.defineProperty(this,"renderText",{enumerable:!0,configurable:!0,writable:!0,value:e=>{if(null==this.props.user[e])return null;const t=f[e](this.props.user);return l.createElement("div",{key:e,className:"profile-links__item"},l.createElement(c.a,Object.assign({},t)))}})}render(){var e;const t=[p.map(this.renderText),m.map(this.renderLink),h.map(this.renderLink)].map(e=>Object(n.compact)(e)).filter(e=>e.length>0);return l.createElement("div",{className:"profile-links"},t.map((e,t)=>l.createElement("div",{key:t,className:`profile-links__row profile-links__row--${t}`},e)),this.props.user.id===(null===(e=a.a.currentUser)||void 0===e?void 0:e.id)&&l.createElement("div",{className:"profile-links__edit"},l.createElement("a",{className:"btn-circle btn-circle--page-toggle",href:Object(i.route)("account.edit"),title:osu.trans("users.show.page.button")},l.createElement("span",{className:"fas fa-pencil-alt"}))))}}},"6b0J":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("/G9H");const i=r.createContext({})},"6e4D":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("f4vq"),i=s("/G9H"),n=s("tX/w");class o extends i.PureComponent{render(){var e;const t=this.props.values.map(e=>{var t,s;let n="sort__item sort__item--button";return this.props.currentValue===e&&(n+=" sort__item--active"),i.createElement("button",{key:e,className:n,"data-value":e,onClick:this.props.onChange},"rank"===e?i.createElement("span",null,i.createElement("i",{className:`fas fa-extra-mode-${null!==(s=null===(t=r.a.currentUser)||void 0===t?void 0:t.playmode)&&void 0!==s?s:"osu"}`})," ",osu.trans("sort.rank")):osu.trans(`${this.props.transPrefix}${e}`))});return i.createElement("div",{className:Object(n.a)("sort",this.props.modifiers)},i.createElement("div",{className:"sort__items"},this.props.showTitle&&i.createElement("span",{className:"sort__item sort__item--title"},null!==(e=this.props.title)&&void 0!==e?e:osu.trans("sort._")),t))}}Object.defineProperty(o,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{showTitle:!0,transPrefix:"sort."}})},"70Tv":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));var r=s("V/vD");class i{constructor(){Object.defineProperty(this,"layzr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observePage",{enumerable:!0,configurable:!0,writable:!0,value:e=>{if(null!=this.layzr)for(const t of e)for(const e of t.addedNodes)if(e instanceof HTMLElement&&(null!=e.dataset.normal||null!=e.querySelector("[data-normal]")))return void this.reinit()}}),this.observer=new MutationObserver(this.observePage),this.observer.observe(document,{childList:!0,subtree:!0}),e(()=>{var e;null!==(e=this.layzr)&&void 0!==e||(this.layzr=Object(r.a)()),this.reinit()})}reinit(){var e;null===(e=this.layzr)||void 0===e||e.update().check().handlers(!0)}}}).call(this,s("5wds"))},"71br":function(e,t,s){"use strict";function r(){return{coverUrl:null,title:""}}s.d(t,"a",(function(){return r}))},"76+M":function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("0h6b");const i=["modding","multiplayer"];function n(e,t){const s=[{active:"show"===t,title:osu.trans("layout.header.users.show"),url:Object(r.route)("users.show",{user:e.id})}];return e.is_bot||i.forEach(i=>{s.push({active:t===i,title:osu.trans(`layout.header.users.${i}`),url:Object(r.route)(`users.${i}.index`,{user:e.id})})}),s}},"7G7V":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("0h6b"),i=s("/G9H"),n=s("tX/w");class o extends i.PureComponent{get artist(){var e;return"artist"in this.props?null!==(e=this.props.track.artist)&&void 0!==e?e:this.props.artist:this.props.track.artist}render(){let e=Object(n.a)("artist-track",{original:this.props.track.exclusive},this.props.modifiers);return e+=" js-audio--player",i.createElement("div",{className:e,"data-audio-url":this.props.track.preview},i.createElement("div",{className:"artist-track__col artist-track__col--preview",style:{backgroundImage:osu.urlPresence(this.props.track.cover_url)}},i.createElement("button",{className:"artist-track__button artist-track__button--play js-audio--play"},i.createElement("span",{className:"fa-fw play-button"}))),i.createElement("div",{className:"artist-track__col artist-track__col--names"},i.createElement("div",{className:"artist-track__title u-ellipsis-overflow"},this.props.track.title,osu.present(this.props.track.version)&&i.createElement(i.Fragment,null," ",i.createElement("span",{className:"artist-track__version"},this.props.track.version))),i.createElement("div",{className:"artist-track__info"},i.createElement("a",{href:Object(r.route)("artists.show",{artist:this.artist.id})},this.artist.name)),this.props.showAlbum&&null!=this.props.track.album&&i.createElement("div",{className:"artist-track__info"},i.createElement("a",{href:`${Object(r.route)("artists.show",{artist:this.artist.id})}#album-${this.props.track.album_id}`},this.props.track.album.title))),i.createElement("div",{className:"artist-track__col artist-track__col--badges"},this.props.track.exclusive&&i.createElement("span",{className:"pill-badge pill-badge--pink pill-badge--with-shadow",title:osu.trans("artist.songs.original")},osu.trans("artist.songs.original_badge")),this.props.track.is_new&&i.createElement("span",{className:"pill-badge pill-badge--yellow pill-badge--with-shadow"},osu.trans("common.badges.new"))),i.createElement("div",{className:"artist-track__col artist-track__col--details"},i.createElement("div",{className:"u-ellipsis-overflow artist-track__detail artist-track__detail--genre"},this.props.track.genre),i.createElement("div",{className:"artist-track__detail artist-track__detail--bpm"},osu.formatNumber(this.props.track.bpm),"bpm"),i.createElement("div",{className:"artist-track__detail artist-track__detail--length"},this.props.track.length)),i.createElement("div",{className:"artist-track__col artist-track__col--buttons"},i.createElement("a",{className:"artist-track__button",href:this.props.track.osz,title:osu.trans("artist.beatmaps.download")},i.createElement("span",{className:"fas fa-fw fa-download"}))))}}Object.defineProperty(o,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{showAlbum:!1}})},"7dd3":function(e,t,s){"use strict";(function(e,r){s.d(t,"a",(function(){return p}));var i,n=s("S5CA"),o=s("/G9H"),a=s("I8Ok"),l=s("tX/w"),c=s("vZz4"),u=function(e,t){return function(){return e.apply(t,arguments)}},d={}.hasOwnProperty;i=o.createElement;var p=function(t){function s(){return this.renderNav=u(this.renderNav,this),this.render=u(this.render,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)d.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.prototype.render=function(){var t,s,o,u,d,p;return t=Object(l.a)("build",this.props.modifiers),u=e.groupBy(this.props.build.changelog_entries,"category"),s=e(u).keys().sort().value(),Object(a.div)({className:t+" t-changelog-stream--"+e.kebabCase(this.props.build.update_stream.display_name)},Object(a.div)({className:"build__version"},this.renderNav({version:"previous",icon:"fas fa-chevron-left"}),Object(a.a)({className:"build__version-link",href:Object(c.c)(this.props.build)},Object(a.span)({className:"build__stream"},this.props.build.update_stream.display_name)," ",Object(a.span)({className:"u-changelog-stream--text"},this.props.build.display_version)),this.renderNav({version:"next",icon:"fas fa-chevron-right"})),null!=(p=this.props.showDate)&&p?Object(a.div)({className:"build__date"},r(this.props.build.created_at).format("LL")):void 0,function(){var e,t,r;for(r=[],e=0,t=s.length;e<t;e++)o=s[e],r.push(Object(a.div)({key:o,className:"build__changelog-entries-container"},Object(a.div)({className:"build__changelog-entries-category"},o),Object(a.div)({className:"build__changelog-entries"},function(){var e,t,s,r,l;for(l=[],e=0,t=(s=u[o]).length;e<t;e++)d=s[e],l.push(Object(a.div)({key:null!=(r=d.id)?r:d.created_at+"-"+d.title,className:"build__changelog-entry"},i(n.a,{entry:d})));return l}())));return r}())},s.prototype.renderNav=function(e){var t,s,r;if(r=e.version,s=e.icon,null!=this.props.build.versions)return null!=(t=this.props.build.versions[r])?Object(a.a)({className:"build__version-link",href:Object(c.c)(t),title:t.display_version},Object(a.i)({className:s})):Object(a.span)({className:"build__version-link build__version-link--disabled"},Object(a.i)({className:s}))},s}(o.PureComponent)}).call(this,s("Hs9Z"),s("7EfK"))},"7nlf":function(e,t,s){"use strict";(function(e){var r=s("0h6b"),i=s("lv9K"),n=s("KUml"),o=s("f4vq"),a=s("/G9H"),l=s("PPOh"),c=s("/jJF"),u=s("tX/w"),d=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};const p="textual-button";let m=class extends a.Component{constructor(t){super(t),Object.defineProperty(this,"loading",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"xhr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clicked",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var e,t;confirm(osu.trans("common.confirmation"))?this.toggleBlock():null===(t=(e=this.props).onClick)||void 0===t||t.call(e)}}),Object.defineProperty(this,"toggleBlock",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.loading=!0,null==this.block?this.xhr=e.ajax(Object(r.route)("blocks.store",{target:this.props.userId}),{type:"POST"}):this.xhr=e.ajax(Object(r.route)("blocks.destroy",{block:this.props.userId}),{type:"DELETE"}),this.xhr.done(this.updateBlocks).fail(Object(c.c)(this.toggleBlock)).always(Object(i.f)(()=>this.loading=!1))}}),Object.defineProperty(this,"updateBlocks",{enumerable:!0,configurable:!0,writable:!0,value:t=>{var s,r;null!=o.a.currentUser&&(o.a.currentUser.blocks=t.filter(e=>"block"===e.relation_type),o.a.currentUser.friends=t.filter(e=>"friend"===e.relation_type),e.publish("user:update",o.a.currentUser)),null===(r=(s=this.props).onClick)||void 0===r||r.call(s)}}),Object(i.p)(this)}get block(){var e;return null===(e=o.a.currentUser)||void 0===e?void 0:e.blocks.find(e=>e.target_id===this.props.userId)}get isVisible(){return null!=o.a.currentUser&&Number.isFinite(this.props.userId)&&this.props.userId!==o.a.currentUser.id}componentWillUnmount(){var e;null===(e=this.xhr)||void 0===e||e.abort()}render(){if(!this.isVisible)return null;const e=Object(u.a)(p,this.props.modifiers,"block");let t,s;return null==this.props.wrapperClass?s=e:(t=e,s=this.props.wrapperClass),a.createElement("button",{className:s,disabled:this.loading,onClick:this.clicked,type:"button"},a.createElement("span",{className:t},this.loading?a.createElement("span",{className:`${p}__icon fa-fw`},a.createElement(l.a,null)):a.createElement("span",{className:`${p}__icon fas fa-ban fa-fw`})," ",null==this.block?osu.trans("users.blocks.button.block"):osu.trans("users.blocks.button.unblock")))}};d([i.q],m.prototype,"loading",void 0),d([i.h],m.prototype,"block",null),d([i.h],m.prototype,"isVisible",null),d([i.f],m.prototype,"toggleBlock",void 0),d([i.f],m.prototype,"updateBlocks",void 0),m=d([n.b],m),t.a=m}).call(this,s("5wds"))},"8Xmz":function(e,t,s){"use strict";var r=s("KUml"),i=s("/G9H"),n=s("PPOh"),o=s("tX/w"),a=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let l=class extends i.Component{render(){return this.props.isDeleting?i.createElement("div",{className:Object(o.a)("notification-action-button",this.props.modifiers)},i.createElement("span",{className:"notification-action-button__text"},this.props.text),i.createElement("div",{className:"notification-action-button__icon"},i.createElement(n.a,null))):i.createElement("button",{className:Object(o.a)("notification-action-button",this.props.modifiers),onClick:this.props.onDelete,type:"button"},i.createElement("span",{className:"notification-action-button__text"},this.props.text),i.createElement("div",{className:"notification-action-button__icon"},i.createElement("span",{className:"fas fa-trash"})))}};Object.defineProperty(l,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{modifiers:[]}}),l=a([r.b],l),t.a=l},"8gxX":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("Hs9Z");class i{constructor(e=7500,t=18e5){Object.defineProperty(this,"initialDelay",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"maxDelay",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.current=Math.max(e,1)}get(){const e=this.current+Object(r.random)(5e3,2e4);return this.current=Math.min(2*this.current,this.maxDelay),e}reset(){this.current=this.initialDelay}}},"9JFa":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var r=s("/G9H"),i=s("phBA"),n=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]])}return s};function o(e){e.currentTarget.style.display="none"}function a(e){const{hideOnError:t=!1}=e,s=n(e,["hideOnError"]);return t&&(s.onError=o),r.createElement("img",Object.assign({srcSet:`${s.src} 1x, ${Object(i.f)(s.src)} 2x`},s))}},"9zVE":function(e,t,s){"use strict";var r=s("KUml"),i=s("/G9H"),n=s("PPOh"),o=s("tX/w"),a=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let l=class extends i.Component{render(){return this.props.isMarkingAsRead?i.createElement("div",{className:Object(o.a)("notification-action-button",this.props.modifiers)},i.createElement("span",{className:"notification-action-button__text"},this.props.text),i.createElement("div",{className:"notification-action-button__icon"},i.createElement(n.a,null))):i.createElement("button",{className:Object(o.a)("notification-action-button",this.props.modifiers),onClick:this.props.onMarkAsRead,type:"button"},i.createElement("span",{className:"notification-action-button__text"},this.props.text),i.createElement("div",{className:"notification-action-button__icon"},i.createElement("span",{className:"fas fa-check"})))}};Object.defineProperty(l,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{modifiers:[]}}),l=a([r.b],l),t.a=l},AJEZ:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("/G9H"),i=s("4cxI");function n(e){const{groups:t=[],modifiers:s,short:n=!1,wrapper:o}=e;let a=!1;return r.createElement(r.Fragment,null,t.map(e=>{const t=n&&a?`${o} u-hidden-narrow`:o;return a=!0,r.createElement("span",{key:e.identifier,className:t},r.createElement(i.a,{group:e,modifiers:s}))}))}},AU96:function(e,t,s){"use strict";(function(e,r){s.d(t,"a",(function(){return N}));var i,n,o=s("Yin1"),a=s("CnOT"),l=s("Y9Pv"),c=s("DHbW"),u=s("ufn5"),d=s("XMXc"),p=s("C+VY"),m=s("f7bm"),h=s("srn7"),b=s("/G9H"),f=s("LQV2"),v=s.n(f),g=s("I8Ok"),y=s("hc33"),_=s("mk7q"),w=s("peKF"),O=s("sAkl"),j=s("iH//"),E=s("tX/w"),P=function(e,t){return function(){return e.apply(t,arguments)}},k={}.hasOwnProperty;n=b.createElement,i="beatmap-discussion-post";var N=function(t){function s(t){this.validPost=P(this.validPost,this),this.updatePost=P(this.updatePost,this),this.updateCanSave=P(this.updateCanSave,this),this.setMessage=P(this.setMessage,this),this.isTimeline=P(this.isTimeline,this),this.canReport=P(this.canReport,this),this.messageViewer=P(this.messageViewer,this),this.messageEditor=P(this.messageEditor,this),this.isOwner=P(this.isOwner,this),this.handleKeyDownCallback=P(this.handleKeyDownCallback,this),this.editStart=P(this.editStart,this),this.editCancel=P(this.editCancel,this),this.render=P(this.render,this),this.componentWillUnmount=P(this.componentWillUnmount,this),s.__super__.constructor.call(this,t),this.textareaRef=b.createRef(),this.messageBodyRef=b.createRef(),this.throttledUpdatePost=e.throttle(this.updatePost,1e3),this.handleKeyDown=InputHandler.textarea(this.handleKeyDownCallback),this.xhr={},this.reviewEditor=b.createRef(),this.state={canSave:!0,editing:!1,editorMinHeight:"0",posting:!1,message:null}}return function(e,t){for(var s in t)k.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.prototype.componentWillUnmount=function(){var e,t,s,r;for(e in this.throttledUpdatePost.cancel(),s=[],t=this.xhr)k.call(t,e)&&(r=t[e],s.push(null!=r?r.abort():void 0));return s},s.prototype.render=function(){var e,t,s;return t=Object(E.a)(i,((e={})[""+this.props.type]=!0,e.deleted=null!=this.props.post.deleted_at,e.editing=this.state.editing,e.unread=!this.props.read&&"discussion"!==this.props.type,e)),t+=" js-beatmap-discussion-jump",Object(g.div)({className:t,"data-post-id":this.props.post.id,key:this.props.type+"-"+this.props.post.id,onClick:(s=this,function(){return r.publish("beatmapDiscussionPost:markRead",{id:s.props.post.id})})},Object(g.div)({className:i+"__content"},"reply"===this.props.type?n(a.a,{user:this.props.user,group:Object(j.a)({beatmapset:this.props.beatmapset,currentBeatmap:this.props.beatmap,discussion:this.props.discussion,user:this.props.user})}):void 0,this.state.editing?this.messageEditor():this.messageViewer()))},s.prototype.editCancel=function(){return this.setState({editing:!1})},s.prototype.editStart=function(){var e,t;return null!=this.messageBodyRef.current&&(e=this.messageBodyRef.current.getBoundingClientRect().height+50+"px"),this.setState({editing:!0,editorMinHeight:null!=e?e:"0",message:this.props.post.message},(t=this,function(){var e;return null!=(e=t.textareaRef.current)?e.focus():void 0}))},s.prototype.handleKeyDownCallback=function(e,t){switch(e){case InputHandler.SUBMIT:return this.throttledUpdatePost()}},s.prototype.isOwner=function(){return this.props.post.user_id===this.props.beatmapset.user_id},s.prototype.messageEditor=function(){var e,t;if(this.props.canBeEdited)return e=!this.state.posting&&this.state.canSave,Object(g.div)({className:i+"__message-container"},"review"===this.props.discussion.message_type&&"discussion"===this.props.type?n(c.a.Consumer,null,(t=this,function(e){return n(l.a.Consumer,null,(function(s){return n(u.a,{beatmapset:t.props.beatmapset,beatmaps:s,document:t.props.post.message,discussion:t.props.discussion,discussions:e,editMode:!0,editing:t.state.editing,ref:t.reviewEditor,onChange:t.updateCanSave})}))})):n(b.Fragment,null,n(v.a,{style:{minHeight:this.state.editorMinHeight},disabled:this.state.posting,className:i+"__message "+i+"__message--editor",onChange:this.setMessage,onKeyDown:this.handleKeyDown,value:this.state.message,ref:this.textareaRef}),n(o.a,{message:this.state.message,isTimeline:this.isTimeline()})),Object(g.div)({className:i+"__actions"},Object(g.div)({className:i+"__actions-group"}),Object(g.div)({className:i+"__actions-group"},Object(g.div)({className:i+"__action"},n(p.a,{disabled:this.state.posting,props:{onClick:this.editCancel},text:osu.trans("common.buttons.cancel")})),Object(g.div)({className:i+"__action"},n(p.a,{disabled:!e,props:{onClick:this.throttledUpdatePost},text:osu.trans("common.buttons.save")})))))},s.prototype.messageViewer=function(){var e,t,s,r,o,a,l,c;return e=(a="reply"===this.props.type?["beatmapsets.discussions.posts","post",this.props.post]:["beatmapsets.discussions","discussion",this.props.discussion])[0],s=a[1],t=a[2],Object(g.div)({className:i+"__message-container"},"review"===this.props.discussion.message_type&&"discussion"===this.props.type?Object(g.div)({className:i+"__message"},n(d.a,{discussions:this.context.discussions,message:this.props.post.message})):Object(g.div)({className:i+"__message",ref:this.messageBodyRef,dangerouslySetInnerHTML:{__html:BeatmapDiscussionHelper.format(this.props.post.message)}}),Object(g.div)({className:i+"__info-container"},Object(g.span)({className:i+"__info"},n(w.a,{dateTime:this.props.post.created_at,relative:!0})),null!=t.deleted_at?Object(g.span)({className:i+"__info "+i+"__info--edited"},n(_.a,{mappings:{editor:n(O.a,{className:i+"__info-user",user:null!=(l=this.props.users[t.deleted_by_id])?l:h.b}),delete_time:n(w.a,{dateTime:t.deleted_at,relative:!0})},pattern:osu.trans("beatmaps.discussions.deleted")})):void 0,this.props.post.updated_at!==this.props.post.created_at&&null!=this.props.lastEditor?Object(g.span)({className:i+"__info "+i+"__info--edited"},n(_.a,{mappings:{editor:n(O.a,{className:i+"__info-user",user:this.props.lastEditor}),update_time:n(w.a,{dateTime:this.props.post.updated_at,relative:!0})},pattern:osu.trans("beatmaps.discussions.edited")})):void 0,"discussion"===this.props.type&&this.props.discussion.kudosu_denied?Object(g.span)({className:i+"__info "+i+"__info--edited"},osu.trans("beatmaps.discussions.kudosu_denied")):void 0),Object(g.div)({className:i+"__actions"},Object(g.div)({className:i+"__actions-group"},Object(g.span)({className:i+"__action "+i+"__action--button"},n(m.a,{value:BeatmapDiscussionHelper.url({discussion:this.props.discussion,post:"reply"===this.props.type?this.props.post:void 0}),label:osu.trans("common.buttons.permalink"),valueAsUrl:!0})),this.props.canBeEdited?Object(g.button)({className:i+"__action "+i+"__action--button",onClick:this.editStart},osu.trans("beatmaps.discussions.edit")):void 0,null==t.deleted_at&&this.props.canBeDeleted?Object(g.a)({className:"js-beatmapset-discussion-update "+i+"__action "+i+"__action--button",href:laroute.route(e+".destroy",(r={},r[""+s]=t.id,r)),"data-remote":!0,"data-method":"DELETE","data-confirm":osu.trans("common.confirmation")},osu.trans("beatmaps.discussions.delete")):void 0,null!=t.deleted_at&&this.props.canBeRestored?Object(g.a)({className:"js-beatmapset-discussion-update "+i+"__action "+i+"__action--button",href:laroute.route(e+".restore",(o={},o[""+s]=t.id,o)),"data-remote":!0,"data-method":"POST","data-confirm":osu.trans("common.confirmation")},osu.trans("beatmaps.discussions.restore")):void 0,"discussion"===this.props.type&&(null!=(c=this.props.discussion.current_user_attributes)?c.can_moderate_kudosu:void 0)?this.props.discussion.can_grant_kudosu?Object(g.a)({className:"js-beatmapset-discussion-update "+i+"__action "+i+"__action--button",href:laroute.route("beatmapsets.discussions.deny-kudosu",{discussion:this.props.discussion.id}),"data-remote":!0,"data-method":"POST","data-confirm":osu.trans("common.confirmation")},osu.trans("beatmaps.discussions.deny_kudosu")):this.props.discussion.kudosu_denied?Object(g.a)({className:"js-beatmapset-discussion-update "+i+"__action "+i+"__action--button",href:laroute.route("beatmapsets.discussions.allow-kudosu",{discussion:this.props.discussion.id}),"data-remote":!0,"data-method":"POST","data-confirm":osu.trans("common.confirmation")},osu.trans("beatmaps.discussions.allow_kudosu")):void 0:void 0,this.canReport()?n(y.a,{className:i+"__action "+i+"__action--button",reportableId:this.props.post.id,reportableType:"beatmapset_discussion_post",user:this.props.user}):void 0)))},s.prototype.canReport=function(){return null!=currentUser.id&&this.props.post.user_id!==currentUser.id},s.prototype.isTimeline=function(){return null!=this.props.discussion.timestamp},s.prototype.setMessage=function(e){return this.setState({message:e.target.value},this.updateCanSave)},s.prototype.updateCanSave=function(){return this.setState({canSave:this.validPost()})},s.prototype.updatePost=function(){var t,s,i;if(t=this.state.message,"review"===this.props.discussion.message_type&&"discussion"===this.props.type){if(t=this.reviewEditor.current.serialize(),e.isEqual(JSON.parse(this.props.post.message),JSON.parse(t)))return void this.setState({editing:!1});if(!this.reviewEditor.current.showConfirmationIfRequired())return;this.setState({message:t})}if(t!==this.props.post.message)return this.setState({posting:!0}),null!=(s=this.xhr.updatePost)&&s.abort(),this.xhr.updatePost=r.ajax(laroute.route("beatmapsets.discussions.posts.update",{post:this.props.post.id}),{method:"PUT",data:{beatmap_discussion_post:{message:t}}}).done((i=this,function(e){return i.setState({editing:!1}),r.publish("beatmapsetDiscussions:update",{beatmapset:e})})).fail(osu.ajaxError).always(function(e){return function(){return e.setState({posting:!1})}}(this));this.setState({editing:!1})},s.prototype.validPost=function(){var e;return"review"===this.props.discussion.message_type&&"discussion"===this.props.type?null!=(e=this.reviewEditor.current)?e.canSave:void 0:BeatmapDiscussionHelper.validMessageLength(this.state.message,this.isTimeline())},s}(b.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},BCxl:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return m}));var r=s("Hs9Z"),i=s("/G9H"),n=s("tSlR"),o=s("dTpI"),a=s("tX/w"),l=s("vZz4"),c=s("5AHq"),u=s("yJmy"),d=s("zr5c"),p=s("ss8h");class m extends i.Component{constructor(){super(...arguments),Object.defineProperty(this,"bn",{enumerable:!0,configurable:!0,writable:!0,value:"beatmap-discussion-review-post-embed-preview"}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"tooltipContent",{enumerable:!0,configurable:!0,writable:!0,value:i.createRef()}),Object.defineProperty(this,"tooltipEl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"componentDidMount",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.editable()&&n.h.setNodes(this.context,{timestamp:void 0},{at:this.path()})}}),Object.defineProperty(this,"componentDidUpdate",{enumerable:!0,configurable:!0,writable:!0,value:()=>{if(!this.editable())return;const e=this.path();let t=!1;if(this.props.element.beatmapId){const s=this.props.element.children[0].text,r=BeatmapDiscussionHelper.TIMESTAMP_REGEX.exec(s);let i;null!==r&&0===r.index&&(i=r[2]),i!==this.props.element.timestamp&&(t=!0),n.h.setNodes(this.context,{timestamp:i},{at:e})}else n.h.setNodes(this.context,{timestamp:void 0},{at:e}),t=!0;t&&(this.cache={},this.destroyTooltip())}}),Object.defineProperty(this,"createTooltip",{enumerable:!0,configurable:!0,writable:!0,value:t=>{const s=this.timestamp();if(null==s)return;const r=t.currentTarget,i=`${this.selectedBeatmap()}-${s}`;this.tooltipEl&&this.tooltipEl._tooltip===i||(this.tooltipEl=r,r._tooltip=i,e(r).qtip({content:{text:()=>{var e;return null===(e=this.tooltipContent.current)||void 0===e?void 0:e.innerHTML}},hide:{delay:200,fixed:!0},position:{at:"top center",my:"bottom center",viewport:e(window)},show:{delay:200,ready:!0},style:{classes:"tooltip-default tooltip-default--interactable"}}),this.tooltipEl=r)}}),Object.defineProperty(this,"delete",{enumerable:!0,configurable:!0,writable:!0,value:()=>{window.setTimeout(()=>n.h.delete(this.context,{at:this.path()}),0)}}),Object.defineProperty(this,"destroyTooltip",{enumerable:!0,configurable:!0,writable:!0,value:()=>{if(!this.tooltipEl)return;const t=e(this.tooltipEl).qtip("api");t&&(t.destroy(),this.tooltipEl=void 0)}}),Object.defineProperty(this,"discussionType",{enumerable:!0,configurable:!0,writable:!0,value:()=>this.props.element.discussionType}),Object.defineProperty(this,"editable",{enumerable:!0,configurable:!0,writable:!0,value:()=>!(this.props.editMode&&this.props.element.discussionId)}),Object.defineProperty(this,"isRelevantDiscussion",{enumerable:!0,configurable:!0,writable:!0,value:e=>null!=e&&e.beatmap_id===this.selectedBeatmap()}),Object.defineProperty(this,"nearbyDiscussions",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var e;const t=this.timestamp();if(null==t)return[];if(!this.cache.nearbyDiscussions||this.cache.nearbyDiscussions.timestamp!==t||this.cache.nearbyDiscussions.beatmap_id!==this.selectedBeatmap()){const e=r.filter(this.props.discussions,this.isRelevantDiscussion);this.cache.nearbyDiscussions={beatmap_id:this.selectedBeatmap(),discussions:BeatmapDiscussionHelper.nearbyDiscussions(e,t),timestamp:t}}return null===(e=this.cache.nearbyDiscussions)||void 0===e?void 0:e.discussions}}),Object.defineProperty(this,"nearbyDraftEmbeds",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=this.timestamp();if(null!=t&&0!==e.length)return e.filter(e=>{if(!e.timestamp||e.beatmapId!==this.props.element.beatmapId)return!1;const s=BeatmapDiscussionHelper.parseTimestamp(e.timestamp);return null!=s&&Math.abs(s-t)<=5e3})}}),Object.defineProperty(this,"nearbyIndicator",{enumerable:!0,configurable:!0,writable:!0,value:e=>{if(null==this.timestamp()||"praise"===this.discussionType())return;const t=this.editable()?this.nearbyDiscussions():[],s=this.nearbyDraftEmbeds(e)||[];if(t.length>0||s.length>1){const e=t.map(e=>{const t=BeatmapDiscussionHelper.formatTimestamp(e.timestamp);if(null!=t)return this.props.editMode?t:Object(l.f)(BeatmapDiscussionHelper.url({discussion:e}),t,{classNames:["js-beatmap-discussion--jump"]})});s.length>1&&e.push(osu.trans("beatmap_discussions.nearby_posts.unsaved",{count:s.length-1}));const r=osu.transArray(e),n=osu.trans("beatmap_discussions.nearby_posts.notice",{existing_timestamps:r,timestamp:this.props.element.timestamp});return i.createElement("div",{className:`${this.bn}__indicator ${this.bn}__indicator--warning`,contentEditable:!1,onMouseOver:this.createTooltip,onTouchStart:this.createTooltip},i.createElement("script",{dangerouslySetInnerHTML:{__html:n},ref:this.tooltipContent,type:"text/html"}),i.createElement("i",{className:"fas fa-exclamation-triangle"}))}}}),Object.defineProperty(this,"path",{enumerable:!0,configurable:!0,writable:!0,value:()=>o.b.findPath(this.context,this.props.element)}),Object.defineProperty(this,"selectedBeatmap",{enumerable:!0,configurable:!0,writable:!0,value:()=>this.props.element.beatmapId}),Object.defineProperty(this,"timestamp",{enumerable:!0,configurable:!0,writable:!0,value:()=>BeatmapDiscussionHelper.parseTimestamp(this.props.element.timestamp)})}componentWillUnmount(){this.destroyTooltip()}render(){const e=this.editable(),t=e?[]:["read-only"];let s,r=this.props.element.timestamp;null!=this.props.element.beatmapId?s="diff":(s="all-diff",r=void 0);const n=osu.trans(`beatmaps.discussions.review.embed.timestamp.${s}`,{type:osu.trans(`beatmaps.discussions.message_type.${this.discussionType()}`)}),o=i.createElement("button",{className:`${this.bn}__delete`,contentEditable:!1,disabled:this.props.readOnly,onClick:this.delete,title:osu.trans(`beatmaps.discussions.review.embed.${e?"delete":"unlink"}`)},i.createElement("i",{className:`fas fa-${e?"trash-alt":"link"}`})),l=i.createElement(c.a.Consumer,null,this.nearbyIndicator),p=this.props.editMode&&e?i.createElement("div",{className:`${this.bn}__indicator`,contentEditable:!1,title:osu.trans("beatmaps.discussions.review.embed.unsaved")},i.createElement("i",{className:"fas fa-pencil-alt"})):null;return i.createElement("div",Object.assign({className:"beatmap-discussion beatmap-discussion--preview",contentEditable:e,suppressContentEditableWarning:!0},this.props.attributes),i.createElement("div",{className:Object(a.a)(this.bn,t)},i.createElement("div",{className:`${this.bn}__content`},i.createElement("div",{className:`${this.bn}__selectors`,contentEditable:!1},i.createElement(u.a,Object.assign({},this.props,{disabled:this.props.readOnly||!e})),i.createElement(d.a,Object.assign({},this.props,{disabled:this.props.readOnly||!e})),i.createElement("div",{className:`${this.bn}__timestamp`,contentEditable:!1},i.createElement("span",{title:e?n:""},null!=r?r:osu.trans("beatmap_discussions.timestamp_display.general"))),p,l),i.createElement("div",{className:`${this.bn}__stripe`,contentEditable:!1}),i.createElement("div",{className:`${this.bn}__message-container`},i.createElement("div",{className:"beatmapset-discussion-message"},this.props.children)),p,l)),o)}}Object.defineProperty(m,"contextType",{enumerable:!0,configurable:!0,writable:!0,value:p.a})}).call(this,s("5wds"))},BOGZ:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("7EfK"),i=s("/G9H"),n=s("q7/B");function o({stats:e}){const t=r.duration(e.play_time,"seconds"),s=Math.floor(t.asDays()),o=t.hours(),a=Math.floor(t.asMinutes()),l=a%60;let c=Math.round(t.asHours()),u="hours";c<2&&(c=a,u="minutes");const d=osu.transChoice(`common.count.${u}`,c);let p=s>0?`${osu.formatNumber(s)}d `:"";return p+=`${o}h ${l}m`,i.createElement(n.a,{label:osu.trans("users.show.stats.play_time"),value:i.createElement("span",{"data-tooltip-position":"bottom center",title:d},p)})}},BSzr:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return C}));var r=s("zFzD"),i=s("nN9y"),n=s("aMFG"),o=s("TyNR"),a=s("mArn"),l=s("eIGF"),c=s("o70V"),u=s("+kdZ"),d=s("3J26"),p=s("2Kkx"),m=s("msVt"),h=s("70Tv"),b=s("pTWL"),f=s("kD1C"),v=s("iCid"),g=s("3Wjd"),y=s("bPNN"),_=s("YvoO"),w=s("zrLC"),O=s("4PJi"),j=s("dC65"),E=s("bSvc"),P=s("x6t3"),k=s("lv9K"),N=s("I7Md"),S=s("0VTr"),x=s("VsY1"),T=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class C{constructor(){Object.defineProperty(this,"beatmapsetSearchController",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"captcha",{enumerable:!0,configurable:!0,writable:!0,value:new n.a}),Object.defineProperty(this,"chatWorker",{enumerable:!0,configurable:!0,writable:!0,value:new i.a}),Object.defineProperty(this,"clickMenu",{enumerable:!0,configurable:!0,writable:!0,value:new o.a}),Object.defineProperty(this,"currentUser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dataStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"enchant",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"forumPoll",{enumerable:!0,configurable:!0,writable:!0,value:new l.a}),Object.defineProperty(this,"forumPostEdit",{enumerable:!0,configurable:!0,writable:!0,value:new c.a}),Object.defineProperty(this,"forumPostInput",{enumerable:!0,configurable:!0,writable:!0,value:new u.a}),Object.defineProperty(this,"localtime",{enumerable:!0,configurable:!0,writable:!0,value:new d.a}),Object.defineProperty(this,"mobileToggle",{enumerable:!0,configurable:!0,writable:!0,value:new p.a}),Object.defineProperty(this,"notificationsWorker",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"osuAudio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"osuLayzr",{enumerable:!0,configurable:!0,writable:!0,value:new h.a}),Object.defineProperty(this,"reactTurbolinks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"referenceLinkTooltip",{enumerable:!0,configurable:!0,writable:!0,value:new j.a}),Object.defineProperty(this,"socketWorker",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stickyHeader",{enumerable:!0,configurable:!0,writable:!0,value:new f.a}),Object.defineProperty(this,"timeago",{enumerable:!0,configurable:!0,writable:!0,value:new v.a}),Object.defineProperty(this,"turbolinksReload",{enumerable:!0,configurable:!0,writable:!0,value:new g.a}),Object.defineProperty(this,"userLogin",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"userLoginObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"userPreferences",{enumerable:!0,configurable:!0,writable:!0,value:new w.a}),Object.defineProperty(this,"userVerification",{enumerable:!0,configurable:!0,writable:!0,value:new O.a}),Object.defineProperty(this,"windowFocusObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"windowSize",{enumerable:!0,configurable:!0,writable:!0,value:new P.a}),Object.defineProperty(this,"onCurrentUserUpdate",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{this.setCurrentUser(t)}}),Object.defineProperty(this,"onPageLoad",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.setCurrentUser(window.currentUser)}}),Object.defineProperty(this,"setCurrentUser",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t;const s=null==e.id?void 0:e;null!=s&&this.dataStore.userStore.getOrCreate(s.id,s),this.socketWorker.setUserId(null!==(t=null==s?void 0:s.id)&&void 0!==t?t:null),this.currentUser=s,this.userPreferences.setUser(this.currentUser)}}),e(document).on("turbolinks:load.osu-core",this.onPageLoad),e.subscribe("user:update",this.onCurrentUserUpdate),this.enchant=new a.a(this.turbolinksReload),this.osuAudio=new m.a(this.userPreferences),this.reactTurbolinks=new b.a(this.turbolinksReload),this.userLogin=new y.a(this.captcha),this.dataStore=new x.a,this.userLoginObserver=new _.a,this.windowFocusObserver=new E.a,this.beatmapsetSearchController=new r.a(this.dataStore.beatmapsetSearch),this.socketWorker=new S.a,this.notificationsWorker=new N.a(this.socketWorker),Object(k.p)(this)}get currentUserOrFail(){if(null==this.currentUser)throw new Error("current user is null");return this.currentUser}}T([k.q],C.prototype,"currentUser",void 0),T([k.h],C.prototype,"currentUserOrFail",null),T([k.f],C.prototype,"setCurrentUser",void 0)}).call(this,s("5wds"))},BTwX:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return p}));var r=s("Hs9Z"),i=s("vcN5"),n=s("/G9H"),o=s("tSlR"),a=s("dTpI"),l=s("cX0L"),c=s("gcbN"),u=s("ss8h");const d="beatmap-discussion-editor-toolbar";class p extends n.Component{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:n.createRef()}),Object.defineProperty(this,"scrollContainer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"eventId",{enumerable:!0,configurable:!0,writable:!0,value:`editor-toolbar-${Object(l.a)()}`}),Object.defineProperty(this,"scrollTimer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"throttledUpdate",{enumerable:!0,configurable:!0,writable:!0,value:r.throttle(this.updatePosition.bind(this),100)})}componentDidMount(){e(window).on(`scroll.${this.eventId}`,this.throttledUpdate),this.updatePosition()}componentDidUpdate(){this.updatePosition()}componentWillUnmount(){e(window).off(`.${this.eventId}`),this.scrollContainer&&e(this.scrollContainer).off(`.${this.eventId}`),this.throttledUpdate.cancel()}hide(){const e=this.ref.current;e&&(e.style.display="none")}render(){return this.context&&this.visible()?n.createElement(i.a,null,n.createElement("div",{ref:this.ref,className:d},n.createElement(c.a,{format:"bold"}),n.createElement(c.a,{format:"italic"}),n.createElement("div",{className:`${d}__popup-tail`}))):null}setScrollContainer(t){this.scrollContainer&&e(this.scrollContainer).off(`.${this.eventId}`),this.scrollContainer=t,e(this.scrollContainer).on(`scroll.${this.eventId}`,this.throttledUpdate)}updatePosition(){const e=this.ref.current;e&&this.context&&(this.scrollTimer&&window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{var t,s,r;if(!this.visible())return this.hide();for(const e of o.a.positions(this.context,{at:null!==(t=this.context.selection)&&void 0!==t?t:void 0,unit:"block"})){if("embed"===o.c.parent(this.context,e.path).type)return this.hide()}const i=null===(s=this.scrollContainer)||void 0===s?void 0:s.getBoundingClientRect(),n=null!==(r=null==i?void 0:i.top)&&void 0!==r?r:0,a=null==i?void 0:i.bottom,l=window.getSelection().getRangeAt(0).getBoundingClientRect();if(l.top<n||a&&l.top>a)return this.hide();e.style.display="block",e.style.left=`${l.left+(window.pageXOffset-e.offsetWidth)/2+l.width/2}px`,e.style.top=`${l.top-e.clientHeight-10}px`},10))}visible(){const{selection:e}=this.context;if(!e||!a.b.isFocused(this.context)||o.f.isCollapsed(e)||""===o.a.string(this.context,e))return!1;const t=window.getSelection();return null!==(null==t?void 0:t.getRangeAt(0))}}Object.defineProperty(p,"contextType",{enumerable:!0,configurable:!0,writable:!0,value:u.a})}).call(this,s("5wds"))},BvKu:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return p}));var r=s("/G9H"),i=s("WKXC"),n=s("I8Ok"),o=s("LhsB"),a=s("LPNJ"),l=s("cX0L"),c=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty,d=[].indexOf||function(e){for(var t=0,s=this.length;t<s;t++)if(t in this&&this[t]===e)return t;return-1},p=function(t){function s(e){this.renderMenu=c(this.renderMenu,this),this.render=c(this.render,this),this.removePortal=c(this.removePortal,this),this.addPortal=c(this.addPortal,this),this.tooltipElement=c(this.tooltipElement,this),this.toggle=c(this.toggle,this),this.isMenuInPath=c(this.isMenuInPath,this),this.hide=c(this.hide,this),this.dismiss=c(this.dismiss,this),this.componentWillUnmount=c(this.componentWillUnmount,this),this.componentDidUpdate=c(this.componentDidUpdate,this),this.resize=c(this.resize,this),this.componentDidMount=c(this.componentDidMount,this),s.__super__.constructor.call(this,e),this.eventId="popup-menu-"+Object(l.a)(),this.button=Object(r.createRef)(),this.menu=Object(r.createRef)(),this.state={active:!1}}return function(e,t){for(var s in t)u.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.contextType=o.a,s.defaultProps={children:function(e){},direction:"left"},s.prototype.componentDidMount=function(){return this.tooltipHideEvent=this.tooltipElement().qtip("option","hide.event"),e(window).on("resize."+this.eventId,this.resize),e(document).on("turbolinks:before-cache."+this.eventId,this.removePortal)},s.prototype.resize=function(){var e,t,s,r,i,n;if(this.state.active){if(null!=this.button.current.offsetParent)return e=this.button.current.getBoundingClientRect(),s=this.menu.current.getBoundingClientRect(),r=window.scrollX,i=window.scrollY,t=r+e.right,("right"===this.props.direction||e.x-s.width<0)&&(t+=s.width-e.width),this.portal.style.display="block",this.portal.style.position="absolute",this.portal.style.top=Math.floor(i+e.bottom+5)+"px",this.portal.style.left=Math.floor(t)+"px",null!=(n=this.tooltipElement()[0])?this.portal.style.zIndex=getComputedStyle(n).zIndex:void 0;this.portal.style.display="none"}},s.prototype.componentDidUpdate=function(t,s){var r,i;if(s.active!==this.state.active)return this.state.active?(this.addPortal(),this.resize(),this.tooltipElement().qtip("option","hide.event",!1),e(document).on("click."+this.uuid+" keydown."+this.uuid,this.hide),"function"==typeof(r=this.props).onShow?r.onShow():void 0):(this.removePortal(),this.tooltipElement().qtip("option","hide.event",this.tooltipHideEvent),e(document).off("click."+this.uuid+" keydown."+this.uuid,this.hide),"function"==typeof(i=this.props).onHide?i.onHide():void 0)},s.prototype.componentWillUnmount=function(){return e(document).off("."+this.uuid),e(window).off("."+this.uuid)},s.prototype.dismiss=function(){return this.setState({active:!1})},s.prototype.hide=function(e){var t;if(this.state.active&&!Object(a.a)()&&null!=(t=e.originalEvent))return 27===t.keyCode||0===t.button&&!this.isMenuInPath(t.composedPath())?this.setState({active:!1}):void 0},s.prototype.isMenuInPath=function(e){var t,s;return t=this.button.current,d.call(e,t)>=0||(s=this.portal,d.call(e,s)>=0)},s.prototype.toggle=function(){return this.setState({active:!this.state.active})},s.prototype.tooltipElement=function(){return e(this.context).closest(".qtip")},s.prototype.addPortal=function(){if(null==this.portal.parentElement)return document.body.appendChild(this.portal)},s.prototype.removePortal=function(){if(null!=this.portal.parentElement)return document.body.removeChild(this.portal)},s.prototype.render=function(){return null==this.portal&&(this.portal=document.createElement("div")),this.props.customRender?this.props.customRender(Object(i.createPortal)(this.renderMenu(),this.portal),this.button,this.toggle):Object(n.div)({className:"popup-menu",ref:this.button},Object(n.button)({className:"popup-menu__button",type:"button",onClick:this.toggle},Object(n.i)({className:"fas fa-ellipsis-v"})),Object(i.createPortal)(this.renderMenu(),this.portal))},s.prototype.renderMenu=function(){return this.state.active?Object(n.div)({className:"popup-menu-float",ref:this.menu},this.props.children(this.dismiss)):null},s}(r.PureComponent)}).call(this,s("5wds"))},"C+VY":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("/G9H"),i=s("PPOh"),n=s("tX/w");class o extends r.PureComponent{get text(){return null==this.props.text?null:"string"==typeof this.props.text?{top:this.props.text}:this.props.text}render(){let e=Object(n.a)("btn-osu-big",this.props.modifiers,{disabled:this.props.disabled});return null!=this.props.extraClasses&&(e+=` ${this.props.extraClasses.join(" ")}`),osu.present(this.props.href)?this.props.disabled?r.createElement("span",Object.assign({className:e},this.props.props),this.renderChildren()):r.createElement("a",Object.assign({className:e,href:this.props.href},this.props.props),this.renderChildren()):r.createElement("button",Object.assign({className:e,disabled:this.props.disabled,type:this.props.isSubmit?"submit":"button"},this.props.props),this.renderChildren())}renderChildren(){const e=this.text;return r.createElement("span",{className:Object(n.a)("btn-osu-big__content",{center:null==e||null==this.props.icon})},null!=e&&r.createElement("span",{className:"btn-osu-big__left"},r.createElement("span",{className:"btn-osu-big__text-top"},e.top),"bottom"in e&&null!=e.bottom&&r.createElement("span",{className:"btn-osu-big__text-bottom"},e.bottom)),null!=this.props.icon&&r.createElement("span",{className:"btn-osu-big__icon"},r.createElement("span",{className:"fa fa-fw"},this.props.isBusy?r.createElement(i.a,{modifiers:"center-inline"}):r.createElement("span",{className:this.props.icon}))))}}Object.defineProperty(o,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{disabled:!1,extraClasses:[],isBusy:!1,isSubmit:!1,props:{}}})},C92G:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("BvKu"),i=s("/G9H"),n=s("ZG74");function o(e){const t=i.useContext(n.a),s=i.useContext(n.b),o=i.useCallback(()=>t.activeKeyDidChange(null),[t]),a=i.useCallback(()=>t.activeKeyDidChange(s),[t,s]);return i.createElement(r.a,Object.assign({onHide:o,onShow:a},e))}},Cfan:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return a}));var r=s("0h6b"),i=s("lv9K"),n=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o},o=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(t){n(t)}}function a(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};class a{constructor(e){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isRevoking",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"revoked",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"scopes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"userId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.id=e.id,this.name=e.name,this.scopes=new Set(e.scopes),this.userId=e.user_id,this.user=e.user,Object(i.p)(this)}revoke(){return o(this,void 0,void 0,(function*(){return this.isRevoking=!0,e.ajax({method:"DELETE",url:Object(r.route)("oauth.authorized-clients.destroy",{authorized_client:this.id})}).then(()=>{this.revoked=!0}).always(()=>{this.isRevoking=!1})}))}}n([i.q],a.prototype,"isRevoking",void 0),n([i.q],a.prototype,"revoked",void 0),n([i.q],a.prototype,"scopes",void 0),n([i.f],a.prototype,"revoke",null)}).call(this,s("5wds"))},CnOT:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var r,i,n=s("uWCK"),o=s("4cxI"),a=s("I8Ok"),l=s("tX/w"),c=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty;i=e.createElement,r="beatmap-discussion-user-card";var d=function(e){function t(){return this.render=c(this.render,this),t.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)u.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,e),t.prototype.render=function(){var e,t,s,c,u;return e=null!=(c=this.props.additionalClasses)?c:[],t=null!=(u=this.props.hideStripe)&&u,s=this.props.user.is_deleted?a.span:a.a,Object(a.div)({className:Object(l.a)(r,e),style:osu.groupColour(this.props.group)},Object(a.div)({className:r+"__avatar"},s({className:r+"__user-link",href:laroute.route("users.show",{user:this.props.user.id})},i(n.a,{user:this.props.user,modifiers:["full-rounded"]}))),Object(a.div)({className:r+"__user"},Object(a.div)({className:r+"__user-row"},s({className:r+"__user-link",href:laroute.route("users.show",{user:this.props.user.id})},Object(a.span)({className:r+"__user-text u-ellipsis-overflow"},this.props.user.username)),this.props.user.is_bot||this.props.user.is_deleted?void 0:Object(a.a)({className:r+"__user-modding-history-link",href:laroute.route("users.modding.index",{user:this.props.user.id}),title:osu.trans("beatmap_discussion_posts.item.modding_history_link")},Object(a.i)({className:"fas fa-align-left"}))),Object(a.div)({className:r+"__user-badge"},i(o.a,{group:this.props.group}))),t?void 0:Object(a.div)({className:r+"__user-stripe"}))},t}(e.PureComponent)}).call(this,s("/G9H"))},Cy5r:function(e,t,s){"use strict";function r({allowedBlocks:e=[],allowedInlines:t=[]}={}){e.push("root","newline"),t.push("text"),this.Parser.prototype.blockMethods.filter(t=>!e.includes(t)).forEach(e=>{this.Parser.prototype.blockTokenizers[e]=()=>!0}),this.Parser.prototype.inlineMethods.filter(e=>!t.includes(e)).forEach(e=>{this.Parser.prototype.inlineTokenizers[e]=()=>!0,this.Parser.prototype.inlineTokenizers[e].locator=()=>-1})}s.d(t,"a",(function(){return r}))},DHbW:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("/G9H");const i=Object(r.createContext)({})},EaeJ:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return c}));var r=s("/G9H"),i=s("I8Ok"),n=s("tX/w"),o=s("vZz4"),a=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty;r.createElement;var c=function(t){function s(){return this.renderHeaderStream=a(this.renderHeaderStream,this),this.render=a(this.render,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)l.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.prototype.render=function(){var e;return Object(i.div)({className:Object(n.a)("update-streams-v2",[null!=this.props.currentStreamId?"with-active":void 0])},Object(i.div)({className:"update-streams-v2__container"},function(){var t,s,r,i;for(i=[],t=0,s=(r=this.props.updateStreams).length;t<s;t++)e=r[t],i.push(this.renderHeaderStream({stream:e}));return i}.call(this)))},s.prototype.renderHeaderStream=function(t){var s,r,a;return r=t.stream,a=e.kebabCase(r.display_name),s=Object(n.a)("update-streams-v2__item",[a,r.is_featured?"featured":void 0,this.props.currentStreamId===r.id?"active":void 0]),s+=" t-changelog-stream--"+a,Object(i.a)({href:Object(o.c)(r.latest_build),key:r.id,className:s},Object(i.div)({className:"update-streams-v2__bar u-changelog-stream--bg"}),Object(i.p)({className:"update-streams-v2__row update-streams-v2__row--name"},r.display_name),Object(i.p)({className:"update-streams-v2__row update-streams-v2__row--version"},r.latest_build.display_version),r.user_count>0?Object(i.p)({className:"update-streams-v2__row update-streams-v2__row--users"},osu.transChoice("changelog.builds.users_online",r.user_count)):void 0)},s}(r.PureComponent)}).call(this,s("Hs9Z"))},FAY1:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var r=s("0h6b"),i=s("C92G"),n=s("/G9H"),o=s("hc33"),a=s("u/q5");class l extends n.PureComponent{render(){const{score:e}=this.props;return n.createElement(i.a,null,t=>{var s,i;return n.createElement("div",{className:"simple-menu"},Object(a.d)(e)&&n.createElement("a",{className:"simple-menu__item",href:Object(r.route)("scores.show",{mode:e.mode,score:e.best_id})},osu.trans("users.show.extra.top_ranks.view_details")),Object(a.c)(e)&&n.createElement("a",{className:"simple-menu__item js-login-required--click","data-turbolinks":!1,href:Object(r.route)("scores.download",{mode:e.mode,score:e.best_id}),onClick:t},osu.trans("users.show.extra.top_ranks.download_replay")),Object(a.a)(e)&&n.createElement(o.a,{baseKey:"scores",className:"simple-menu__item",reportableId:null!==(i=null===(s=e.best_id)||void 0===s?void 0:s.toString())&&void 0!==i?i:"",reportableType:`score_best_${e.mode}`,user:e.user}))})}}},FiYg:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return l}));var r=s("lv9K"),i=s("JlDh"),n=s("is6n"),o=s("vZz4"),a=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class l{constructor(e,t,s){Object.defineProperty(this,"notificationStore",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"contextType",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"currentFilter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"typeNamesWithoutNull",{enumerable:!0,configurable:!0,writable:!0,value:i.c.filter(e=>!(null==e||this.isExcluded(e)))}),this.currentFilter=void 0!==s?s:this.typeNameFromUrl,this.store=t.isWidget?e.unreadStacks:e.stacks,Object(r.p)(this)}get stacks(){return this.store.orderedStacksOfType(this.currentFilter).filter(e=>e.hasVisibleNotifications&&!this.isExcluded(e.objectType))}get type(){return this.store.getOrCreateType({objectType:this.currentFilter})}get typeNameFromUrl(){return Object(i.b)(Object(n.b)().get("type"))}getTotal(e){return null==e.name?this.typeNamesWithoutNull.reduce((e,t)=>e+this.store.getOrCreateType({objectType:t}).total,0):e.total}getType(e){return this.store.getOrCreateType({objectType:e})}loadMore(){var e;null===(e=this.type)||void 0===e||e.loadMore(this.contextType)}markCurrentTypeAsRead(){if(null==this.type.name)for(const e of this.typeNamesWithoutNull)this.store.getOrCreateType({objectType:e}).markTypeAsRead();else this.type.markTypeAsRead()}navigateTo(t){if(this.currentFilter=t,0===[...this.stacks].length&&this.loadMore(),!this.contextType.isWidget){let s;if(null==t){const e=new URL(Object(n.a)().href);e.searchParams.delete("type"),s=e.href}else s=Object(o.i)(null,{type:t});e.controller.advanceHistory(s)}}isExcluded(e){return this.contextType.excludes.includes(e)}}a([r.q],l.prototype,"currentFilter",void 0),a([r.h],l.prototype,"stacks",null),a([r.h],l.prototype,"type",null),a([r.f],l.prototype,"loadMore",null),a([r.f],l.prototype,"markCurrentTypeAsRead",null),a([r.f],l.prototype,"navigateTo",null)}).call(this,s("dMdw"))},G27q:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));class r{constructor(e){Object.defineProperty(this,"connected",{enumerable:!0,configurable:!0,writable:!0,value:e})}}},HGQb:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("f4vq");function i(e){var t;return null!=(null===(t=r.a.currentUser)||void 0===t?void 0:t.blocks.find(t=>t.target_id===e.id))}},I7Md:function(e,t,s){"use strict";(function(e){var r=s("WLnA"),i=s("0h6b"),n=s("lv9K"),o=s("tz7b"),a=s("8gxX"),l=s("uW+8"),c=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let u=class{constructor(t){Object.defineProperty(this,"socketWorker",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"waitingVerification",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"firstLoadedAt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"retryDelay",{enumerable:!0,configurable:!0,writable:!0,value:new a.a}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"xhr",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"xhrLoadingState",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"loadMore",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.xhrLoadingState.loadMore||(window.clearTimeout(this.timeout.loadMore),this.xhrLoadingState.loadMore=!0,this.xhr.loadMore=e.ajax({dataType:"json",url:Object(i.route)("notifications.index",{unread:1})}).always(()=>{this.xhrLoadingState.loadMore=!1}).done(Object(n.f)(e=>{this.waitingVerification=!1,this.loadBundle(e),this.retryDelay.reset()})).fail(Object(n.f)(e=>{null==e.responseJSON||"verification"!==e.responseJSON.error?401!==e.status&&this.delayedRetryInitialLoadMore():this.waitingVerification=!0})))}}),Object(n.r)(this.socketWorker,"connectionStatus",e=>{"connected"===e.newValue&&this.loadMore()},!0),e.subscribe("user-verification:success.notifications-worker",()=>{this.loadMore()}),Object(n.p)(this)}get hasData(){return null!=this.firstLoadedAt}handleDispatchAction(e){if(!(e instanceof o.a))return;const t=e.message;if((e=>"delete"===e.event)(t)){const e=new Date(t.data.timestamp);null!=this.firstLoadedAt&&e>this.firstLoadedAt&&Object(r.a)(l.a.fromJson(t))}else if((e=>"new"===e.event)(t))Object(r.a)(new l.c(t.data));else if((e=>"read"===e.event)(t)){const e=new Date(t.data.timestamp);null!=this.firstLoadedAt&&e>this.firstLoadedAt&&Object(r.a)(l.d.fromJson(t))}}delayedRetryInitialLoadMore(){this.timeout.loadMore=window.setTimeout(this.loadMore,this.retryDelay.get())}loadBundle(e){Object(r.a)(new l.b(e,{isWidget:!0})),null==this.firstLoadedAt&&(this.firstLoadedAt=new Date(e.timestamp))}};c([n.q],u.prototype,"waitingVerification",void 0),c([n.q],u.prototype,"firstLoadedAt",void 0),c([n.h],u.prototype,"hasData",null),c([n.f],u.prototype,"loadBundle",null),u=c([r.b],u),t.a=u}).call(this,s("5wds"))},IWDN:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("/G9H");function i(e){return r.createElement("h3",{className:"title title--page-extra-small"},osu.trans(e.titleKey),null!=e.count&&r.createElement("span",{className:"title__count"},osu.formatNumber(e.count)))}},IfWv:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return l}));var r=s("0h6b"),i=s("lv9K"),n=s("Cfan"),o=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o},a=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(t){n(t)}}function a(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};class l extends n.a{constructor(e){super(e),Object.defineProperty(this,"isResetting",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isUpdating",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"redirect",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"secret",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.redirect=e.redirect,this.secret=e.secret,Object(i.p)(this)}delete(){return a(this,void 0,void 0,(function*(){return this.isRevoking=!0,e.ajax({method:"DELETE",url:Object(r.route)("oauth.clients.destroy",{client:this.id})}).then(()=>{this.revoked=!0}).always(()=>{this.isRevoking=!1})}))}resetSecret(){return a(this,void 0,void 0,(function*(){return this.isResetting=!0,e.ajax({method:"POST",url:Object(r.route)("oauth.clients.reset-secret",{client:this.id})}).then(e=>{this.updateFromJson(e)}).always(()=>{this.isResetting=!1})}))}updateFromJson(e){this.id=e.id,this.name=e.name,this.scopes=new Set(e.scopes),this.userId=e.user_id,this.user=e.user,this.redirect=e.redirect,this.secret=e.secret}updateWith(t){return a(this,void 0,void 0,(function*(){const{redirect:s}=t;return this.isUpdating=!0,e.ajax({data:{redirect:s},method:"PUT",url:Object(r.route)("oauth.clients.update",{client:this.id})}).then(e=>{this.updateFromJson(e)}).always(()=>{this.isUpdating=!1})}))}}o([i.q],l.prototype,"isResetting",void 0),o([i.q],l.prototype,"isUpdating",void 0),o([i.f],l.prototype,"delete",null),o([i.f],l.prototype,"resetSecret",null),o([i.f],l.prototype,"updateFromJson",null),o([i.f],l.prototype,"updateWith",null)}).call(this,s("5wds"))},Irky:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("/G9H");class i extends r.PureComponent{render(){return 0===this.props.badges.length?null:r.createElement("div",{className:"profile-badges"},this.props.badges.map(e=>{const t={className:"profile-badges__badge",key:e.image_url,style:{backgroundImage:osu.urlPresence(e.image_url)},title:e.description};return osu.present(e.url)?r.createElement("a",Object.assign({href:e.url},t)):r.createElement("span",Object.assign({},t))}))}}Object.defineProperty(i,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{badges:[]}})},JlDh:function(e,t,s){"use strict";s.d(t,"c",(function(){return n})),s.d(t,"b",(function(){return o})),s.d(t,"a",(function(){return a}));var r=s("lv9K"),i=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};const n=[null,"user","beatmapset","forum_topic","news_post","build","channel"];function o(e){const t=e;return n.indexOf(t)>-1?t:n[0]}class a{constructor(e,t){Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"resolver",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"cursor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isDeleting",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isLoading",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isMarkingAsRead",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"stacks",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"total",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object(r.p)(this)}get hasMore(){return null!==this.cursor&&this.stackNotificationCount<this.total}get hasVisibleNotifications(){return this.total>0&&this.stacks.size>0}get identity(){return{objectType:this.name}}get isEmpty(){return this.total<=0}get stackNotificationCount(){return[...this.stacks.values()].reduce((e,t)=>e+t.total,0)}static fromJson(e,t){const s=new a(e.name,t);return s.updateWithJson(e),s}delete(){this.resolver.delete(this)}loadMore(e){null!==this.cursor&&(this.isLoading=!0,this.resolver.loadMore(this.identity,e,this.cursor).always(Object(r.f)(()=>{this.isLoading=!1})))}markTypeAsRead(){this.resolver.queueMarkAsRead(this)}removeStack(e){const t=this.stacks.delete(e.id);return t&&(this.total-=e.total),t}updateWithJson(e){this.cursor=e.cursor,this.total=e.total}}i([r.q],a.prototype,"cursor",void 0),i([r.q],a.prototype,"isDeleting",void 0),i([r.q],a.prototype,"isLoading",void 0),i([r.q],a.prototype,"isMarkingAsRead",void 0),i([r.q],a.prototype,"stacks",void 0),i([r.q],a.prototype,"total",void 0),i([r.h],a.prototype,"hasMore",null),i([r.h],a.prototype,"hasVisibleNotifications",null),i([r.h],a.prototype,"isEmpty",null),i([r.h],a.prototype,"stackNotificationCount",null),i([r.f],a.prototype,"delete",null),i([r.f],a.prototype,"loadMore",null),i([r.f],a.prototype,"markTypeAsRead",null),i([r.f],a.prototype,"removeStack",null),i([r.f],a.prototype,"updateWithJson",null)},JsCm:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return o}));var r=s("Hs9Z");const i=e=>{var t;return null!==(t=e.clientX)&&void 0!==t?t:e.touches[0].clientX};let n=null;class o{constructor(t){Object.defineProperty(this,"active",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bar",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moveCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"percentage",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"end",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.active=!1,e(document).off("mousemove touchmove",this.onMove),e(document).off("mouseup touchend",this.end),e(window).off("blur",this.end),e(document).off("turbolinks:before-cache",this.end),null!=this.endCallback&&this.endCallback(this),this.bar.style.removeProperty("--bar"),this.bar.dataset.audioDragging="0",n=null}}),Object.defineProperty(this,"getPercentage",{enumerable:!0,configurable:!0,writable:!0,value:()=>this.percentage}),Object.defineProperty(this,"move",{enumerable:!0,configurable:!0,writable:!0,value:e=>{if(!this.active)return;const t=this.bar.getBoundingClientRect(),s=e-t.left,i=t.width;this.percentage=Object(r.clamp)(s/i,0,1),null!=this.moveCallback&&this.moveCallback(this),this.bar.style.setProperty("--bar",this.percentage.toString())}}),Object.defineProperty(this,"onMove",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=i(e);requestAnimationFrame(()=>{this.move(t)})}}),this.endCallback=t.endCallback,this.moveCallback=t.moveCallback,this.bar=t.bar,this.bar.dataset.audioDragging="1",this.move(i(t.initialEvent)),e(document).on("mousemove touchmove",this.onMove),e(document).on("mouseup touchend",this.end),e(window).on("blur",this.end),e(document).on("turbolinks:before-cache",this.end)}static start(e){if(0===e.initialEvent.which||1===e.initialEvent.which)return null!=n&&n.end(),n=new o(e)}}Object.defineProperty(o,"startEvents",{enumerable:!0,configurable:!0,writable:!0,value:"mousedown touchstart"})}).call(this,s("5wds"))},KMrT:function(e,t,s){"use strict";var r=s("KUml"),i=s("/G9H"),n=s("2etm"),o=s("Hs9Z"),a=s("y2EG");function l(e){return"beatmap_owner_change"===e.name}a.a;function c(e,t=!1){const s={content:e.details.content,title:e.title,username:e.details.username};l(e)&&(s.beatmap=e.details.version),"beatmapset_discussion_review_new"===e.name&&null!=e.details.embeds&&o.merge(s,{praises:e.details.embeds.praises,problems:e.details.embeds.problems,suggestions:e.details.embeds.suggestions});let r=`notifications.item.${e.displayType}.${e.category}`;"channel"===e.objectType&&(r+=`.${e.details.type}`),r+=`.${e.name}`,t&&(r+="_compact");const i=`${r}_empty`;return null==e.details.content&&osu.transExists(i)&&(r=i),osu.trans(r,s)}function u(e){if("channel"===e.objectType){const t={title:e.title,username:e.details.username},s=`notifications.item.${e.objectType}.${e.category}.${e.details.type}.${e.name}_group`;return osu.trans(s,t)}if("user_achievement_unlock"===e.name){const t={username:e.details.username};return osu.trans(`notifications.item.${e.displayType}.${e.category}.${e.name}_group`,t)}if("user_beatmapset_new"===e.category){const t={username:e.details.username};return osu.trans(`notifications.item.${e.displayType}.${e.category}.${e.category}_group`,t)}return e.title}var d=s("0h6b");function p(e){if(l(e))return Object(d.route)("beatmapsets.discussion",{beatmap:"-",beatmapset:e.objectId,mode:"events"});if("comment_new"===e.name||"comment_reply"===e.name)switch(e.objectType){case"beatmapset":return Object(d.route)("beatmapsets.show",{beatmapset:e.objectId});case"build":return Object(d.route)("changelog.show",{changelog:e.objectId,key:"id"});case"news_post":return Object(d.route)("news.show",{key:"id",news:e.objectId})}else{if("user_achievement_unlock"===e.name)return h(e);if("user_beatmapset_new"===e.category)return`${Object(d.route)("users.show",{user:e.objectId})}#beatmaps`}switch(e.objectType){case"beatmapset":return Object(d.route)("beatmapsets.discussion",{beatmapset:e.objectId});case"channel":return Object(d.route)("chat.index",{sendto:e.sourceUserId});case"forum_topic":return Object(d.route)("forum.topics.show",{start:"unread",topic:e.objectId})}}function m(e){if(l(e))return Object(d.route)("beatmapsets.discussion",{beatmap:e.details.beatmapId,beatmapset:e.objectId});switch(e.name){case"beatmapset_discussion_lock":case"beatmapset_discussion_unlock":case"beatmapset_disqualify":case"beatmapset_love":case"beatmapset_nominate":case"beatmapset_qualify":case"beatmapset_remove_from_loved":case"beatmapset_reset_nominations":return Object(d.route)("beatmapsets.discussion",{beatmapset:e.objectId});case"beatmapset_discussion_post_new":case"beatmapset_discussion_qualified_problem":case"beatmapset_discussion_review_new":return BeatmapDiscussionHelper.url({beatmapId:e.details.beatmapId,beatmapsetId:e.objectId,discussionId:e.details.discussionId});case"beatmapset_rank":return Object(d.route)("beatmapsets.show",{beatmapset:e.objectId});case"channel_message":return Object(d.route)("chat.index",{sendto:e.sourceUserId});case"comment_new":case"comment_reply":return Object(d.route)("comments.show",{comment:e.details.commentId});case"forum_topic_reply":return Object(d.route)("forum.posts.show",{post:e.details.postId});case"user_achievement_unlock":return h(e);case"user_beatmapset_new":case"user_beatmapset_revive":return Object(d.route)("beatmapsets.show",{beatmapset:e.details.beatmapsetId})}}function h(e){var t;const s={mode:null!==(t=e.details.achievementMode)&&void 0!==t?t:void 0,user:e.details.userId};return`${Object(d.route)("users.show",s)}#medals`}var b=s("h/Ip"),f=s("8Xmz"),v=s("9zVE"),g=s("Ncbg"),y=s("mjdM");let _=class extends i.Component{constructor(){super(...arguments),Object.defineProperty(this,"handleDelete",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.props.stack.deleteItem(this.props.item)}}),Object.defineProperty(this,"handleMarkAsRead",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.props.stack.markAsRead(this.props.item)}})}render(){return i.createElement(y.a,{delete:this.handleDelete,icons:n.c[this.props.item.name||""],item:this.props.item,markRead:this.handleMarkAsRead,message:c(this.props.item,!0),modifiers:["compact"],url:m(this.props.item),withCategory:!1,withCoverImage:"user_achievement_unlock"===this.props.item.name||"user_beatmapset_new"===this.props.item.category})}};var w=_=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o}([r.b],_),O=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let j=class extends i.Component{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:{expanded:!1}}),Object.defineProperty(this,"handleDelete",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.props.stack.delete()}}),Object.defineProperty(this,"handleMarkAsRead",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.props.stack.markStackAsRead()}}),Object.defineProperty(this,"handleShowLess",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.setState({expanded:!1})}}),Object.defineProperty(this,"handleShowMore",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.props.stack.loadMore(this.context)}}),Object.defineProperty(this,"renderItem",{enumerable:!0,configurable:!0,writable:!0,value:e=>i.createElement("div",{key:e.id,className:"notification-popup-item-group__item"},i.createElement(w,{item:e,stack:this.props.stack}))}),Object.defineProperty(this,"toggleExpand",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.setState({expanded:!this.state.expanded})}})}render(){const e=this.props.stack.first;return null==e?null:i.createElement("div",{className:"notification-popup-item-group"},i.createElement(y.a,{canMarkAsRead:this.props.stack.canMarkAsRead,delete:this.handleDelete,expandButton:this.renderExpandButton(),icons:n.a[e.category],isDeleting:this.props.stack.isDeleting,isMarkingAsRead:this.props.stack.isMarkingAsRead,item:e,markRead:this.handleMarkAsRead,message:u(e),modifiers:["group"],url:p(e),withCategory:!0,withCoverImage:!0}),this.renderItems())}renderExpandButton(){const e=this.props.stack.total,t=this.context.isWidget?"common.count.update":"common.count.notifications";return i.createElement("button",{className:"show-more-link show-more-link--notification-group",onClick:this.toggleExpand,type:"button"},i.createElement("span",{className:"show-more-link__label"},i.createElement("span",{className:"show-more-link__label-text"},osu.transChoice(t,e)),i.createElement("span",{className:"show-more-link__label-icon"},i.createElement("span",{className:`fas fa-angle-${this.state.expanded?"up":"down"}`}))))}renderItems(){return this.state.expanded?i.createElement("div",{className:"notification-popup-item-group__items"},this.props.stack.orderedNotifications.map(this.renderItem),i.createElement("div",{className:"notification-popup-item-group__show-more"},i.createElement("div",{className:"notification-popup-item-group__expand"},this.renderShowMore()),i.createElement("div",{className:"notification-popup-item-group__collapse"},this.renderShowLess(),this.props.stack.canMarkAsRead&&i.createElement(v.a,{isMarkingAsRead:this.props.stack.isMarkingAsRead,onMarkAsRead:this.handleMarkAsRead}),!this.context.isWidget&&i.createElement(f.a,{isDeleting:this.props.stack.isDeleting,onDelete:this.handleDelete})))):null}renderShowLess(){return i.createElement(g.a,{callback:this.handleShowLess,direction:"up",hasMore:!0,label:osu.trans("common.buttons.show_less"),modifiers:["notification-group"]})}renderShowMore(){const e=this.props.stack;return e.hasMore?i.createElement(g.a,{callback:this.handleShowMore,hasMore:null!=e.cursor,loading:e.isLoading,modifiers:["notification-group"]}):null}};Object.defineProperty(j,"contextType",{enumerable:!0,configurable:!0,writable:!0,value:b.a});var E=j=O([r.b],j);let P=class extends i.Component{constructor(){super(...arguments),Object.defineProperty(this,"handleDelete",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.props.stack.deleteItem(this.props.stack.first)}}),Object.defineProperty(this,"handleMarkAsRead",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.props.stack.markAsRead(this.props.stack.first)}})}render(){const e=this.props.stack.first;return null==e?null:i.createElement(y.a,{delete:this.handleDelete,icons:n.b[e.name||""],isDeleting:e.isDeleting,isMarkingAsRead:e.isMarkingAsRead,item:e,markRead:this.handleMarkAsRead,message:c(e),modifiers:["one"],url:m(e),withCategory:!0,withCoverImage:!0})}};var k=P=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o}([r.b],P);let N=class extends i.Component{render(){if(!this.props.stack.hasVisibleNotifications)return null;const e=this.props.stack.isSingle?k:E;return i.createElement(e,{key:this.props.stack.id,stack:this.props.stack})}};N=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o}([r.b],N);t.a=N},L2k0:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var r=s("0h6b"),i=s("f4vq"),n=s("/G9H"),o=s("PPOh"),a=s("/jJF"),l=s("tX/w"),c=s("cX0L");const u="user-action-button";class d extends n.Component{constructor(t){var s,o,l;super(t),Object.defineProperty(this,"buttonRef",{enumerable:!0,configurable:!0,writable:!0,value:n.createRef()}),Object.defineProperty(this,"eventId",{enumerable:!0,configurable:!0,writable:!0,value:`follow-user-mapping-button-${Object(c.a)()}`}),Object.defineProperty(this,"xhr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onClick",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.setState({loading:!0},()=>{const t={data:{follow:{notifiable_id:this.props.userId,notifiable_type:"user",subtype:"mapping"}}};this.state.following?(t.type="DELETE",t.url=Object(r.route)("follows.destroy")):(t.type="POST",t.url=Object(r.route)("follows.store")),this.xhr=e.ajax(t).done(this.updateData).fail(Object(a.d)(this.buttonRef.current)).always(()=>this.setState({loading:!1}))})}}),Object.defineProperty(this,"refresh",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var e,t;this.setState({following:null!==(t=null===(e=i.a.currentUser)||void 0===e?void 0:e.follow_user_mapping.includes(this.props.userId))&&void 0!==t&&t})}}),Object.defineProperty(this,"updateData",{enumerable:!0,configurable:!0,writable:!0,value:()=>{e.publish("user:followUserMapping:update",{following:!this.state.following,userId:this.props.userId})}});const u=null!==(o=null===(s=i.a.currentUser)||void 0===s?void 0:s.follow_user_mapping.includes(this.props.userId))&&void 0!==o&&o;let d=null!==(l=this.props.followers)&&void 0!==l?l:0;!1!==u&&(d-=1),this.state={followersWithoutSelf:d,following:u,loading:!1}}componentDidMount(){e.subscribe(`user:followUserMapping:refresh.${this.eventId}`,this.refresh)}componentWillUnmount(){var t;e.unsubscribe(`.${this.eventId}`),null===(t=this.xhr)||void 0===t||t.abort()}render(){const e=!(null==i.a.currentUser||i.a.currentUser.id===this.props.userId);if(!e&&!this.props.alwaysVisible)return null;const t=e?osu.trans(`follows.mapping.${this.state.following?"to_0":"to_1"}`):osu.trans("follows.mapping.followers"),s=Object(l.a)(u,this.props.modifiers,{friend:this.state.following}),r=this.state.loading||!e;return n.createElement("div",{title:t},n.createElement("button",{ref:this.buttonRef,className:s,disabled:r,onClick:this.onClick},this.renderIcon(),this.renderCounter()))}followers(){return this.state.followersWithoutSelf+(this.state.following?1:0)}renderCounter(){if(null!=this.props.showFollowerCounter&&null!=this.props.followers)return n.createElement("span",{className:`${u}__counter`},osu.formatNumber(this.followers()))}renderIcon(){const e=this.state.loading?n.createElement(o.a,null):n.createElement("i",{className:"fas fa-bell"});return n.createElement("span",{className:`${u}__icon-container`},e)}}}).call(this,s("5wds"))},LPNJ:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));var r=s("txhI");function i(){return r.a.isOpen()||e("#overlay").is(":visible")||document.body.classList.contains("modal-open")}}).call(this,s("5wds"))},"LXy+":function(e,t,s){"use strict";function r(e){return e.legacy_mode}s.d(t,"a",(function(){return r}))},LhsB:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("/G9H");const i=Object(r.createContext)(void 0)},Ma8u:function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"a",(function(){return o}));var r=s("Hs9Z");function i(){const e=document.querySelector(".js-loading-overlay");if(e instanceof HTMLElement)return e}const n=Object(r.debounce)((function(){const e=i();null!=e&&e.classList.add("loading-overlay--visible")}),5e3,{maxWait:5e3});function o(){n.cancel();const e=i();null!=e&&e.classList.remove("loading-overlay--visible")}},MeXQ:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var r=s("/G9H"),i=s("I8Ok"),n=s("+bOe"),o=function(e,t){return function(){return e.apply(t,arguments)}},a={}.hasOwnProperty,l=[].indexOf||function(e){for(var t=0,s=this.length;t<s;t++)if(t in this&&this[t]===e)return t;return-1},c=function(e){function t(e){var s;this.toggleSelector=o(this.toggleSelector,this),this.renderOptions=o(this.renderOptions,this),this.renderOption=o(this.renderOption,this),this.render=o(this.render,this),this.optionSelected=o(this.optionSelected,this),this.hideSelector=o(this.hideSelector,this),this.componentDidUpdate=o(this.componentDidUpdate,this),this.componentDidMount=o(this.componentDidMount,this),t.__super__.constructor.call(this,e),this.bn=null!=(s=this.props.bn)?s:"select-options",this.hasBlackout=this.props.blackout||void 0===this.props.blackout,this.ref=Object(r.createRef)(),this.state={showingSelector:!1}}return function(e,t){for(var s in t)a.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,e),t.prototype.componentDidMount=function(){return document.addEventListener("click",this.hideSelector)},t.prototype.componentDidUpdate=function(e,t){if(this.hasBlackout&&t.showingSelector!==this.state.showingSelector)return Object(n.c)(this.state.showingSelector,.5)},t.prototype.componentWillUnmount=function(){return document.removeEventListener("click",this.hideSelector)},t.prototype.hideSelector=function(e){var t;if(0===e.button&&(t=this.ref.current,!(l.call(e.composedPath(),t)>=0)))return this.setState({showingSelector:!1})},t.prototype.optionSelected=function(e,t){var s;if(0===e.button)return e.preventDefault(),this.setState({showingSelector:!1}),"function"==typeof(s=this.props).onChange?s.onChange(t):void 0},t.prototype.render=function(){var e,t;return e=""+this.bn,this.state.showingSelector&&(e+=" "+this.bn+"--selecting"),Object(i.div)({className:e,ref:this.ref},Object(i.div)({className:this.bn+"__select"},this.renderOption({children:[Object(i.div)({className:"u-ellipsis-overflow",key:"current"},null!=(t=this.props.selected)?t.text:void 0),Object(i.div)({key:"decoration",className:this.bn+"__decoration"},Object(i.i)({className:"fas fa-chevron-down"}))],onClick:this.toggleSelector,option:this.props.selected})),Object(i.div)({className:this.bn+"__selector"},this.renderOptions()))},t.prototype.renderOption=function(e){var t,s,r,n,o,a;return t=e.children,r=e.onClick,n=e.option,a=null!=(o=e.selected)&&o,s=this.bn+"__option",a&&(s+=" "+this.bn+"__option--selected"),null!=this.props.renderOption?this.props.renderOption({children:t,cssClasses:s,onClick:r,option:n}):Object(i.a)({className:s,href:"#",key:n.id,onClick:r},t)},t.prototype.renderOptions=function(){var e,t,s,r,n;for(n=[],e=0,t=(r=this.props.options).length;e<t;e++)s=r[e],n.push(function(e){return function(t){var s;return e.renderOption({children:[Object(i.div)({className:"u-ellipsis-overflow",key:t.id},t.text)],onClick:function(s){return e.optionSelected(s,t)},option:t,selected:(null!=(s=e.props.selected)?s.id:void 0)===t.id})}}(this)(s));return n},t.prototype.toggleSelector=function(e){if(0===e.button)return e.preventDefault(),this.setState({showingSelector:!this.state.showingSelector})},t}(r.PureComponent)},N05Q:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("0h6b");function i(e){return[{active:"home"===e,title:osu.trans("home.user.title"),url:Object(r.route)("home")},{active:"friends.index"===e,title:osu.trans("friends.title_compact"),url:Object(r.route)("friends.index")},{active:"follows.index"===e,title:osu.trans("follows.index.title_compact"),url:Object(r.route)("follows.index",{subtype:"forum_topic"})},{active:"account.edit"===e,title:osu.trans("accounts.edit.title_compact"),url:Object(r.route)("account.edit")}]}},Ncbg:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return a}));var r=s("/G9H"),i=s("PPOh"),n=s("tX/w");const o="show-more-link";class a extends r.PureComponent{constructor(){super(...arguments),Object.defineProperty(this,"onClick",{enumerable:!0,configurable:!0,writable:!0,value:()=>{null==this.props.callback?null==this.props.url&&null!=this.props.event&&e.publish(this.props.event,this.props.data):this.props.callback(this.props.data)}})}render(){if(!this.props.hasMore&&!this.props.loading)return null;const e={children:this.children(),className:Object(n.a)(o,this.props.modifiers)};return this.props.loading?r.createElement("span",Object.assign({"data-disabled":"1"},e)):null==this.props.url?r.createElement("button",Object.assign({onClick:this.onClick,type:"button"},e)):r.createElement("a",Object.assign({href:this.props.url,onClick:this.onClick},e))}children(){var e,t;const s=r.createElement("span",{className:`fas fa-angle-${null!==(e=this.props.direction)&&void 0!==e?e:"down"}`});return r.createElement(r.Fragment,null,r.createElement("span",{className:`${o}__spinner`},r.createElement(i.a,null)),r.createElement("span",{className:`${o}__label`},r.createElement("span",{className:`${o}__label-icon ${o}__label-icon--left`},s),r.createElement("span",{className:`${o}__label-text`},null!==(t=this.props.label)&&void 0!==t?t:osu.trans("common.buttons.show_more"),null!=this.props.remaining&&` (${this.props.remaining})`),r.createElement("span",{className:`${o}__label-icon ${o}__label-icon--right`},s)))}}Object.defineProperty(a,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{hasMore:!1,loading:!1}})}).call(this,s("5wds"))},O0zI:function(e,t,s){"use strict";(function(e,r){s.d(t,"a",(function(){return f}));var i,n,o,a=s("f4vq"),l=s("/G9H"),c=s("I8Ok"),u=s("Ncbg"),d=s("PPOh"),p=s("tX/w"),m=function(e,t){return function(){return e.apply(t,arguments)}},h={}.hasOwnProperty,b=[].indexOf||function(e){for(var t=0,s=this.length;t<s;t++)if(t in this&&this[t]===e)return t;return-1};n=l.createElement,o=a.a.dataStore.uiState,i="comment-show-more";var f=function(t){function s(e){this.load=m(this.load,this),this.render=m(this.render,this),this.componentWillUnmount=m(this.componentWillUnmount,this),s.__super__.constructor.call(this,e),this.state={loading:!1}}return function(e,t){for(var s in t)h.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.defaultProps={modifiers:[]},s.prototype.componentWillUnmount=function(){var e;return null!=(e=this.xhr)?e.abort():void 0},s.prototype.render=function(){var e,t,s,r,a,l,m;return this.props.comments.length>=this.props.total?null:null==(s=o.comments.hasMoreComments[null!=(r=null!=(a=this.props.parent)?a.id:void 0)?r:null])||s?(e=Object(p.a)(i,this.props.modifiers),b.call(this.props.modifiers,"top")>=0?(m=this.props.total-this.props.comments.length,t=["comments"],b.call(this.props.modifiers,"changelog")>=0?t.push("t-greyviolet-darker"):t.push("t-ddd"),n(u.a,{loading:this.state.loading,hasMore:!0,callback:this.load,modifiers:t,remaining:m})):Object(c.div)({className:e},this.state.loading?n(d.a):Object(c.button)({className:i+"__link",onClick:this.load},null!=(l=this.props.label)?l:osu.trans("common.buttons.show_more")))):null},s.prototype.load=function(){var t,s,i,n,a,l,c,u,d;return this.setState({loading:!0}),s={commentable_type:null!=(i=null!=(n=this.props.parent)?n.commentable_type:void 0)?i:this.props.commentableType,commentable_id:null!=(a=null!=(l=this.props.parent)?l.commentable_id:void 0)?a:this.props.commentableId,parent_id:null!=(c=null!=(u=this.props.parent)?u.id:void 0)?c:0,sort:o.comments.currentSort},null!=(t=e.last(this.props.comments))&&(s.cursor={id:t.id,created_at:t.createdAt,votes_count:t.votesCount}),this.xhr=r.ajax(laroute.route("comments.index"),{data:s,dataType:"json"}).done((function(e){return r.publish("comments:added",e)})).always((d=this,function(){return d.setState({loading:!1})}))},s}(l.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},"OjW+":function(e,t,s){"use strict";var r=s("l424"),i=s("0h6b"),n=s("KUml"),o=s("f4vq"),a=s("vcN5"),l=s("/G9H"),c=s("tX/w"),u=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};const d={entered:{opacity:1},entering:{},exited:{},exiting:{},unmounted:{}},p=Object(n.b)(({beatmaps:e})=>l.createElement("div",{className:"beatmaps-popup__group"},e.map(e=>l.createElement(m,{key:e.id,beatmap:e})))),m=Object(n.b)(({beatmap:e})=>l.createElement("a",{className:"beatmaps-popup-item",href:Object(i.route)("beatmaps.show",{beatmap:e.id})},l.createElement("span",{className:"beatmaps-popup-item__col beatmaps-popup-item__col--mode"},l.createElement("span",{className:`fal fa-extra-mode-${e.mode}`})),l.createElement(r.a,{rating:e.difficulty_rating}),l.createElement("span",{className:"beatmaps-popup-item__col beatmaps-popup-item__col--name u-ellipsis-overflow"},e.version)));let h=class extends l.Component{constructor(){super(...arguments),Object.defineProperty(this,"contentRef",{enumerable:!0,configurable:!0,writable:!0,value:l.createRef()})}render(){const e=Object.assign({opacity:0,transitionDuration:`${this.props.transitionDuration}ms`},d[this.props.state]);if(null!=this.props.parent){const t=this.props.parent.getBoundingClientRect();e.top=`${window.scrollY+t.bottom}px`,e.left=`${window.scrollX+t.left}px`,e.width=`${t.width}px`}return l.createElement(a.a,null,l.createElement("div",{ref:this.contentRef,className:Object(c.a)("beatmaps-popup",[`size-${o.a.userPreferences.get("beatmapset_card_size")}`]),onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave,style:e},l.createElement("div",{className:"beatmaps-popup__content"},[...this.props.groupedBeatmaps].map(([e,t])=>t.length>0&&l.createElement(p,{key:e,beatmaps:t})))))}};h=u([n.b],h),t.a=h},PPOh:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("/G9H"),i=s("tX/w");function n(e){return r.createElement("div",{className:Object(i.a)("la-ball-clip-rotate",e.modifiers)})}},PTft:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return o}));s("/G9H");var r,i,n=s("I8Ok");r="beatmap-basic-stats",i=function(t){var s,r,i;return i=t%60,r=Math.floor(t/60)%60,(s=Math.floor(t/3600))>0?s+":"+e.padStart(r,2,0)+":"+e.padStart(i,2,0):r+":"+e.padStart(i,2,0)};var o=function(e){var t,s,o;return t=e.beatmap,Object(n.div)({className:r},function(){var e,a,l,c;for(c=[],e=0,a=(l=["total_length","bpm","count_circles","count_sliders"]).length;e<a;e++)o=t[s=l[e]],o="bpm"===s?o>1e3?"":osu.formatNumber(o):"total_length"===s?i(o):osu.formatNumber(o),c.push(Object(n.div)({className:r+"__entry",key:s,title:osu.trans("beatmapsets.show.stats."+s,"total_length"===s?{hit_length:i(t.hit_length)}:void 0)},Object(n.div)({className:r+"__entry-icon",style:{backgroundImage:"url(/images/layout/beatmapset-page/"+s+".svg)"}}),Object(n.span)(null,o)));return c}())}}).call(this,s("Hs9Z"))},"PVx+":function(e,t,s){"use strict";(function(e){s.d(t,"d",(function(){return n})),s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return a})),s.d(t,"c",(function(){return c}));var r=s("0h6b"),i=s("lv9K");function n(e){return Array.isArray(e)?e.length:0}const o=Object(i.f)((t,s,o)=>{t.pagination.loading=!0;let a=o.limit;"number"==typeof a&&Number.isFinite(a)||(a=50);const c=a+1,u=Object.assign(Object.assign({},o),{limit:c,offset:n(t.items)});return e.ajax(Object(r.route)(s,u)).done(e=>{l(t,e,c)}).always(Object(i.f)(()=>{t.pagination.loading=!1}))}),a=(e,t)=>o(e,"users.kudosu",{user:t}),l=Object(i.f)((e,t,s)=>{Array.isArray(t)?(Array.isArray(e.items)||(e.items=[]),e.pagination.hasMore=c(s-1,t),e.items.push(...t)):0===n(e.items)&&(e.items=t)}),c=Object(i.f)((e,t)=>{if(!Array.isArray(t))return!1;const s=t.length>e;return s&&t.pop(),s})}).call(this,s("5wds"))},Q3zR:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));const r=["ssh","ss","sh","s","a"];var i=s("/G9H"),n=s("tX/w");const o={a:"A",s:"S",sh:"SH",ss:"X",ssh:"XH"};function a({stats:e}){return i.createElement("div",{className:"profile-rank-count"},r.map(t=>i.createElement("div",{key:t,className:"profile-rank-count__item"},i.createElement("div",{className:Object(n.a)("score-rank",o[t],"profile-page")}),osu.formatNumber(e.grade_counts[t]))))}},QUfv:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));class r{constructor(e){Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:e})}}},"R+Xi":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("0h6b"),i=s("/G9H"),n=s("tX/w");function o(e){return i.createElement("div",{className:"page-tabs page-tabs--follows"},["comment","forum_topic","mapping","modding"].map(t=>i.createElement("a",{key:t,className:Object(n.a)("page-tabs__tab",{active:t===e.currentSubtype}),href:Object(r.route)("follows.index",{subtype:t})},osu.trans(`follows.${t}.title`))))}},RHtj:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("/G9H"),i=s("qhp/");class n extends r.PureComponent{render(){return this.props.events.map(e=>r.createElement(i.a,{key:e.id,event:e,mode:this.props.mode,users:this.props.users}))}}},Rfpg:function(e,t,s){"use strict";s.d(t,"b",(function(){return r})),s.d(t,"c",(function(){return i})),s.d(t,"a",(function(){return n}));const r=["PUBLIC","GROUP","PM"],i=new Set(r);function n(e){return e.filter(e=>i.has(e.type))}},S5CA:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return o}));var r,i=s("/G9H"),n=s("I8Ok");i.createElement,r={add:"fas fa-plus",fix:"fas fa-check",misc:"far fa-circle"};var o=function(t){var s,i,o,a,l,c,u;return s=t.entry,i=e.escape(s.title).replace(/(`+)([^`]+)\1/g,"<code>$2</code>"),Object(n.div)({className:"changelog-entry",key:s.id},Object(n.div)({className:"changelog-entry__row"},Object(n.div)({className:"changelog-entry__title "+(s.major?"changelog-entry__title--major":"")},Object(n.span)({className:"changelog-entry__title-icon"},Object(n.span)({className:"changelog-entry__icon "+r[s.type]})),null!=s.url?Object(n.a)({href:s.url,className:"changelog-entry__link",dangerouslySetInnerHTML:{__html:i}}):Object(n.span)({dangerouslySetInnerHTML:{__html:i}}),null!=s.github_url?Object(n.span)(null," (",Object(n.a)({className:"changelog-entry__link",href:s.github_url},s.repository.replace(/^.*\//,"")+"#"+s.github_pull_request_id),")"):void 0,(u=e.escape(s.github_user.display_name),o=null!=(c=null!=(a=s.github_user.github_url)?a:s.github_user.user_url)?"<a data-user-id='"+(null!=(l=s.github_user.user_id)?l:"")+"' class='changelog-entry__user-link js-usercard' href='"+e.escape(c)+"' >"+u+"</a>":u,Object(n.span)({className:"changelog-entry__user",dangerouslySetInnerHTML:{__html:osu.trans("changelog.entry.by",{user:o})}})))),null!=s.message_html?Object(n.div)({className:"changelog-entry__row changelog-entry__row--message",dangerouslySetInnerHTML:{__html:s.message_html}}):void 0)}}).call(this,s("Hs9Z"))},TezV:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var r=s("Hs9Z"),i=s("BvKu"),n=s("/G9H"),o=s("tX/w"),a=s("ss8h");class l extends n.Component{constructor(){super(...arguments),Object.defineProperty(this,"renderButton",{enumerable:!0,configurable:!0,writable:!0,value:(e,t,s)=>{const i=r.find(this.props.menuOptions,e=>e.id===this.props.selected)||this.props.menuOptions[0],a=[];return this.props.disabled&&(s=()=>{},a.push("disabled")),n.createElement("div",{ref:t,className:Object(o.a)("icon-dropdown-menu",a),contentEditable:!1,onClick:s},i.icon,e)}}),Object.defineProperty(this,"renderMenuItem",{enumerable:!0,configurable:!0,writable:!0,value:e=>n.createElement("button",{key:e.id,className:Object(o.a)("simple-menu__item",{active:e.id===this.props.selected}),"data-id":e.id,onClick:this.select},n.createElement("div",{className:Object(o.a)("simple-menu__item-icon","icon-dropdown-menu")},e.icon),n.createElement("div",{className:"simple-menu__label"},e.label))}),Object.defineProperty(this,"select",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t;e.preventDefault();const s=e.currentTarget;s&&this.props.onSelect(null!==(t=s.dataset.id)&&void 0!==t?t:"")}})}render(){return n.createElement(i.a,{customRender:this.renderButton,direction:"right"},()=>n.createElement("div",{className:"simple-menu simple-menu--popup-menu-compact"},this.props.menuOptions.map(this.renderMenuItem)))}}Object.defineProperty(l,"contextType",{enumerable:!0,configurable:!0,writable:!0,value:a.a})},TyNR:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return n}));var r=s("LPNJ"),i=s("/DQ7");class n{constructor(){Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"documentMouseEventTarget",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"close",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.show()}}),Object.defineProperty(this,"restoreSaved",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.show(document.body.dataset.clickMenuCurrent)}}),Object.defineProperty(this,"saveCurrent",{enumerable:!0,configurable:!0,writable:!0,value:()=>{null==this.current?delete document.body.dataset.clickMenuCurrent:document.body.dataset.clickMenuCurrent=this.current}}),Object.defineProperty(this,"show",{enumerable:!0,configurable:!0,writable:!0,value:t=>{var s,r;const n=this.tree();this.current=t;const o=this.tree(),a=document.querySelectorAll(".js-click-menu[data-click-menu-id]");let l=null,c=!1;for(const e of a){if(!(e instanceof HTMLElement))continue;const t=e.dataset.clickMenuId;null==t||-1===o.indexOf(t)?(Object(i.b)(e),e.classList.remove("js-click-menu--active"),null===(s=this.menuLink(t))||void 0===s||s.classList.remove("js-click-menu--active")):(Object(i.a)(e),e.classList.add("js-click-menu--active"),null===(r=this.menuLink(t))||void 0===r||r.classList.add("js-click-menu--active"),c=!0,t===this.current&&(l=e))}c||(this.current=null),e.publish("click-menu:current",{previousTree:n,target:this.current,tree:o});const u=null==l?void 0:l.querySelector(".js-click-menu--autofocus");u instanceof HTMLElement&&u.focus()}}),Object.defineProperty(this,"toggle",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=e.currentTarget,s=this.tree();e.preventDefault(),e.stopPropagation();const r=t.dataset.clickMenuTarget;let i=r;if(null!=r){const e=s.indexOf(r);-1!==e&&(i=s[e+1])}this.show(i)}}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:()=>{if(null==this.current)return[];let e=this.current;const t=[e];for(;null!=(e=this.closestMenuId(this.menuLink(e)));)t.push(e);return t}}),Object.defineProperty(this,"onDocumentMousedown",{enumerable:!0,configurable:!0,writable:!0,value:e=>{this.documentMouseEventTarget=0===e.button?e.target:null}}),Object.defineProperty(this,"onDocumentMouseup",{enumerable:!0,configurable:!0,writable:!0,value:t=>{this.documentMouseEventTarget===t.target&&0===t.button&&(Object(r.a)()||null!=this.current&&(e(t.target).closest(".js-click-menu").length>0||this.show()))}}),e(document).on("click",".js-click-menu--close",this.close),e(document).on("click",".js-click-menu[data-click-menu-target]",this.toggle),e(document).on("mousedown",this.onDocumentMousedown),e(document).on("mouseup",this.onDocumentMouseup),document.addEventListener("turbolinks:load",this.restoreSaved),document.addEventListener("turbolinks:before-cache",this.saveCurrent)}closestMenuId(t){if(null!=t)return e(t).parents("[data-click-menu-id]").attr("data-click-menu-id")}menu(e){return document.querySelector(`.js-click-menu[data-click-menu-id${null==e?"":`='${e}'`}]`)}menuLink(e){return document.querySelector(`.js-click-menu[data-click-menu-target${null==e?"":`='${e}'`}]`)}}}).call(this,s("5wds"))},U70x:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return v}));var r=s("7EfK"),i=s("f4vq"),n=s("/G9H"),o=s("6e4D"),a=s("XPyy"),l=s("ed4P"),c=s("tX/w"),u=s("is6n"),d=s("vZz4");const p=["all","online","offline"],m=["all","osu","taiko","fruits","mania"],h=["last_visit","rank","username"];function b(e,t){var s,r,i,n;return(null!==(r=null===(s=e.statistics)||void 0===s?void 0:s.global_rank)&&void 0!==r?r:Number.MAX_VALUE)-(null!==(n=null===(i=t.statistics)||void 0===i?void 0:i.global_rank)&&void 0!==n?n:Number.MAX_VALUE)}function f(e,t){return e.username.localeCompare(t.username)}class v extends n.PureComponent{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:{filter:this.filterFromUrl,playMode:this.playmodeFromUrl,sortMode:this.sortFromUrl,viewMode:this.viewFromUrl}}),Object.defineProperty(this,"handleSortChange",{enumerable:!0,configurable:!0,writable:!0,value:t=>{const s=t.currentTarget.dataset.value,r=Object(d.i)(null,{sort:s});e.controller.advanceHistory(r),this.setState({sortMode:s},()=>{i.a.userPreferences.set("user_list_sort",this.state.sortMode)})}}),Object.defineProperty(this,"onViewSelected",{enumerable:!0,configurable:!0,writable:!0,value:t=>{const s=t.currentTarget.dataset.value,r=Object(d.i)(null,{view:s});e.controller.advanceHistory(r),this.setState({viewMode:s},()=>{i.a.userPreferences.set("user_list_view",this.state.viewMode)})}}),Object.defineProperty(this,"optionSelected",{enumerable:!0,configurable:!0,writable:!0,value:t=>{t.preventDefault();const s=t.currentTarget.dataset.key,r=Object(d.i)(null,{filter:s});e.controller.advanceHistory(r),this.setState({filter:s},()=>{i.a.userPreferences.set("user_list_filter",this.state.filter)})}}),Object.defineProperty(this,"playmodeSelected",{enumerable:!0,configurable:!0,writable:!0,value:t=>{const s=t.currentTarget.dataset.value,r=Object(d.i)(null,{mode:s});e.controller.advanceHistory(r),this.setState({playMode:s})}})}get filterFromUrl(){return this.getAllowedQueryStringValue(p,Object(u.b)().get("filter"),i.a.userPreferences.get("user_list_filter"))}get playmodeFromUrl(){return this.getAllowedQueryStringValue(m,Object(u.b)().get("mode"),"all")}get sortedUsers(){const e=this.getFilteredUsers(this.state.filter).slice();switch(this.state.sortMode){case"rank":return e.sort(b);case"username":return e.sort(f);default:return e.sort((e,t)=>e.is_online&&t.is_online?f(e,t):e.is_online||t.is_online?e.is_online?-1:1:r(t.last_visit||0).diff(r(e.last_visit||0)))}}get sortFromUrl(){return this.getAllowedQueryStringValue(h,Object(u.b)().get("sort"),i.a.userPreferences.get("user_list_sort"))}get viewFromUrl(){return this.getAllowedQueryStringValue(a.b,Object(u.b)().get("view"),i.a.userPreferences.get("user_list_view"))}render(){return n.createElement(n.Fragment,null,this.renderSelections(),n.createElement("div",{className:"user-list"},null!=this.props.title&&n.createElement("h1",{className:"user-list__title"},this.props.title),null!=this.props.descriptionHtml&&n.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.descriptionHtml},className:"user-list__description"}),n.createElement("div",{className:"user-list__toolbar"},this.props.playmodeFilter&&n.createElement("div",{className:"user-list__toolbar-row"},n.createElement("div",{className:"user-list__toolbar-item"},this.renderPlaymodeFilter())),n.createElement("div",{className:"user-list__toolbar-row"},n.createElement("div",{className:"user-list__toolbar-item"},this.renderSorter()),n.createElement("div",{className:"user-list__toolbar-item"},this.renderViewMode()))),n.createElement("div",{className:"user-list__items"},n.createElement(l.a,{users:this.sortedUsers,viewMode:this.state.viewMode}))))}renderOption(e,t,s=!1){const r=s?["active"]:[];let i=Object(c.a)("update-streams-v2__item",r);return i+=` t-changelog-stream--${e}`,n.createElement("a",{key:e,className:i,"data-key":e,href:Object(d.i)(null,{filter:e}),onClick:this.optionSelected},n.createElement("div",{className:"update-streams-v2__bar u-changelog-stream--bg"}),n.createElement("p",{className:"update-streams-v2__row update-streams-v2__row--name"},osu.trans(`users.status.${e}`)),n.createElement("p",{className:"update-streams-v2__row update-streams-v2__row--version"},t))}renderSelections(){return n.createElement("div",{className:"update-streams-v2 update-streams-v2--with-active update-streams-v2--user-list"},n.createElement("div",{className:"update-streams-v2__container"},p.map(e=>this.renderOption(e,this.getFilteredUsers(e).length,e===this.state.filter))))}renderSorter(){return n.createElement(o.a,{currentValue:this.state.sortMode,modifiers:["user-list"],onChange:this.handleSortChange,values:h})}renderViewMode(){return n.createElement("div",{className:"user-list__view-modes"},n.createElement("button",{className:Object(c.a)("user-list__view-mode","card"===this.state.viewMode?["active"]:[]),"data-value":"card",onClick:this.onViewSelected,title:osu.trans("users.view_mode.card")},n.createElement("span",{className:"fas fa-square"})),n.createElement("button",{className:Object(c.a)("user-list__view-mode","list"===this.state.viewMode?["active"]:[]),"data-value":"list",onClick:this.onViewSelected,title:osu.trans("users.view_mode.list")},n.createElement("span",{className:"fas fa-bars"})),n.createElement("button",{className:Object(c.a)("user-list__view-mode","brick"===this.state.viewMode?["active"]:[]),"data-value":"brick",onClick:this.onViewSelected,title:osu.trans("users.view_mode.brick")},n.createElement("span",{className:"fas fa-th"})))}getAllowedQueryStringValue(e,t,s){const r=t;if(e.indexOf(r)>-1)return r;const i=s;return e.indexOf(i)>-1?i:e[0]}getFilteredUsers(e){let t=this.props.users.slice();const s=this.state.playMode;switch(this.props.playmodeFilter&&"all"!==s&&(t=t.filter(e=>{var t;if(e.groups&&e.groups.length>0){if(null!=this.props.playmodeFilterGroupId){const r=e.groups.find(e=>e.id===this.props.playmodeFilterGroupId);return null===(t=null==r?void 0:r.playmodes)||void 0===t?void 0:t.includes(s)}return e.groups.some(e=>{var t;return null===(t=e.playmodes)||void 0===t?void 0:t.includes(s)})}return!1})),e){case"online":return t.filter(e=>e.is_online);case"offline":return t.filter(e=>!e.is_online);default:return t}}renderPlaymodeFilter(){const e=m.map(e=>n.createElement("button",{key:e,className:Object(c.a)("user-list__view-mode",this.state.playMode===e?["active"]:[]),"data-value":e,onClick:this.playmodeSelected,title:osu.trans(`beatmaps.mode.${e}`)},"all"===e?n.createElement("span",null,osu.trans("beatmaps.mode.all")):n.createElement("span",{className:`fal fa-extra-mode-${e}`})));return n.createElement("div",{className:"user-list__view-modes"},n.createElement("span",{className:"user-list__view-mode-title"},osu.trans("users.filtering.by_game_mode"))," ",e)}}}).call(this,s("dMdw"))},UUa0:function(e,t,s){"use strict";var r=s("7nlf"),i=s("lv9K"),n=s("KUml"),o=s("dqUM"),a=s("/G9H"),l=s("tX/w"),c=s("HGQb"),u=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let d=class extends a.Component{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:{forceShow:!1}}),Object.defineProperty(this,"handleClick",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.setState({forceShow:!this.state.forceShow})}}),Object(i.p)(this)}get isBlocked(){return Object(c.a)(this.props.user)}render(){let e;const t=["full"];return this.isBlocked&&!this.state.forceShow&&(e="osu-layout__no-scroll",t.push("masked")),a.createElement("div",{className:e},this.isBlocked&&this.renderBanner(),a.createElement("div",{className:Object(l.a)("osu-layout",t)},this.props.children))}renderBanner(){const e=a.createElement("div",{className:"grid-items grid-items--notification-banner-buttons"},a.createElement("div",null,a.createElement(r.a,{userId:this.props.user.id})),a.createElement("div",null,a.createElement("button",{className:"textual-button",onClick:this.handleClick,type:"button"},a.createElement("span",null,a.createElement("i",{className:"textual-button__icon fas fa-low-vision"})," ",this.state.forceShow?osu.trans("users.blocks.hide_profile"):osu.trans("users.blocks.show_profile")))));return a.createElement("div",{className:"osu-page"},a.createElement(o.a,{message:e,title:osu.trans("users.blocks.banner_text"),type:"warning"}))}};u([i.h],d.prototype,"isBlocked",null),d=u([n.b],d),t.a=d},UVl7:function(e,t,s){"use strict";(function(e,r){s.d(t,"a",(function(){return T}));var i,n,o,a,l,c,u=s("f7bm"),d=s("2b+G"),p=s("O0zI"),m=s("4PZ6"),h=s("4QOX"),b=s("f4vq"),f=s("/G9H"),v=s("I8Ok"),g=s("hc33"),y=s("Ncbg"),_=s("PPOh"),w=s("mk7q"),O=s("peKF"),j=s("uWCK"),E=s("sAkl"),P=s("tX/w"),k=s("jUJ3"),N=s("phBA"),S=function(e,t){return function(){return e.apply(t,arguments)}},x={}.hasOwnProperty;o=f.createElement,n={username:osu.trans("users.deleted")},i=b.a.dataStore.commentableMetaStore,a=b.a.dataStore.commentStore,c=b.a.dataStore.userStore,l=b.a.dataStore.uiState;var T=function(t){var s,T,C;function M(e){var t,r;this.toggleClip=S(this.toggleClip,this),this.toggleReplies=S(this.toggleReplies,this),this.closeNewReply=S(this.closeNewReply,this),this.voteToggle=S(this.voteToggle,this),this.toggleNewReply=S(this.toggleNewReply,this),this.restore=S(this.restore,this),this.userFor=S(this.userFor,this),this.parentLink=S(this.parentLink,this),this.loadReplies=S(this.loadReplies,this),this.closeEdit=S(this.closeEdit,this),this.toggleEdit=S(this.toggleEdit,this),this.handleReplyPosted=S(this.handleReplyPosted,this),this.togglePinned=S(this.togglePinned,this),this.delete=S(this.delete,this),this.hasVoted=S(this.hasVoted,this),this.renderToolbar=S(this.renderToolbar,this),this.renderCommentableMeta=S(this.renderCommentableMeta,this),this.renderVoteButton=S(this.renderVoteButton,this),this.renderUsername=S(this.renderUsername,this),this.renderUserAvatar=S(this.renderUserAvatar,this),this.renderToggleClipButton=S(this.renderToggleClipButton,this),this.renderRestore=S(this.renderRestore,this),this.renderReport=S(this.renderReport,this),this.renderReplyButton=S(this.renderReplyButton,this),this.renderReplyBox=S(this.renderReplyBox,this),this.renderRepliesToggle=S(this.renderRepliesToggle,this),this.renderRepliesText=S(this.renderRepliesText,this),this.renderPermalink=S(this.renderPermalink,this),this.renderOwnerBadge=S(this.renderOwnerBadge,this),this.renderEditedBy=S(this.renderEditedBy,this),this.renderEdit=S(this.renderEdit,this),this.renderPin=S(this.renderPin,this),this.renderDeletedBy=S(this.renderDeletedBy,this),this.renderDelete=S(this.renderDelete,this),this.renderComment=S(this.renderComment,this),this.render=S(this.render,this),this.componentDidUpdate=S(this.componentDidUpdate,this),this.componentDidMount=S(this.componentDidMount,this),this.componentWillUnmount=S(this.componentWillUnmount,this),M.__super__.constructor.call(this,e),this.xhr={},this.loadMoreRef=f.createRef(),r=!osuCore.windowSize.isMobile&&(!this.props.comment.isDeleted&&(null!=this.props.expandReplies?this.props.expandReplies:(null!=(t=l.getOrderedCommentsByParentId(this.props.comment.id))?t.length:void 0)>0&&this.props.depth<s)),this.state={clipped:!0,postingVote:!1,editing:!1,showNewReply:!1,expandReplies:r,lines:null}}return function(e,t){for(var s in t)x.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(M,t),7,s=6,C=document.createElement("div"),T=function(t){return t.isDeleted?osu.trans("comments.deleted"):(C.innerHTML=t.messageHtml,e.truncate(C.textContent,{length:100}))},M.prototype.componentWillUnmount=function(){var e,t,s,r;for(e in s=[],t=this.xhr)x.call(t,e)&&(r=t[e],s.push(null!=r?r.abort():void 0));return s},M.prototype.componentDidMount=function(){var e;return this.setState({lines:Object(k.a)(null!=(e=this.props.comment.messageHtml)?e:"")})},M.prototype.componentDidUpdate=function(e){var t;if(e.comment.messageHtml!==this.props.comment.messageHtml)return this.setState({lines:Object(k.a)(null!=(t=this.props.comment.messageHtml)?t:"")})},M.prototype.render=function(){return o(h.a,null,(e=this,function(){var t,r,n,c,u,h,b,g,y,_;return e.children=null!=(h=l.getOrderedCommentsByParentId(e.props.comment.id))?h:[],u=a.comments.get(e.props.comment.parentId),_=e.userFor(e.props.comment),n=i.get(e.props.comment.commentableType,e.props.comment.commentableId),t=null!=e.state.lines&&e.state.lines.count>=9,c=null!=(b=null!=(g=e.props.modifiers)?g.slice(0):void 0)?b:[],0===e.props.depth&&c.push("top"),r=[],e.props.comment.isDeleted&&r.push("deleted"),e.state.clipped&&t&&r.push("clip"),y="comment__replies",e.props.depth<s&&(y+=" comment__replies--indented"),e.state.expandReplies||(y+=" comment__replies--hidden"),Object(v.div)({className:Object(P.a)("comment",c)},e.renderRepliesToggle(),e.renderCommentableMeta(n),e.renderToolbar(),Object(v.div)({className:Object(P.a)("comment__main",r),style:{"--line-height":null!=e.state.lines?e.state.lines.lineHeight+"px":void 0,"--clip-lines":7}},e.props.comment.canHaveVote?Object(v.div)({className:"comment__float-container comment__float-container--left hidden-xs"},e.renderVoteButton()):void 0,e.renderUserAvatar(_),Object(v.div)({className:"comment__container"},Object(v.div)({className:"comment__row comment__row--header"},e.renderUsername(_),e.renderOwnerBadge(n),e.props.comment.pinned?Object(v.span)({className:"comment__row-item  comment__row-item--pinned"},Object(v.span)({className:"fa fa-thumbtack"})," ",osu.trans("comments.pinned")):void 0,null!=u?Object(v.span)({className:"comment__row-item comment__row-item--parent"},e.parentLink(u)):void 0,e.props.comment.isDeleted?Object(v.span)({className:"comment__row-item comment__row-item--deleted"},osu.trans("comments.deleted")):void 0),e.state.editing?Object(v.div)({className:"comment__editor"},o(d.a,{id:e.props.comment.id,message:e.props.comment.message,modifiers:e.props.modifiers,close:e.closeEdit})):null!=e.props.comment.messageHtml?o(f.Fragment,null,Object(v.div)({className:"comment__message",dangerouslySetInnerHTML:{__html:e.props.comment.messageHtml}}),t?e.renderToggleClipButton():void 0):void 0,Object(v.div)({className:"comment__row comment__row--footer"},e.props.comment.canHaveVote?Object(v.div)({className:"comment__row-item visible-xs"},e.renderVoteButton(!0)):void 0,Object(v.div)({className:"comment__row-item comment__row-item--info"},o(O.a,{dateTime:e.props.comment.createdAt,relative:!0})),e.renderPermalink(),e.renderReplyButton(),e.renderEdit(),e.renderRestore(),e.renderDelete(),e.renderPin(),e.renderReport(),e.renderEditedBy(),e.renderDeletedBy(),e.renderRepliesText()),e.renderReplyBox())),e.props.comment.repliesCount>0?Object(v.div)({className:y},e.children.map(e.renderComment),o(m.a,{comments:e.children}),o(p.a,{parent:e.props.comment,comments:e.children,total:e.props.comment.repliesCount,modifiers:e.props.modifiers,label:0===e.children.length?osu.trans("comments.load_replies"):void 0,ref:e.loadMoreRef})):void 0)}));var e},M.prototype.renderComment=function(e){return(e=a.comments.get(e.id)).isDeleted&&!b.a.userPreferences.get("comments_show_deleted")?null:o(M,{key:e.id,comment:e,depth:this.props.depth+1,parent:this.props.comment,modifiers:this.props.modifiers,expandReplies:this.props.expandReplies})},M.prototype.renderDelete=function(){if(!this.props.comment.isDeleted&&this.props.comment.canDelete)return Object(v.div)({className:"comment__row-item"},Object(v.button)({type:"button",className:"comment__action",onClick:this.delete},osu.trans("common.buttons.delete")))},M.prototype.renderDeletedBy=function(){var e;if(this.props.comment.isDeleted&&this.props.comment.canModerate)return Object(v.div)({className:"comment__row-item comment__row-item--info"},o(w.a,{mappings:{timeago:o(O.a,{dateTime:this.props.comment.deletedAt,relative:!0}),user:null!=this.props.comment.deletedById?o(E.a,{user:null!=(e=c.get(this.props.comment.deletedById))?e:n}):osu.trans("comments.deleted_by_system")},pattern:osu.trans("comments.deleted_by")}))},M.prototype.renderPin=function(){if(this.props.comment.canPin)return Object(v.div)({className:"comment__row-item"},Object(v.button)({type:"button",className:"comment__action",onClick:this.togglePinned},osu.trans("common.buttons."+(this.props.comment.pinned?"unpin":"pin"))))},M.prototype.renderEdit=function(){if(this.props.comment.canEdit)return Object(v.div)({className:"comment__row-item"},Object(v.button)({type:"button",className:"comment__action "+(this.state.editing?"comment__action--active":""),onClick:this.toggleEdit},osu.trans("common.buttons.edit")))},M.prototype.renderEditedBy=function(){var e;if(!this.props.comment.isDeleted&&this.props.comment.isEdited)return e=c.get(this.props.comment.editedById),Object(v.div)({className:"comment__row-item comment__row-item--info"},o(w.a,{mappings:{timeago:o(O.a,{dateTime:this.props.comment.editedAt,relative:!0}),user:o(E.a,{user:e})},pattern:osu.trans("comments.edited")}))},M.prototype.renderOwnerBadge=function(e){return null==e.owner_id||this.props.comment.userId!==e.owner_id?null:Object(v.div)({className:"comment__row-item"},Object(v.div)({className:"comment__owner-badge"},e.owner_title))},M.prototype.renderPermalink=function(){return Object(v.div)({className:"comment__row-item"},Object(v.span)({className:"comment__action comment__action--permalink"},o(u.a,{value:laroute.route("comments.show",{comment:this.props.comment.id}),label:osu.trans("common.buttons.permalink"),valueAsUrl:!0})))},M.prototype.renderRepliesText=function(){var e,t;if(0!==this.props.comment.repliesCount)return this.state.expandReplies||0!==this.children.length?(e=this.toggleReplies,t=osu.transChoice("comments.replies_count",this.props.comment.repliesCount)):(e=this.loadReplies,t=osu.trans("comments.load_replies")),Object(v.div)({className:"comment__row-item comment__row-item--replies"},o(y.a,{direction:this.state.expandReplies?"up":"down",hasMore:!0,label:t,callback:e,modifiers:["comment-replies"]}))},M.prototype.renderRepliesToggle=function(){if(0===this.props.depth&&this.children.length>0)return Object(v.div)({className:"comment__float-container comment__float-container--right"},Object(v.button)({className:"comment__top-show-replies",type:"button",onClick:this.toggleReplies},Object(v.span)({className:"fas "+(this.state.expandReplies?"fa-angle-up":"fa-angle-down")})))},M.prototype.renderReplyBox=function(){if(this.state.showNewReply)return Object(v.div)({className:"comment__reply-box"},o(d.a,{close:this.closeNewReply,modifiers:this.props.modifiers,onPosted:this.handleReplyPosted,parent:this.props.comment}))},M.prototype.renderReplyButton=function(){if(!this.props.comment.isDeleted)return Object(v.div)({className:"comment__row-item"},Object(v.button)({type:"button",className:"comment__action "+(this.state.showNewReply?"comment__action--active":""),onClick:this.toggleNewReply},osu.trans("common.buttons.reply")))},M.prototype.renderReport=function(){if(this.props.comment.canReport)return Object(v.div)({className:"comment__row-item"},o(g.a,{className:"comment__action",reportableId:this.props.comment.id,reportableType:"comment",user:this.userFor(this.props.comment)}))},M.prototype.renderRestore=function(){if(this.props.comment.isDeleted&&this.props.comment.canRestore)return Object(v.div)({className:"comment__row-item"},Object(v.button)({type:"button",className:"comment__action",onClick:this.restore},osu.trans("common.buttons.restore")))},M.prototype.renderToggleClipButton=function(){return Object(v.button)({type:"button",className:"comment__toggle-clip",onClick:this.toggleClip},this.state.clipped?osu.trans("common.buttons.read_more"):osu.trans("common.buttons.show_less"))},M.prototype.renderUserAvatar=function(e){return null!=e.id?Object(v.a)({className:"comment__avatar js-usercard","data-user-id":e.id,href:laroute.route("users.show",{user:e.id})},o(j.a,{user:e,modifiers:["full-circle"]})):Object(v.span)({className:"comment__avatar"},o(j.a,{user:e,modifiers:["full-circle"]}))},M.prototype.renderUsername=function(e){return null!=e.id?Object(v.a)({"data-user-id":e.id,href:laroute.route("users.show",{user:e.id}),className:"js-usercard comment__row-item"},e.username):Object(v.span)({className:"comment__row-item"},e.username)},M.prototype.renderVoteButton=function(e){var t,s,r;return null==e&&(e=!1),s=this.hasVoted(),t=Object(P.a)("comment-vote",this.props.modifiers,{disabled:!this.props.comment.canVote,inline:e,on:s,posting:this.state.postingVote}),e||s||(r=Object(v.div)({className:"comment-vote__hover"},"+1")),Object(v.button)({className:t,type:"button",onClick:this.voteToggle,disabled:this.state.postingVote||!this.props.comment.canVote},Object(v.span)({className:"comment-vote__text"},"+"+Object(N.d)(this.props.comment.votesCount,null,{maximumFractionDigits:1})),this.state.postingVote?Object(v.span)({className:"comment-vote__spinner"},o(_.a)):void 0,r)},M.prototype.renderCommentableMeta=function(e){var t,s;if(this.props.showCommentableMeta)return e.url?(t=v.a,s={href:e.url,className:"comment__link"}):(t=v.span,s=null),Object(v.div)({className:"comment__commentable-meta"},null!=this.props.comment.commentableType?Object(v.span)({className:"comment__commentable-meta-type"},Object(v.span)({className:"comment__commentable-meta-icon fas fa-comment"})," ",osu.trans("comments.commentable_name."+this.props.comment.commentableType)):void 0,t(s,e.title))},M.prototype.renderToolbar=function(){if(this.props.showToolbar)return Object(v.div)({className:"comment__toolbar"},Object(v.div)({className:"sort"},Object(v.div)({className:"sort__items"},Object(v.button)({type:"button",className:"sort__item sort__item--button",onClick:this.onShowDeletedToggleClick},Object(v.span)({className:"sort__item-icon"},Object(v.span)({className:b.a.userPreferences.get("comments_show_deleted")?"fas fa-check-square":"far fa-square"})),osu.trans("common.buttons.show_deleted")))))},M.prototype.hasVoted=function(){return a.userVotes.has(this.props.comment.id)},M.prototype.delete=function(){var e;if(confirm(osu.trans("common.confirmation")))return null!=(e=this.xhr.delete)&&e.abort(),this.xhr.delete=r.ajax(laroute.route("comments.destroy",{comment:this.props.comment.id}),{method:"DELETE"}).done((function(e){return r.publish("comment:updated",e)})).fail((function(e,t){if("abort"!==t)return osu.ajaxError(e)}))},M.prototype.togglePinned=function(){var e;if(this.props.comment.canPin)return null!=(e=this.xhr.pin)&&e.abort(),this.xhr.pin=r.ajax(laroute.route("comments.pin",{comment:this.props.comment.id}),{method:this.props.comment.pinned?"DELETE":"POST"}).done((function(e){return r.publish("comment:updated",e)})).fail((function(e,t){if("abort"!==t)return osu.ajaxError(e)}))},M.prototype.handleReplyPosted=function(e){if("reply"===e)return this.setState({expandReplies:!0})},M.prototype.toggleEdit=function(){return this.setState({editing:!this.state.editing})},M.prototype.closeEdit=function(){return this.setState({editing:!1})},M.prototype.loadReplies=function(){var e;return null!=(e=this.loadMoreRef.current)&&e.load(),this.toggleReplies()},M.prototype.onShowDeletedToggleClick=function(){return b.a.userPreferences.set("comments_show_deleted",!b.a.userPreferences.get("comments_show_deleted"))},M.prototype.parentLink=function(e){var t,s;return s={title:T(e)},this.props.linkParent?(t=v.a,s.href=laroute.route("comments.show",{comment:e.id}),s.className="comment__link"):t=v.span,t(s,Object(v.span)({className:"fas fa-reply"})," ",this.userFor(e).username)},M.prototype.userFor=function(e){var t,s;return null!=(s=null!=(t=c.get(e.userId))?t.toJson():void 0)?s:null!=e.legacyName?{username:e.legacyName}:n},M.prototype.restore=function(){var e;return null!=(e=this.xhr.restore)&&e.abort(),this.xhr.restore=r.ajax(laroute.route("comments.restore",{comment:this.props.comment.id}),{method:"POST"}).done((function(e){return r.publish("comment:updated",e)})).fail((function(e,t){if("abort"!==t)return osu.ajaxError(e)}))},M.prototype.toggleNewReply=function(){return this.setState({showNewReply:!this.state.showNewReply})},M.prototype.voteToggle=function(e){var t,s,i,n,o;if(n=e.target,!b.a.userLogin.showIfGuest(Object(N.c)(n)))return this.setState({postingVote:!0}),this.hasVoted()?(t="DELETE",i="removeUserVote"):(t="POST",i="addUserVote"),null!=(s=this.xhr.vote)&&s.abort(),this.xhr.vote=r.ajax(laroute.route("comments.vote",{comment:this.props.comment.id}),{method:t}).always((o=this,function(){return o.setState({postingVote:!1})})).done(function(e){return function(t){return r.publish("comment:updated",t),a[i](e.props.comment)}}(this)).fail((function(e,t){if("abort"!==t)return 401===e.status?r(n).trigger("ajax:error",[e,t]):osu.ajaxError(e)}))},M.prototype.closeNewReply=function(){return this.setState({showNewReply:!1})},M.prototype.toggleReplies=function(){return this.setState({expandReplies:!this.state.expandReplies})},M.prototype.toggleClip=function(){return this.setState({clipped:!this.state.clipped})},M}(f.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},UZmH:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("lv9K"),i=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class n{constructor(){Object.defineProperty(this,"beatmapsetIds",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"cursor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchedAt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hasMore",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"total",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object(r.p)(this)}get hasMoreForPager(){return this.hasMore&&this.beatmapsetIds.size<this.total}get isExpired(){return null==this.fetchedAt||(new Date).getTime()-this.fetchedAt.getTime()>n.CACHE_DURATION_MS}append(e){for(const t of e.beatmapsets)this.beatmapsetIds.add(t.id);this.cursor=e.cursor,this.fetchedAt=new Date,this.hasMore=null!==e.cursor,this.total=e.total}reset(){this.beatmapsetIds.clear(),this.fetchedAt=void 0,this.cursor=void 0,this.hasMore=!1,this.total=0}}Object.defineProperty(n,"CACHE_DURATION_MS",{enumerable:!0,configurable:!0,writable:!0,value:6e4}),i([r.q],n.prototype,"beatmapsetIds",void 0),i([r.q],n.prototype,"hasMore",void 0),i([r.q],n.prototype,"total",void 0),i([r.h],n.prototype,"hasMoreForPager",null),i([r.h],n.prototype,"isExpired",null),i([r.f],n.prototype,"append",null),i([r.f],n.prototype,"reset",null)},VEn2:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var r=s("7EfK"),i=s("/G9H"),n=s("0h6b"),o=s("f4vq");class a extends i.Component{constructor(e){if(super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:{expanded:!1}}),Object.defineProperty(this,"stateRecord",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"recordState",{enumerable:!0,configurable:!0,writable:!0,value:()=>{null!=this.stateRecord&&(this.stateRecord.dataset[this.stateRecordKey]=this.state.expanded?"1":"")}}),Object.defineProperty(this,"renderPost",{enumerable:!0,configurable:!0,writable:!0,value:e=>{let t="news-sidebar-month__item";return null!=this.props.currentPost&&this.props.currentPost.id===e.id&&(t+=" news-sidebar-month__item--active"),i.createElement("li",{key:e.id},i.createElement("a",{className:t,href:Object(n.route)("news.show",{news:e.slug})},e.title))}}),Object.defineProperty(this,"toggleExpand",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.setState({expanded:!this.state.expanded},this.recordState)}}),o.a.windowSize.isMobile)this.state.expanded=!1;else if(null==e.currentPost)this.state.expanded=e.initialExpand;else{const t=r.utc(e.currentPost.published_at);this.state.expanded=t.year()===e.date.year()&&t.month()===e.date.month()}const t=document.querySelector(".js-news-sidebar-record");t instanceof HTMLElement&&(this.stateRecord=t),null==this.stateRecordValue?this.recordState():this.state.expanded=this.stateRecordValue}get stateRecordKey(){return this.props.date.format("YYYYMM")}get stateRecordValue(){return this.stateRecord instanceof HTMLElement&&null!=this.stateRecord.dataset[this.stateRecordKey]?"1"===this.stateRecord.dataset[this.stateRecordKey]:null}render(){return i.createElement("div",{className:"news-sidebar-month"},i.createElement("button",{className:"news-sidebar-month__toggle",onClick:this.toggleExpand,type:"button"},this.props.date.format(osu.trans("common.datetime.year_month_short.moment")),i.createElement("span",{className:"news-sidebar-month__toggle-icon"},i.createElement("i",{className:this.state.expanded?"fas fa-chevron-up":"fas fa-chevron-down"}))),i.createElement("ul",{className:`news-sidebar-month__items ${this.state.expanded?"":"hidden"}`},this.props.posts.map(this.renderPost)))}}function l(e){return i.createElement("div",{className:"news-sidebar-years"},e.years.map(t=>i.createElement("a",{key:t,className:`news-sidebar-years__item ${t===e.currentYear?"news-sidebar-years__item--active":""}`,href:Object(n.route)("news.index",{year:t})},t)))}function c(e){var t;const s={},n={},o=new Set;for(const i of e.data.news_posts){const e=r.utc(i.published_at),a=e.format("YYYY-MM");(s[a]=null!==(t=s[a])&&void 0!==t?t:[]).push(i),n[a]=e,o.add(a)}const c=[...o];c.sort().reverse();let u=!0;return i.createElement("div",{className:"sidebar"},i.createElement("button",{className:"sidebar__mobile-toggle sidebar__mobile-toggle--mobile-only js-mobile-toggle","data-mobile-toggle-target":"news-archive",type:"button"},i.createElement("h2",{className:"sidebar__title"},osu.trans("news.sidebar.archive")),i.createElement("div",{className:"sidebar__mobile-toggle-icon"},i.createElement("i",{className:"fas fa-chevron-down"}))),i.createElement("div",{className:"sidebar__content hidden-xs js-mobile-toggle","data-mobile-toggle-id":"news-archive"},i.createElement(l,{currentYear:e.data.current_year,years:e.data.years}),c.map(t=>{if(null==s[t]||null==n[t])return;const r=n[t],o=u;return u=!1,i.createElement(a,{key:t,currentPost:e.currentPost,date:r,initialExpand:o,posts:s[t]})})))}},VbpL:function(e,t,s){"use strict";(function(e){var r=s("0h6b"),i=s("lv9K"),n=s("KUml"),o=s("f4vq"),a=s("/G9H"),l=s("PPOh"),c=s("/jJF"),u=s("tX/w"),d=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};const p="user-action-button";let m=class extends a.Component{constructor(t){var s;super(t),Object.defineProperty(this,"followersWithoutSelf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"loading",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"xhr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clicked",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.loading=!0,null==this.friend?this.xhr=e.ajax(Object(r.route)("friends.store",{target:this.props.userId}),{type:"POST"}):this.xhr=e.ajax(Object(r.route)("friends.destroy",{friend:this.props.userId}),{type:"DELETE"}),this.xhr.done(this.updateFriends).fail(Object(c.c)(this.clicked)).always(Object(i.f)(()=>this.loading=!1))}}),Object.defineProperty(this,"updateFriends",{enumerable:!0,configurable:!0,writable:!0,value:t=>{null!=o.a.currentUser&&(o.a.currentUser.friends=t,e.publish("user:update",o.a.currentUser))}}),this.followersWithoutSelf=null!==(s=this.props.followers)&&void 0!==s?s:0,null!=this.friend&&(this.followersWithoutSelf-=1),Object(i.p)(this)}get followers(){return this.followersWithoutSelf+(null==this.friend?0:1)}get friend(){var e;return null===(e=o.a.currentUser)||void 0===e?void 0:e.friends.find(e=>e.target_id===this.props.userId)}get isFriendLimit(){return null==o.a.currentUser||o.a.currentUser.friends.length>=o.a.currentUser.max_friends}get isVisible(){return null!=o.a.currentUser&&Number.isFinite(this.props.userId)&&this.props.userId!==o.a.currentUser.id&&!o.a.currentUser.blocks.some(e=>e.target_id===this.props.userId)}get showFollowerCounter(){return null!=this.props.followers}get title(){return this.isVisible?null!=this.friend?osu.trans("friends.buttons.remove"):this.isFriendLimit?osu.trans("friends.too_many"):osu.trans("friends.buttons.add"):osu.trans("friends.buttons.disabled")}componentWillUnmount(){var e;null===(e=this.xhr)||void 0===e||e.abort()}render(){if(!this.props.alwaysVisible&&!this.isVisible)return null;const e=null==this.friend||this.loading?null:this.friend.mutual?"mutual":"friend",t=Object(u.a)(p,this.props.modifiers,e),s=!this.isVisible||this.loading||this.isFriendLimit&&null==this.friend;return a.createElement("div",{title:this.title},a.createElement("button",{className:t,disabled:s,onClick:this.clicked,type:"button"},a.createElement("span",{className:`${p}__icon-container`},this.renderIcon()),this.renderCounter()))}renderCounter(){if(this.showFollowerCounter)return a.createElement("span",{className:`${p}__counter`},osu.formatNumber(this.followers))}renderIcon(){return this.loading?a.createElement(l.a,null):this.isVisible?null!=this.friend?a.createElement(a.Fragment,null,a.createElement("span",{className:`${p}__icon ${p}__icon--hover-visible`},a.createElement("span",{className:"fas fa-user-times"})),this.friend.mutual?a.createElement("span",{className:`${p}__icon ${p}__icon--hover-hidden`},a.createElement("span",{className:"fas fa-user-friends"})):a.createElement("span",{className:`${p}__icon ${p}__icon--hover-hidden`},a.createElement("span",{className:"fas fa-user"}))):a.createElement("span",{className:this.isFriendLimit?"fas fa-user":"fas fa-user-plus"}):a.createElement("span",{className:"fas fa-user"})}};Object.defineProperty(m,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{alwaysVisible:!1}}),d([i.q],m.prototype,"followersWithoutSelf",void 0),d([i.q],m.prototype,"loading",void 0),d([i.h],m.prototype,"followers",null),d([i.h],m.prototype,"friend",null),d([i.h],m.prototype,"isFriendLimit",null),d([i.h],m.prototype,"isVisible",null),d([i.h],m.prototype,"title",null),d([i.f],m.prototype,"clicked",void 0),d([i.f],m.prototype,"updateFriends",void 0),m=d([n.b],m),t.a=m}).call(this,s("5wds"))},VefT:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("Hs9Z"),i=s("/G9H"),n=s("tX/w");const o=e=>{const t=Object(n.a)("supporter-icon",e.modifiers);return i.createElement("span",{className:t,title:osu.trans("users.show.is_supporter")},Object(r.times)(e.level||1,e=>i.createElement("span",{key:e,className:"fas fa-heart"})))}},VsY1:function(e,t,s){"use strict";s.d(t,"a",(function(){return ge}));var r=s("va1x");class i{constructor(e){Object.defineProperty(this,"channelId",{enumerable:!0,configurable:!0,writable:!0,value:e})}}var n=s("QUfv"),o=s("G27q"),a=s("WLnA"),l=s("Rfpg"),c=s("Hs9Z"),u=s("lv9K"),d=s("205K"),p=s("rqcF"),m=s("bfq+");class h{constructor(e){Object.defineProperty(this,"json",{enumerable:!0,configurable:!0,writable:!0,value:e})}}var b=s("8gxX");class f{constructor(e){Object.defineProperty(this,"channelStore",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lastHistoryId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"retryDelay",{enumerable:!0,configurable:!0,writable:!0,value:new b.a(0,45e3)}),Object.defineProperty(this,"timerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"xhr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ping",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.xhr=Object(m.a)(this.channelStore.lastReceivedMessageId,this.lastHistoryId).done(e=>{var t;const s=null===(t=Object(c.maxBy)(e.silences,"id"))||void 0===t?void 0:t.id;null!=s&&(this.lastHistoryId=s),Object(a.a)(new h(e.silences)),this.retryDelay.reset(),this.scheduleNextPing()}).fail(e=>{401!==e.status&&this.scheduleNextPing()})}})}start(){null==this.timerId&&this.scheduleNextPing()}stop(){var e;null===(e=this.xhr)||void 0===e||e.abort(),this.retryDelay.reset(),null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=void 0)}scheduleNextPing(){this.timerId=window.setTimeout(this.ping,this.retryDelay.get())}}var v=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o},g=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(t){n(t)}}function a(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};let y=class{constructor(e){Object.defineProperty(this,"channelStore",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"isChatMounted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isReady",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"selectedBoxed",{enumerable:!0,configurable:!0,writable:!0,value:u.q.box(0)}),Object.defineProperty(this,"skipRefresh",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isConnected",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lastHistoryId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"pingService",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"selectedIndex",{enumerable:!0,configurable:!0,writable:!0,value:0}),this.pingService=new f(e),Object(u.p)(this),Object(u.r)(e.channels,e=>{"delete"===e.type&&this.refocusSelectedChannel()}),Object(u.g)(()=>{this.isReady&&this.isChatMounted?(this.pingService.start(),Object(a.a)(new n.a({event:"chat.start"}))):(this.pingService.stop(),Object(a.a)(new n.a({event:"chat.end"})))}),Object(u.g)(()=>g(this,void 0,void 0,(function*(){this.isConnected&&this.isChatMounted&&(this.skipRefresh?this.skipRefresh=!1:yield this.updateChannelList(),Object(u.u)(()=>{this.channelStore.loadChannel(this.selected),this.isReady=!0}))})))}get selected(){return this.selectedBoxed.get()}set selected(e){this.selectedBoxed.set(e)}get selectedChannel(){return this.channelStore.get(this.selected)}get channelList(){return l.b.flatMap(e=>this.channelStore.groupedChannels[e])}handleDispatchAction(e){e instanceof d.a?this.handleChatChannelJoinEvent(e):e instanceof p.a?this.handleChatChannelPartEvent(e):e instanceof i?this.handleChatNewConversationAdded(e):e instanceof o.a&&this.handleSocketStateChanged(e)}selectChannel(e){if(this.selected===e)return;null!=this.selectedChannel&&this.channelStore.markAsRead(this.selectedChannel.channelId);const t=this.channelStore.get(e);null!=t?(this.selected=e,this.selectedIndex=this.channelList.indexOf(t),this.channelStore.loadChannel(e)):console.error(`Trying to switch to non-existent channel ${e}`)}selectFirst(){0!==this.channelList.length&&this.selectChannel(this.channelList[0].channelId)}focusChannelAtIndex(e){if(0===this.channelList.length)return;const t=Object(c.clamp)(e,0,this.channelList.length-1),s=this.channelList[t];this.selectChannel(s.channelId)}handleChatChannelJoinEvent(e){this.channelStore.getOrCreate(e.json.channel_id).updateWithJson(e.json)}handleChatChannelPartEvent(e){this.channelStore.partChannel(e.channelId,!1)}handleChatNewConversationAdded(e){this.selectChannel(e.channelId)}handleSocketStateChanged(e){this.isConnected=e.connected,e.connected||(this.channelStore.channels.forEach(e=>e.needsRefresh=!0),this.isReady=!1)}refocusSelectedChannel(){null!=this.selectedChannel?this.selectChannel(this.selectedChannel.channelId):this.focusChannelAtIndex(this.selectedIndex)}updateChannelList(){return g(this,void 0,void 0,(function*(){const e=yield Object(m.c)(this.channelStore.lastReceivedMessageId,this.lastHistoryId);e&&Object(u.u)(()=>{var t;const s=null===(t=Object(c.maxBy)(e.silences,"id"))||void 0===t?void 0:t.id;null!=s&&(this.lastHistoryId=s),this.channelStore.updateWithJson(e)})}))}};v([u.q],y.prototype,"isChatMounted",void 0),v([u.q],y.prototype,"isReady",void 0),v([u.q],y.prototype,"selectedBoxed",void 0),v([u.q],y.prototype,"isConnected",void 0),v([u.h],y.prototype,"selected",null),v([u.h],y.prototype,"selectedChannel",null),v([u.h],y.prototype,"channelList",null),v([u.f],y.prototype,"selectChannel",null),v([u.f],y.prototype,"selectFirst",null),v([u.f],y.prototype,"focusChannelAtIndex",null),v([u.f],y.prototype,"handleChatChannelJoinEvent",null),v([u.f],y.prototype,"handleChatChannelPartEvent",null),v([u.f],y.prototype,"handleChatNewConversationAdded",null),v([u.f],y.prototype,"handleSocketStateChanged",null),v([u.f],y.prototype,"refocusSelectedChannel",null),v([u.f],y.prototype,"updateChannelList",null);var _=y=v([a.b],y),w=s("bpgk"),O=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class j{constructor(){Object.defineProperty(this,"beatmapsets",{enumerable:!0,configurable:!0,writable:!0,value:u.q.map()}),Object(u.p)(this)}get(e){return this.beatmapsets.get(e)}handleDispatchAction(e){e instanceof w.a&&this.flushStore()}update(e){this.beatmapsets.set(e.id,e)}flushStore(){this.beatmapsets.clear()}}O([u.q],j.prototype,"beatmapsets",void 0),O([u.f],j.prototype,"update",null),O([u.f],j.prototype,"flushStore",null);var E=s("XvDi"),P=s("2hxc"),k=s("sTr9"),N=s("d+cC"),S=s("f4vq"),x=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o},T=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(t){n(t)}}function a(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};function C(e,t){return e.name.localeCompare(t.name)}const M={GROUP:C,PM:(e,t)=>e.newPmChannel?-1:t.newPmChannel?1:e.lastMessageId===t.lastMessageId?0:e.lastMessageId>t.lastMessageId?-1:1,PUBLIC:C};let R=class{constructor(){Object.defineProperty(this,"channels",{enumerable:!0,configurable:!0,writable:!0,value:u.q.map()}),Object.defineProperty(this,"lastReceivedMessageId",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"markingAsRead",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object(u.p)(this)}get groupedChannels(){const e=function(){const e={};for(const t of l.b)e[t]=[];return e}();for(const t of this.channels.values())null!=t.supportedType&&e[t.supportedType].push(t);for(const t of l.b)e[t]=e[t].sort(M[t]);return e}addNewConversation(e,t){const s=this.getOrCreate(e.channel_id);return s.updateWithJson(e),s.addMessages([N.a.fromJson(t)]),s}findPM(e){var t;if(e===(null===(t=S.a.currentUser)||void 0===t?void 0:t.id))return null;for(const[,s]of this.channels)if("PM"===s.type&&s.users.includes(e))return s;return null}flushStore(){this.channels.clear()}get(e){return this.channels.get(e)}getOrCreate(e){let t=this.channels.get(e);return t||(t=new k.a(e),this.channels.set(e,t)),t}handleDispatchAction(e){e instanceof P.a?this.handleChatMessageNewEvent(e):e instanceof E.a?this.handleChatMessageSendAction(e):e instanceof h&&this.handleChatUpdateSilences(e)}loadChannel(e){var t;null===(t=this.channels.get(e))||void 0===t||t.load()}loadChannelEarlierMessages(e){var t;null===(t=this.get(e))||void 0===t||t.loadEarlierMessages()}markAsRead(e){const t=this.get(e);if(null==t||!t.isUnread||!t.uiState.autoScroll)return;if(null!=this.markingAsRead[e])return;t.markAsRead();const s=window.setTimeout(Object(u.f)(()=>{var r,i;this.markingAsRead[e]===s&&delete this.markingAsRead[e],(null===(r=t.lastMessage)||void 0===r?void 0:r.sender.id)!==(null===(i=S.a.currentUser)||void 0===i?void 0:i.id)&&Object(m.d)(t.channelId,t.lastMessageId)}),1e3);this.markingAsRead[e]=s}partChannel(e,t=!0){e>0&&t&&Object(m.f)(e,S.a.currentUserOrFail.id),this.channels.delete(e)}updateWithJson(e){var t;if(null!=e.presence&&this.updateWithPresence(e.presence),null!=e.messages){this.updateLastReceivedMessageId(e.messages);const s=Object(c.groupBy)(e.messages,"channel_id");for(const e of Object.keys(s)){const r=parseInt(e,10),i=s[r].map(N.a.fromJson);null===(t=this.channels.get(r))||void 0===t||t.addMessages(i)}}null!=e.silences&&Object(a.a)(new h(e.silences))}updateWithPresence(e){Object(l.a)(e).forEach(e=>{this.getOrCreate(e.channel_id).updateWithJson(e)}),this.channels.forEach(t=>{t.newPmChannel||e.find(e=>e.channel_id===t.channelId)||this.channels.delete(t.channelId)})}handleChatMessageNewEvent(e){for(const t of e.json.messages){const e=this.channels.get(t.channel_id);null!=e&&e.addMessage(t)}this.updateLastReceivedMessageId(e.json.messages)}handleChatMessageSendAction(e){return T(this,void 0,void 0,(function*(){const t=e.message,s=this.getOrCreate(t.channelId);s.addSendingMessage(t);try{if(s.newPmChannel){const e=s.users.slice().find(e=>e!==S.a.currentUserOrFail.id);if(null==e)return void console.debug("sendMessage:: userId not found?? this shouldn't happen");const r=yield Object(m.e)(e,t);Object(u.u)(()=>{this.channels.delete(t.channelId);const e=this.addNewConversation(r.channel,r.message);Object(a.a)(new i(e.channelId))})}else{const e=yield Object(m.g)(t);s.afterSendMesssage(t,e)}}catch(r){s.afterSendMesssage(t,null),osu.ajaxError(r)}}))}handleChatUpdateSilences(e){const t=new Set(e.json.map(e=>e.user_id));this.removePublicMessagesFromUserIds(t)}removePublicMessagesFromUserIds(e){this.groupedChannels.PUBLIC.forEach(t=>{t.removeMessagesFromUserIds(e)})}updateLastReceivedMessageId(e){var t,s;null!=e&&(this.lastReceivedMessageId=null!==(s=null===(t=Object(c.maxBy)(e,"message_id"))||void 0===t?void 0:t.message_id)&&void 0!==s?s:this.lastReceivedMessageId)}};x([u.q],R.prototype,"channels",void 0),x([u.h],R.prototype,"groupedChannels",null),x([u.f],R.prototype,"addNewConversation",null),x([u.f],R.prototype,"flushStore",null),x([u.f],R.prototype,"getOrCreate",null),x([u.f],R.prototype,"loadChannel",null),x([u.f],R.prototype,"loadChannelEarlierMessages",null),x([u.f],R.prototype,"markAsRead",null),x([u.f],R.prototype,"partChannel",null),x([u.f],R.prototype,"updateWithJson",null),x([u.f],R.prototype,"updateWithPresence",null),x([u.f],R.prototype,"handleChatMessageNewEvent",null),x([u.f],R.prototype,"handleChatMessageSendAction",null),x([u.f],R.prototype,"handleChatUpdateSilences",null),x([u.f],R.prototype,"removePublicMessagesFromUserIds",null),x([u.f],R.prototype,"updateLastReceivedMessageId",null);var D=R=x([a.b],R),I=s("Cfan"),A=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class H{constructor(){Object.defineProperty(this,"clients",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object(u.p)(this)}handleDispatchAction(e){e instanceof w.a&&this.flushStore()}initialize(e){for(const t of e){const e=new I.a(t);this.clients.set(e.id,e)}}flushStore(){this.clients.clear()}}A([u.q],H.prototype,"clients",void 0),A([u.f],H.prototype,"flushStore",null);var B=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class L{constructor(e){Object.defineProperty(this,"commentableId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"commentableType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"createdAt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"deletedAt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"deletedById",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"editedAt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"editedById",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"legacyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"messageHtml",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parentId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pinned",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repliesCount",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"updatedAt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"userId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"votesCount",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.commentableId=e.commentable_id,this.commentableType=e.commentable_type,this.createdAt=e.created_at,this.deletedAt=e.deleted_at,this.deletedById=e.deleted_by_id,this.editedAt=e.edited_at,this.editedById=e.edited_by_id,this.id=e.id,this.legacyName=e.legacy_name,this.message=e.message,this.messageHtml=e.message_html,this.parentId=e.parent_id,this.pinned=e.pinned,this.repliesCount=e.replies_count,this.updatedAt=e.updated_at,this.userId=e.user_id,this.votesCount=e.votes_count,Object(u.p)(this)}get canDelete(){return this.canModerate||this.isOwner}get canEdit(){return this.canModerate||this.isOwner&&!this.isDeleted}get canHaveVote(){return!this.isDeleted}get canModerate(){return null!=S.a.currentUser&&(S.a.currentUser.is_admin||S.a.currentUser.is_moderator)}get canPin(){var e;return(null===(e=S.a.currentUser)||void 0===e?void 0:e.is_admin)&&(null==this.parentId||this.pinned)}get canReport(){return null!=S.a.currentUser&&this.userId!==S.a.currentUser.id}get canRestore(){return this.canModerate}get canVote(){return!this.isOwner}get isDeleted(){return null!=this.deletedAt}get isEdited(){return null!=this.editedAt}get isOwner(){return null!=S.a.currentUser&&this.userId===S.a.currentUser.id}}B([u.h],L.prototype,"canDelete",null),B([u.h],L.prototype,"canEdit",null),B([u.h],L.prototype,"canHaveVote",null),B([u.h],L.prototype,"canModerate",null),B([u.h],L.prototype,"canPin",null),B([u.h],L.prototype,"canReport",null),B([u.h],L.prototype,"canRestore",null),B([u.h],L.prototype,"canVote",null),B([u.h],L.prototype,"isDeleted",null),B([u.h],L.prototype,"isEdited",null),B([u.h],L.prototype,"isOwner",null);var U=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class ${constructor(){Object.defineProperty(this,"comments",{enumerable:!0,configurable:!0,writable:!0,value:u.q.map()}),Object.defineProperty(this,"userVotes",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"groupedByParentId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object(u.p)(this)}addUserVote(e){this.userVotes.add(e.id)}addVoted(e){null!=e&&e.forEach(e=>this.userVotes.add(e))}flushStore(){this.invalidate(),this.comments.clear(),this.userVotes.clear()}getRepliesByParentId(e){return this.groupedByParentId[String(e)]}initialize(e,t){this.flushStore(),this.addVoted(t),this.updateWithJson(e)}removeUserVote(e){this.userVotes.delete(e.id)}updateWithJson(e){if(null!=e)for(const t of e){const e=new L(t),s=this.comments.has(e.id);if(this.comments.set(e.id,e),!s){const t=String(e.parentId);null!=this.groupedByParentId[t]?this.groupedByParentId[t].push(e):this.groupedByParentId[t]=[e]}}}invalidate(){this.groupedByParentId={}}}U([u.q],$.prototype,"comments",void 0),U([u.q],$.prototype,"userVotes",void 0),U([u.f],$.prototype,"addUserVote",null),U([u.f],$.prototype,"addVoted",null),U([u.f],$.prototype,"flushStore",null),U([u.f],$.prototype,"initialize",null),U([u.f],$.prototype,"removeUserVote",null),U([u.f],$.prototype,"updateWithJson",null);var q=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class G{constructor(){Object.defineProperty(this,"meta",{enumerable:!0,configurable:!0,writable:!0,value:u.q.map()}),Object(u.p)(this)}flushStore(){this.meta.clear()}get(e,t){const s=this.meta.get(`${e}-${t}`);return null!=s?s:this.meta.get(null)}initialize(e){this.flushStore(),this.updateWithJson(e)}updateWithJson(e){if(null!=e)for(const t of e){const e="id"in t?`${t.type}-${t.id}`:null;this.meta.set(e,t)}}}q([u.q],G.prototype,"meta",void 0),q([u.f],G.prototype,"flushStore",null),q([u.f],G.prototype,"initialize",null),q([u.f],G.prototype,"updateWithJson",null);var F=s("uW+8"),V=s("nxXY"),W=s("3Zv4"),X=s("y2EG"),z=s("5evE"),K=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class J{constructor(e,t,s,r){Object.defineProperty(this,"objectId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"objectType",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"category",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"resolver",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"cursor",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"displayOrder",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"isDeleting",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isLoading",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isMarkingAsRead",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"notifications",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"total",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"lastNotification",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object(u.p)(this)}get canMarkAsRead(){for(const[,e]of this.notifications)if(e.canMarkRead)return!0;return!1}get first(){var e;return null!==(e=this.orderedNotifications[0])&&void 0!==e?e:this.lastNotification}get hasMore(){return!(this.notifications.size>=this.total||null==this.cursor)}get hasVisibleNotifications(){return this.notifications.size>0}get id(){return`${this.objectType}-${this.objectId}-${this.category}`}get identity(){return{category:this.category,objectId:this.objectId,objectType:this.objectType}}get isSingle(){return 1===this.total}get orderedNotifications(){return[...this.notifications.values()].sort((e,t)=>t.id-e.id)}get type(){return this.objectType}static fromJson(e,t){const s=new J(e.object_id,e.object_type,Object(z.a)(e.name),t);return s.updateWithJson(e),s}add(e){this.notifications.set(e.id,e),this.displayOrder=Math.max(e.id,this.displayOrder)}delete(){this.resolver.delete(this)}deleteItem(e){null!=e&&this.notifications.has(e.id)&&this.resolver.delete(e)}loadMore(e){null!=this.cursor&&(this.isLoading=!0,this.resolver.loadMore(this.identity,e,this.cursor).always(Object(u.f)(()=>{this.isLoading=!1})))}markAsRead(e){null!=e&&this.notifications.has(e.id)&&this.resolver.queueMarkAsRead(e)}markStackAsRead(){this.resolver.queueMarkAsRead(this)}remove(e){1===this.notifications.size&&(this.lastNotification=this.notifications.values().next().value);const t=this.notifications.delete(e.id);return t&&this.total--,t}updateWithJson(e){this.cursor=e.cursor,this.total=e.total}}K([u.q],J.prototype,"cursor",void 0),K([u.q],J.prototype,"displayOrder",void 0),K([u.q],J.prototype,"isDeleting",void 0),K([u.q],J.prototype,"isLoading",void 0),K([u.q],J.prototype,"isMarkingAsRead",void 0),K([u.q],J.prototype,"notifications",void 0),K([u.q],J.prototype,"total",void 0),K([u.q],J.prototype,"lastNotification",void 0),K([u.h],J.prototype,"canMarkAsRead",null),K([u.h],J.prototype,"first",null),K([u.h],J.prototype,"hasMore",null),K([u.h],J.prototype,"hasVisibleNotifications",null),K([u.h],J.prototype,"id",null),K([u.h],J.prototype,"isSingle",null),K([u.h],J.prototype,"orderedNotifications",null),K([u.f],J.prototype,"add",null),K([u.f],J.prototype,"delete",null),K([u.f],J.prototype,"deleteItem",null),K([u.f],J.prototype,"loadMore",null),K([u.f],J.prototype,"markAsRead",null),K([u.f],J.prototype,"markStackAsRead",null),K([u.f],J.prototype,"remove",null),K([u.f],J.prototype,"updateWithJson",null);var Z=s("JlDh"),Y=s("kiUL"),Q=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let ee=class{constructor(e){Object.defineProperty(this,"notificationStore",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"legacyPm",{enumerable:!0,configurable:!0,writable:!0,value:new W.a}),Object.defineProperty(this,"types",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"deletedStacks",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"resolver",{enumerable:!0,configurable:!0,writable:!0,value:new Y.a}),Object.defineProperty(this,"removeByNotification",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t,s;if(null==e.id)return;const r=this.getStack(e),i=this.getOrCreateType(e),n=null==r?void 0:r.notifications.get(e.id);null==n?null!=r&&e.id<(null!==(s=null===(t=r.cursor)||void 0===t?void 0:t.id)&&void 0!==s?s:0)&&(this.total--,r.total--,i.total--):(null==r||r.remove(n),i.total--,this.total--)}}),this.getOrCreateType({objectType:null}),Object(u.p)(this)}get allStacks(){return this.allType.stacks}get allType(){return this.getOrCreateType({objectType:null})}get isEmpty(){return 1===this.types.size&&0===this.allStacks.size}get total(){return this.allType.total}set total(e){this.allType.total=e}flushStore(){this.types.clear()}getOrCreateType(e){let t=this.types.get(e.objectType);return null==t&&(t=new Z.a(e.objectType,this.resolver),this.types.set(t.name,t)),t}getStack(e){var t;return null===(t=this.types.get(e.objectType))||void 0===t?void 0:t.stacks.get(Object(V.c)(e))}handleDispatchAction(e){e instanceof F.a?this.handleNotificationEventDelete(e):e instanceof F.c?this.handleNotificationEventNew(e):e instanceof F.b?this.handleNotificationEventMoreLoaded(e):e instanceof F.d?this.handleNotificationEventRead(e):e instanceof w.a&&this.flushStore()}handleNotificationEventDelete(e){this.removeByEvent(e)}handleNotificationEventMoreLoaded(e){e.context.isWidget||this.updateWithBundle(e.data)}handleNotificationEventNew(e){const t=e.data;let s=this.notificationStore.get(t.id);null==s?(s=X.a.fromJson(t),this.notificationStore.add(s)):s.updateFromJson(t);const r=s.identity,i=this.getOrCreateType(r);let n=this.getStack(r);null==n&&(n=new J(t.object_id,t.object_type,Object(z.a)(t.name),this.resolver)),n.notifications.has(s.id)||(n.total++,i.total++,this.total++),n.add(s),i.stacks.set(n.id,n),this.allStacks.set(n.id,n)}handleNotificationEventRead(e){}orderedStacksOfType(e){return this.stacksOfType(e).sort((e,t)=>t.displayOrder-e.displayOrder)}removeByEvent(e){for(const t of e.data){switch(Object(V.b)(t)){case"type":this.removeByType(t);break;case"stack":this.removeByStack(t,e.readCount);break;case"notification":this.removeByNotification(t)}}}stacksOfType(e){var t,s;const r=this.types.get(e),i=[];if(null==r)return i;const n=null!==(s=null===(t=r.cursor)||void 0===t?void 0:t.id)&&void 0!==s?s:0;for(const[,o]of r.stacks)void 0!==(null==r?void 0:r.cursor)&&o.displayOrder>=n&&i.push(o);return i}updateWithBundle(e){var t,s,r;null===(t=e.types)||void 0===t||t.forEach(e=>this.updateWithTypeJson(e)),null===(s=e.stacks)||void 0===s||s.forEach(e=>this.updateWithStackJson(e)),null===(r=e.notifications)||void 0===r||r.forEach(e=>this.updateWithNotificationJson(e))}removeByStack(e,t){const s=this.getStack(e),r=Object(V.c)(e);null!=s?(this.deletedStacks.add(r),this.allStacks.delete(r),this.total-=s.total,this.getOrCreateType(e).removeStack(s)):this.deletedStacks.has(r)||(this.deletedStacks.add(r),this.total-=t)}removeByType(e){const t=this.getOrCreateType(e);if(null===t.name){for(const[e,t]of this.types)null!==e&&this.removeType(t);t.total=0}else this.removeType(t)}removeType(e){e.stacks.forEach(e=>{this.allType.removeStack(e)}),e.total=0,this.types.delete(e.name)}updateWithNotificationJson(e){var t;let s=this.notificationStore.get(e.id);null==s?(s=X.a.fromJson(e),this.notificationStore.add(s)):s.updateFromJson(e),null===(t=this.getOrCreateType(s.identity).stacks.get(s.stackId))||void 0===t||t.add(s)}updateWithStackJson(e){const t=this.getOrCreateType(Object(V.a)(e));let s=t.stacks.get(function(e){return`${e.object_type}-${e.object_id}-${Object(z.a)(e.name)}`}(e));null==s?(s=J.fromJson(e,this.resolver),t.stacks.set(s.id,s),this.allType.stacks.set(s.id,s)):s.updateWithJson(e)}updateWithTypeJson(e){this.getOrCreateType({objectType:e.name}).updateWithJson(e)}};Q([u.q],ee.prototype,"legacyPm",void 0),Q([u.q],ee.prototype,"types",void 0),Q([u.h],ee.prototype,"total",null),Q([u.f],ee.prototype,"flushStore",null),Q([u.f],ee.prototype,"getOrCreateType",null),Q([u.f],ee.prototype,"handleDispatchAction",null),Q([u.f],ee.prototype,"handleNotificationEventDelete",null),Q([u.f],ee.prototype,"handleNotificationEventMoreLoaded",null),Q([u.f],ee.prototype,"handleNotificationEventNew",null),Q([u.f],ee.prototype,"handleNotificationEventRead",null),Q([u.f],ee.prototype,"removeByEvent",null),Q([u.f],ee.prototype,"updateWithBundle",null);var te=ee=Q([a.b],ee),se=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let re=class extends te{handleNotificationEventMoreLoaded(e){e.context.isWidget&&this.updateWithBundle(e.data)}handleNotificationEventNew(e){e.data.is_read||super.handleNotificationEventNew(e)}handleNotificationEventRead(e){this.removeByEvent(e)}updateWithBundle(e){super.updateWithBundle(e),null!=e.unread_count&&(this.total=e.unread_count)}};se([u.s],re.prototype,"handleNotificationEventMoreLoaded",null),se([u.s],re.prototype,"handleNotificationEventNew",null),se([u.s],re.prototype,"handleNotificationEventRead",null),se([u.s],re.prototype,"updateWithBundle",null);var ie=re=se([a.b],re),ne=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let oe=class{constructor(){Object.defineProperty(this,"notifications",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"stacks",{enumerable:!0,configurable:!0,writable:!0,value:new te(this)}),Object.defineProperty(this,"unreadStacks",{enumerable:!0,configurable:!0,writable:!0,value:new ie(this)}),Object(u.p)(this)}add(e){this.notifications.set(e.id,e)}flushStore(){this.notifications.clear()}get(e){return this.notifications.get(e)}handleDispatchAction(e){e instanceof F.a?this.handleNotificationEventDelete(e):e instanceof F.d?this.handleNotificationEventRead(e):e instanceof w.a&&this.flushStore()}handleNotificationEventDelete(e){this.eachByEvent(e,e=>{this.notifications.delete(e.id)})}handleNotificationEventRead(e){this.eachByEvent(e,e=>{e.isRead=!0})}eachByEvent(e,t){for(const s of e.data){switch(Object(V.b)(s)){case"type":this.eachByType(s,t);break;case"stack":this.eachByStack(s,t);break;case"notification":{if(null==s.id)return;const e=this.get(s.id);null!=e&&t(e);break}}}}eachByStack(e,t){const s=Object(V.c)(e);this.notifications.forEach(e=>{e.stackId===s&&t(e)})}eachByType(e,t){this.notifications.forEach(s=>{null!=e.objectType&&s.objectType!==e.objectType||t(s)})}};ne([u.q],oe.prototype,"notifications",void 0),ne([u.f],oe.prototype,"add",null),ne([u.f],oe.prototype,"flushStore",null),ne([u.f],oe.prototype,"handleDispatchAction",null),ne([u.f],oe.prototype,"handleNotificationEventDelete",null),ne([u.f],oe.prototype,"handleNotificationEventRead",null);var ae=oe=ne([a.b],oe),le=s("IfWv"),ce=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class ue{constructor(){Object.defineProperty(this,"clients",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object(u.p)(this)}handleDispatchAction(e){e instanceof w.a&&this.flushStore()}initialize(e){for(const t of e)this.updateWithJson(t)}updateWithJson(e){const t=new le.a(e);return this.clients.set(t.id,t),t}flushStore(){this.clients.clear()}}ce([u.q],ue.prototype,"clients",void 0),ce([u.f],ue.prototype,"updateWithJson",null),ce([u.f],ue.prototype,"flushStore",null);var de=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};const pe={currentSort:"new",hasMoreComments:{},loadingFollow:null,loadingSort:null,pinnedCommentIds:[],topLevelCommentIds:[],topLevelCount:0,total:0,userFollow:!1};class me{constructor(e){Object.defineProperty(this,"commentStore",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"account",{enumerable:!0,configurable:!0,writable:!0,value:{client:null,isCreatingNewClient:!1,newClientVisible:!1}}),Object.defineProperty(this,"comments",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},pe)}),Object.defineProperty(this,"orderedCommentsByParentId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object(u.p)(this)}exportCommentsUIState(){return{comments:this.comments,orderedCommentsByParentId:this.orderedCommentsByParentId}}getOrderedCommentsByParentId(e){return this.populateOrderedCommentsForParentId(e),this.orderedCommentsByParentId[e]}importCommentsUIState(e){this.comments=Object.assign({},pe,e.comments),this.orderedCommentsByParentId=e.orderedCommentsByParentId}initializeWithCommentBundleJson(e){this.comments.hasMoreComments={},this.comments.hasMoreComments[e.has_more_id]=e.has_more,this.comments.currentSort=e.sort,this.comments.userFollow=e.user_follow,this.comments.topLevelCount=e.top_level_count?e.top_level_count:0,this.comments.total=e.total?e.total:0,null!=e.comments&&(this.comments.topLevelCommentIds=e.comments.map(e=>e.id)),this.updatePinnedCommentIds(e),this.orderedCommentsByParentId={}}updateFromCommentUpdated(e){this.updatePinnedCommentIds(e)}updateFromCommentsAdded(e){this.comments.hasMoreComments[e.has_more_id]=e.has_more,e.top_level_count&&e.total&&(this.comments.topLevelCount=e.top_level_count,this.comments.total=e.total);for(const t of e.comments){const e=new L(t),s=e.parentId;null==s?this.comments.topLevelCommentIds.push(e.id):(this.populateOrderedCommentsForParentId(s),this.orderedCommentsByParentId[s].push(e))}}updateFromCommentsNew(e){e.top_level_count&&e.total&&(this.comments.topLevelCount=e.top_level_count,this.comments.total=e.total);const t=new L(e.comments[0]),s=t.parentId;null==s?this.comments.topLevelCommentIds.unshift(t.id):(this.populateOrderedCommentsForParentId(s),this.orderedCommentsByParentId[s].unshift(t))}orderComments(e){switch(this.comments.currentSort){case"old":return Object(c.orderBy)(e,"createdAt","asc");case"top":return Object(c.orderBy)(e,"votesCount","desc");default:return Object(c.orderBy)(e,"createdAt","desc")}}populateOrderedCommentsForParentId(e){if(null==this.orderedCommentsByParentId[e]){const t=this.commentStore.getRepliesByParentId(e);this.orderedCommentsByParentId[e]=this.orderComments(t)}}updatePinnedCommentIds(e){null!=e.pinned_comments&&(this.comments.pinnedCommentIds=e.pinned_comments.map(e=>e.id))}}de([u.q],me.prototype,"account",void 0),de([u.q],me.prototype,"comments",void 0),de([u.f],me.prototype,"importCommentsUIState",null),de([u.f],me.prototype,"initializeWithCommentBundleJson",null),de([u.f],me.prototype,"updateFromCommentUpdated",null),de([u.f],me.prototype,"updateFromCommentsAdded",null),de([u.f],me.prototype,"updateFromCommentsNew",null);var he=s("srn7"),be=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let fe=class{constructor(){Object.defineProperty(this,"users",{enumerable:!0,configurable:!0,writable:!0,value:u.q.map()}),Object(u.p)(this)}flushStore(){this.users=u.q.map()}get(e){return this.users.get(e)}getOrCreate(e,t){let s=this.users.get(e);return s&&s.loaded?s:(s=t?he.a.fromJson(t):new he.a(e),this.users.set(e,s),s.loaded||s.load(),s)}handleDispatchAction(e){e instanceof P.a&&this.updateWithJson(e.json.users)}updateWithJson(e){if(null!=e)for(const t of e){const e=he.a.fromJson(t);this.users.set(e.id,e)}}};be([u.q],fe.prototype,"users",void 0),be([u.f],fe.prototype,"flushStore",null),be([u.f],fe.prototype,"getOrCreate",null),be([u.f],fe.prototype,"updateWithJson",null);var ve=fe=be([a.b],fe);class ge{constructor(){Object.defineProperty(this,"beatmapsetSearch",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"beatmapsetStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"channelStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"chatState",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"commentStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"commentableMetaStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"notificationStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ownClientStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"uiState",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"userStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.beatmapsetStore=new j,this.beatmapsetSearch=new r.a(this.beatmapsetStore),this.clientStore=new H,this.commentableMetaStore=new G,this.commentStore=new $,this.notificationStore=new ae,this.ownClientStore=new ue,this.userStore=new ve,this.channelStore=new D,this.chatState=new _(this.channelStore),this.uiState=new me(this.commentStore),Object(u.p)(this)}updateWithCommentBundleJson(e){this.commentableMetaStore.updateWithJson(e.commentable_meta),this.commentStore.updateWithJson(e.comments),this.commentStore.updateWithJson(e.included_comments),this.commentStore.updateWithJson(e.pinned_comments),this.userStore.updateWithJson(e.users),this.commentStore.addVoted(e.user_votes)}}(function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);n>3&&o&&Object.defineProperty(t,s,o)})([u.f],ge.prototype,"updateWithCommentBundleJson",null)},VxeA:function(e,t,s){"use strict";const r=Object.freeze({colour:"hsl(var(--hsl-l1))",has_listing:!1,has_playmodes:!1,id:-1,identifier:"owner",is_probationary:!1,name:"Beatmap Mapper",short_name:"MAPPER"});t.a=r},WD1s:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("lv9K"),i=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};const n=["extra","general","genre","language","mode","nsfw","played","query","rank","sort","status"];class o{constructor(e){var t;Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"general",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"genre",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"language",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"mode",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"nsfw",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"played",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"query",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"rank",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:null});const s=BeatmapsetFilter.filtersFromUrl(e);for(const r of n)this[r]=null!==(t=s[r])&&void 0!==t?t:null;Object(r.p)(this),Object(r.l)(this,"query",e=>{var t;return e.newValue=osu.presence(null===(t=e.newValue)||void 0===t?void 0:t.trim()),e})}get displaySort(){return this.selectedValue("sort")}get queryParams(){const e=this.values;return BeatmapsetFilter.queryParamsFromFilters(e)}get searchSort(){const[e,t]=this.displaySort.split("_");return{field:e,order:t}}selectedValue(e){const t=this[e];return null==t?BeatmapsetFilter.getDefault(this.values,e):t}toKeyString(){const e=this.values,t=BeatmapsetFilter.fillDefaults(e),s=[];for(const r of n)s.push(`${r}=${t[r]}`);return s.join("&")}update(e){(void 0!==e.query&&e.query!==this.query||void 0!==e.status&&e.status!==this.status)&&(this.sort=null);for(const t of n){const s=e[t];void 0!==s&&(this[t]=s)}}get values(){return Object.assign({},this)}}i([r.q],o.prototype,"extra",void 0),i([r.q],o.prototype,"general",void 0),i([r.q],o.prototype,"genre",void 0),i([r.q],o.prototype,"language",void 0),i([r.q],o.prototype,"mode",void 0),i([r.q],o.prototype,"nsfw",void 0),i([r.q],o.prototype,"played",void 0),i([r.q],o.prototype,"query",void 0),i([r.q],o.prototype,"rank",void 0),i([r.q],o.prototype,"sort",void 0),i([r.q],o.prototype,"status",void 0),i([r.h],o.prototype,"displaySort",null),i([r.h],o.prototype,"queryParams",null),i([r.h],o.prototype,"searchSort",null),i([r.f],o.prototype,"update",null),i([r.h],o.prototype,"values",null)},WLnA:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return n}));const r=new class{constructor(){Object.defineProperty(this,"listeners",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"trace",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"dispatch",{enumerable:!0,configurable:!0,writable:!0,value:e=>{this.trace&&console.debug("Dispatcher::dispatch",e),this.listeners.forEach(t=>{t.handleDispatchAction(e)})}})}get size(){return this.listeners.size}clear(){this.listeners.clear()}has(e){return this.listeners.has(e)}register(e){this.listeners.add(e)}unregister(e){this.listeners.delete(e)}};const i=r.dispatch;function n(e){return class extends e{constructor(...e){var t;super(...e),"object"==typeof(t=this)&&null!=t&&"handleDispatchAction"in t&&r.register(this)}}}},XFVs:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var r=s("0h6b"),i=s("7EfK"),n=s("/G9H"),o=s("mk7q"),a=s("tX/w");function l({modifiers:e,post:t}){let s;null!=t.first_image&&(s=n.createElement("img",{className:"news-card__cover",src:t.first_image}));let l=t.preview;return null==l&&(l=""),n.createElement("a",{className:Object(a.a)("news-card",null!=e?e:["index","hover"]),href:Object(r.route)("news.show",{news:t.slug})},n.createElement("div",{className:"news-card__cover-container"},s,n.createElement("div",{className:"news-card__time js-tooltip-time",title:t.published_at},i.utc(t.published_at).format("ll"))),n.createElement("div",{className:"news-card__main"},n.createElement("div",{className:"news-card__row news-card__row--title"},t.title),n.createElement("div",{dangerouslySetInnerHTML:{__html:l},className:"news-card__row news-card__row--preview"}),n.createElement("div",{className:"news-card__row news-card__row--author"},n.createElement(o.a,{mappings:{user:n.createElement("strong",null,t.author)},pattern:osu.trans("news.show.by")}))))}},XMXc:function(e,t,s){"use strict";s.d(t,"a",(function(){return f}));var r=s("/G9H"),i=s("KHX3"),n=s("iH//"),o=s("vZz4");function a(){function e(e,t,s){const r=new RegExp(o.j).exec(t);if(!r||0!==r.index)return;if(s)return!0;const[i,,n]=r;return e(i)({children:[{type:"text",value:n}],type:"link",url:i})}const t=this.Parser,s=t.prototype.inlineTokenizers,r=t.prototype.inlineMethods;e.locator=function(e,t){return e.indexOf("http",t)},s.link=e,r.unshift("link")}var l=s("Cy5r"),c=s("sHNI"),u=s("+AAq"),d=s("tX/w"),p=s("Y9Pv"),m=s("DHbW");const h=({data:e})=>{const t="beatmap-discussion-review-post-embed-preview",s=r.useContext(m.a),i=r.useContext(p.a),n=s[e.discussion_id];if(!n)return r.createElement("div",{className:Object(d.a)(t,["deleted","lighter"])},r.createElement("div",{className:`${t}__missing`},osu.trans("beatmaps.discussions.review.embed.missing")));const o=null==n.beatmap_id?void 0:i[n.beatmap_id],a=["lighter"];"praise"===n.message_type?a.push("praise"):n.resolved&&a.push("resolved"),null!==n.beatmap_id||a.push("general-all"),n.deleted_at&&a.push("deleted");const l=()=>{if(n.parent_id)return r.createElement("div",{className:`${t}__link`},r.createElement("a",{className:`${t}__link-text js-beatmap-discussion--jump`,href:BeatmapDiscussionHelper.url({discussion:n}),title:osu.trans("beatmap_discussions.review.go_to_child")},r.createElement("i",{className:"fas fa-external-link-alt"})))};return r.createElement("div",{className:Object(d.a)(t,a)},r.createElement("div",{className:`${t}__content`},r.createElement("div",{className:`${t}__selectors`},r.createElement("div",{className:"icon-dropdown-menu icon-dropdown-menu--disabled"},null!=o&&r.createElement(u.a,{beatmap:o}),!n.beatmap_id&&r.createElement("i",{className:"fas fa-fw fa-star-of-life",title:osu.trans("beatmaps.discussions.mode.scopes.generalAll")})),r.createElement("div",{className:"icon-dropdown-menu icon-dropdown-menu--disabled"},(()=>{const e=n.message_type;return r.createElement("div",{className:`beatmap-discussion-message-type beatmap-discussion-message-type--${e}`},r.createElement("i",{className:c.a[e],title:osu.trans(`beatmaps.discussions.message_type.${e}`)}))})()),r.createElement("div",{className:`${t}__timestamp`},(()=>r.createElement("div",{className:`${t}__timestamp-text`},null!==n.timestamp?BeatmapDiscussionHelper.formatTimestamp(n.timestamp):osu.trans("beatmap_discussions.timestamp_display.general")))()),r.createElement("div",{className:`${t}__stripe`}),l()),r.createElement("div",{className:`${t}__stripe`}),r.createElement("div",{className:`${t}__message-container`},r.createElement("div",{className:`${t}__body`,dangerouslySetInnerHTML:{__html:BeatmapDiscussionHelper.format((n.starting_post||n.posts[0]).message)}})),l()))};function b(){function e(e,t,s){const r=new RegExp(/^((\d{2,}:[0-5]\d[:.]\d{3})( \((?:\d[,|])*\d\))?)/).exec(t);if(!r)return;if(s)return!0;const[i,n]=r;return e(i)({children:[{type:"text",value:n}],href:Object(o.h)(n),type:"timestamp"})}const t=this.Parser,s=t.prototype.inlineTokenizers,r=t.prototype.inlineMethods;e.locator=function(e,t){const s=e.substr(t).search(/[0-9]{2}:/);return s<0?s:s+t},s.timestamp=e,r.unshift("timestamp")}class f extends r.Component{constructor(){super(...arguments),Object.defineProperty(this,"linkRenderer",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=Object(n.c)(e.href);return r.createElement("a",Object.assign({},e,t))}})}embed(e){return r.createElement("div",{key:osu.uuid(),className:"beatmap-discussion-review-post__block"},r.createElement(h,{data:{discussion_id:e}}))}paragraph(e){return r.createElement(i,{key:osu.uuid(),plugins:[[l.a,{allowedBlocks:["paragraph"],allowedInlines:["emphasis","strong"]}],a,b],renderers:{link:this.linkRenderer,paragraph:e=>r.createElement("div",{className:"beatmap-discussion-review-post__block"},r.createElement("div",Object.assign({className:"beatmapset-discussion-message"},e))),timestamp:e=>r.createElement("a",Object.assign({className:"beatmap-discussion-timestamp-decoration"},e))},source:e,unwrapDisallowed:!0})}render(){const e=[];try{JSON.parse(this.props.message).forEach(t=>{switch(t.type){case"paragraph":{const s=""===t.text.trim()?"&nbsp;":t.text;e.push(this.paragraph(s));break}case"embed":t.discussion_id&&e.push(this.embed(t.discussion_id))}})}catch(t){e.push(r.createElement("div",{key:osu.uuid()},"[error parsing review]"))}return r.createElement("div",{className:"beatmap-discussion-review-post"},e)}}},XMjx:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("SifC"),i=s("GhGe"),n=s("Cy5r");function o(e,t){let s;try{s=JSON.parse(e)}catch(c){return console.error("error parsing srcDoc"),[]}const o=i().use(r).use(n.a,{allowedBlocks:["paragraph"],allowedInlines:["emphasis","strong"]}),l=[];return s.forEach(e=>{switch(e.type){case"paragraph":if(osu.present(e.text.trim())){const t=o.parse(e.text);if(!t.children||t.children.length<1){console.error("children missing... ?");break}l.push({children:a(t.children),type:"paragraph"})}else l.push({children:[{text:""}],type:"paragraph"});break;case"embed":{const s=e,r=t[s.discussion_id];if(null==r){console.error("unknown/external discussion referenced",s.discussion_id);break}l.push({beatmapId:r.beatmap_id,children:[{text:(r.starting_post||r.posts[0]).message}],discussionId:r.id,discussionType:r.message_type,timestamp:BeatmapDiscussionHelper.formatTimestamp(r.timestamp),type:"embed"});break}default:console.error("unknown block encountered",e)}}),l}function a(e,t){let s=[];const r=null!=t?t:{bold:!1,italic:!1};return e?(e.forEach(e=>{const t={bold:r.bold||"strong"===e.type,italic:r.italic||"emphasis"===e.type};if(Array.isArray(e.children))s=s.concat(a(e.children,t));else{const r={text:e.value||""};t.bold&&(r.bold=!0),t.italic&&(r.italic=!0),s.push(r)}}),s):[{text:""}]}},XPyy:function(e,t,s){"use strict";s.d(t,"b",(function(){return P})),s.d(t,"a",(function(){return k}));var r=s("7nlf"),i=s("VbpL"),n=s("jEEn"),o=s("L2k0"),a=s("0h6b"),l=s("Hs9Z"),c=s("f4vq"),u=s("C92G"),d=s("/G9H"),p=s("hc33"),m=s("PPOh"),h=s("mk7q"),b=s("VefT"),f=s("peKF"),v=s("lv9K"),g=s("KUml"),y=s("oQBk"),_=s("tX/w"),w=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let O=class extends d.Component{constructor(e){super(e),Object(v.p)(this)}get friendModifier(){var e;if(null==(null===(e=c.a.currentUser)||void 0===e?void 0:e.friends))return;const t=c.a.currentUser.friends.find(e=>e.target_id===this.props.user.id);if(null!=t){if(t.mutual)return"mutual";if(!this.context.isFriendsPage)return"friend"}}render(){var e,t,s;const r=Object(_.a)("user-card-brick",this.props.modifiers,this.props.mode,this.friendModifier);return d.createElement("a",{className:`js-usercard ${r}`,"data-user-id":this.props.user.id,href:Object(a.route)("users.show",{user:this.props.user.id})},d.createElement("div",{className:"user-card-brick__group-bar",style:osu.groupColour(null===(e=this.props.user.groups)||void 0===e?void 0:e[0]),title:null===(s=null===(t=this.props.user.groups)||void 0===t?void 0:t[0])||void 0===s?void 0:s.name}),d.createElement("div",{className:"user-card-brick__username u-ellipsis-overflow"},this.props.user.username))}};Object.defineProperty(O,"contextType",{enumerable:!0,configurable:!0,writable:!0,value:y.a}),Object.defineProperty(O,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{mode:"brick"}}),w([v.h],O.prototype,"friendModifier",null);var j=O=w([g.b],O),E=s("AJEZ");const P=["card","list","brick"];class k extends d.PureComponent{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:{avatarLoaded:!1,backgroundLoaded:!1}}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onAvatarLoad",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.setState({avatarLoaded:!0})}}),Object.defineProperty(this,"onBackgroundLoad",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.setState({backgroundLoaded:!0})}})}get canMessage(){var e,t;return!this.isSelf&&null==l.find(null!==(t=null===(e=c.a.currentUser)||void 0===e?void 0:e.blocks)&&void 0!==t?t:[],{target_id:this.user.id})}get isOnline(){return this.user.is_online}get isSelf(){return null!=c.a.currentUser&&c.a.currentUser.id===this.user.id}get isUserLoaded(){return Number.isFinite(this.user.id)&&this.user.id>0}get isUserNotFound(){return-1===this.user.id}get isUserVisible(){return this.isUserLoaded&&!this.user.is_deleted}get user(){return this.props.user||k.userLoading}render(){if("brick"===this.props.mode)return null==this.props.user?null:d.createElement(j,Object.assign({},this.props,{user:this.props.user}));const e=this.props.modifiers.slice();return e.push(this.props.activated?"active":"highlightable"),e.push(this.props.mode),this.url=this.isUserVisible?Object(a.route)("users.show",{user:this.user.id}):void 0,d.createElement("div",{className:Object(_.a)("user-card",e)},this.renderBackground(),d.createElement("div",{className:"user-card__card"},d.createElement("div",{className:"user-card__content user-card__content--details"},d.createElement("div",{className:"user-card__user"},this.renderAvatar()),d.createElement("div",{className:"user-card__details"},this.renderIcons(),d.createElement("div",{className:"user-card__username-row"},this.renderUsername(),d.createElement("div",{className:"user-card__group-badges"},d.createElement(E.a,{groups:this.user.groups,short:!0,wrapper:"user-card__group-badge"}))),this.renderListModeIcons())),this.renderStatusBar()))}renderAvatar(){const e={loaded:this.state.avatarLoaded},t=osu.present(this.user.avatar_url)&&!this.isUserNotFound;return d.createElement("div",{className:"user-card__avatar-space"},d.createElement("div",{className:Object(_.a)("user-card__avatar-spinner",e)},t&&d.createElement(m.a,{modifiers:e})),this.isUserLoaded&&t&&d.createElement("img",{className:Object(_.a)("user-card__avatar",e),onError:this.onAvatarLoad,onLoad:this.onAvatarLoad,src:this.user.avatar_url}))}renderBackground(){let e,t;const s=Object(_.a)("user-card__background-overlay",this.isOnline?["online"]:[]);if(this.user.cover&&this.user.cover.url){let t="user-card__background";this.state.backgroundLoaded||(t+=" user-card__background--loading"),e=d.createElement(d.Fragment,null,d.createElement("img",{className:t,onLoad:this.onBackgroundLoad,src:this.user.cover.url}),d.createElement("div",{className:s}))}else e=d.createElement("div",{className:s});return t=this.isUserVisible?d.createElement("a",{className:"user-card__background-container",href:this.url},e):e}renderIcons(){return this.isUserVisible?d.createElement("div",{className:"user-card__icons user-card__icons--card"},d.createElement("a",{className:"user-card__icon user-card__icon--flag",href:Object(a.route)("rankings",{country:this.user.country_code,mode:"osu",type:"performance"})},d.createElement(n.a,{country:this.user.country})),"card"===this.props.mode&&d.createElement(d.Fragment,null,this.user.is_supporter&&d.createElement("a",{className:"user-card__icon",href:Object(a.route)("support-the-game")},d.createElement(b.a,{modifiers:["user-card"]})),d.createElement("div",{className:"user-card__icon"},d.createElement(i.a,{modifiers:"user-card",userId:this.user.id})),!this.user.is_bot&&d.createElement("div",{className:"user-card__icon"},d.createElement(o.a,{modifiers:["user-card"],userId:this.user.id})))):null}renderListModeIcons(){return"list"===this.props.mode&&this.isUserVisible?d.createElement("div",{className:"user-card__icons"},this.user.is_supporter&&d.createElement("a",{className:"user-card__icon",href:Object(a.route)("support-the-game")},d.createElement(b.a,{level:this.user.support_level,modifiers:["user-list"]})),d.createElement("div",{className:"user-card__icon"},d.createElement(i.a,{modifiers:"user-list",userId:this.user.id})),!this.user.is_bot&&d.createElement("div",{className:"user-card__icon"},d.createElement(o.a,{modifiers:["user-list"],userId:this.user.id}))):null}renderMenuButton(){if(this.isSelf)return null;return d.createElement("div",{className:"user-card__icon user-card__icon--menu"},d.createElement(u.a,null,e=>d.createElement("div",{className:"simple-menu"},this.canMessage&&d.createElement("a",{className:"simple-menu__item js-login-required--click",href:Object(a.route)("messages.users.show",{user:this.user.id}),onClick:e},d.createElement("span",{className:"fas fa-envelope"}),` ${osu.trans("users.card.send_message")}`),d.createElement(r.a,{modifiers:"inline",onClick:e,userId:this.user.id,wrapperClass:"simple-menu__item"}),d.createElement(p.a,{className:"simple-menu__item",icon:!0,onFormClose:e,reportableId:this.user.id.toString(),reportableType:"user",user:this.user}))))}renderStatusBar(){if(!this.isUserVisible)return null;const e=this.isOnline?osu.trans("users.status.online"):osu.trans("users.status.offline");return d.createElement("div",{className:"user-card__content user-card__content--status"},d.createElement("div",{className:"user-card__status"},this.renderStatusIcon(),d.createElement("div",{className:"user-card__status-messages"},d.createElement("span",{className:"user-card__status-message user-card__status-message--sub u-ellipsis-overflow"},!this.isOnline&&null!=this.user.last_visit&&d.createElement(h.a,{mappings:{date:d.createElement(f.a,{dateTime:this.user.last_visit,relative:!0})},pattern:osu.trans("users.show.lastvisit")})),d.createElement("span",{className:"user-card__status-message u-ellipsis-overflow"},e))),d.createElement("div",{className:"user-card__icons user-card__icons--menu"},this.renderMenuButton()))}renderStatusIcon(){return this.isUserVisible?d.createElement("div",{className:"user-card__status-icon-container"},d.createElement("div",{className:`user-card__status-icon user-card__status-icon--${this.isOnline?"online":"offline"}`})):null}renderUsername(){const e=this.user.is_deleted?osu.trans("users.deleted"):this.user.username;return null==this.url?d.createElement("div",{className:"user-card__username u-ellipsis-pre-overflow"},e):d.createElement("a",{className:"user-card__username u-ellipsis-pre-overflow",href:this.url},e)}}Object.defineProperty(k,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{activated:!1,mode:"card",modifiers:[]}}),Object.defineProperty(k,"userLoading",{enumerable:!0,configurable:!0,writable:!0,value:{avatar_url:"",country_code:"",cover:{custom_url:null,id:null,url:null},default_group:"",id:0,is_active:!1,is_bot:!1,is_deleted:!1,is_online:!1,is_supporter:!1,last_visit:"",pm_friends_only:!0,profile_colour:"",username:osu.trans("users.card.loading")}})},XvDi:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));class r{constructor(e){Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:e})}}},Y9Pv:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("/G9H");const i=r.createContext({})},Yin1:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));s("/G9H");var r,i=s("I8Ok");r="beatmap-discussion-message-length-counter";var n=function(e){var t,s,n;return n=e.message,e.isTimeline?(s=BeatmapDiscussionHelper.MAX_LENGTH_TIMELINE,t=r,n.length>s?t+=" "+r+"--over":n.length>.95*s&&(t+=" "+r+"--almost-over"),Object(i.div)({className:t},n.length+" / "+s)):null}},YvoO:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return o}));var r=s("bpgk"),i=s("WLnA"),n=s("0h6b");class o{constructor(){Object.defineProperty(this,"handleUserLogin",{enumerable:!0,configurable:!0,writable:!0,value:()=>{Object(i.a)(new r.a)}}),Object.defineProperty(this,"handleUserLogout",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=!!e.currentTarget.dataset.redirectHome;this.logout(t)}}),e(document).on("ajax:success",".js-logout-link",this.handleUserLogout).on("ajax:success",".js-login-form",this.handleUserLogin)}logout(e=!1){localStorage.clear(),e?location.href=Object(n.route)("home"):location.reload()}}}).call(this,s("5wds"))},ZG74:function(e,t,s){"use strict";s.d(t,"c",(function(){return i})),s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return o}));var r=s("/G9H");function i(e){this.setState({activeKey:e})}const n=Object(r.createContext)({activeKeyDidChange:e=>{}}),o=Object(r.createContext)(null)},ZJc0:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("/G9H"),i=s("tX/w");class n extends r.PureComponent{constructor(){super(...arguments),Object.defineProperty(this,"bn",{enumerable:!0,configurable:!0,writable:!0,value:"circular-progress"})}render(){const e=this.bn,t=Math.min(1,this.props.current/this.props.max);if(this.props.onlyShowAsWarning&&t<.75)return null;const s=this.props.ignoreProgress?void 0:{transform:`rotate(${t}turn)`};return r.createElement("div",{className:Object(i.a)(e,{over:1===t,over50:t>.5,warn:t>=.75&&t<1,[this.props.theme]:osu.present(this.props.theme)}),title:this.props.tooltip||`${this.props.current} / ${this.props.max}`},r.createElement("div",{className:`${e}__label`},this.props.max-this.props.current),r.createElement("div",{className:`${e}__slice`},r.createElement("div",{className:`${e}__circle`,style:s}),r.createElement("div",{className:`${e}__circle ${e}__circle--fill`})))}}Object.defineProperty(n,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{ignoreProgress:!1,onlyShowAsWarning:!1,theme:""}})},aMFG:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));class r{constructor(){Object.defineProperty(this,"sitekey",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"triggered",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:()=>document.querySelector(".js-captcha--container")}),Object.defineProperty(this,"disableSubmit",{enumerable:!0,configurable:!0,writable:!0,value:()=>{const e=this.submitButton();e&&(e.disabled=!0)}}),Object.defineProperty(this,"enableSubmit",{enumerable:!0,configurable:!0,writable:!0,value:()=>{const e=this.submitButton();e&&(e.disabled=!1)}}),Object.defineProperty(this,"init",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{this.sitekey=e,this.triggered=t,this.render()}}),Object.defineProperty(this,"isEnabled",{enumerable:!0,configurable:!0,writable:!0,value:()=>this.container()&&"object"==typeof grecaptcha&&"function"==typeof grecaptcha.render&&""!==this.sitekey&&this.triggered}),Object.defineProperty(this,"isLoaded",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var e;return""!==(null===(e=this.container())||void 0===e?void 0:e.innerHTML)}}),Object.defineProperty(this,"render",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.isEnabled()&&!this.isLoaded()&&(grecaptcha.render(this.container(),{callback:this.enableSubmit,"error-callback":this.disableSubmit,"expired-callback":this.disableSubmit,sitekey:this.sitekey,theme:"dark"}),this.disableSubmit())}}),Object.defineProperty(this,"reset",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.isEnabled()&&(grecaptcha.reset(),this.disableSubmit())}}),Object.defineProperty(this,"submitButton",{enumerable:!0,configurable:!0,writable:!0,value:()=>document.querySelector(".js-captcha--submit-button")}),Object.defineProperty(this,"trigger",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.triggered||(this.triggered=!0,this.render())}}),Object.defineProperty(this,"untrigger",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.isEnabled()&&(this.triggered=!1,this.container().innerHTML="",this.enableSubmit())}}),e(document).on("turbolinks:load",this.render)}}}).call(this,s("5wds"))},bPNN:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return o}));var r=s("fqdx"),i=s("f4vq"),n=s("phBA");class o{constructor(t){Object.defineProperty(this,"captcha",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"callback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"show",{enumerable:!0,configurable:!0,writable:!0,value:t=>{this.callback=t,window.setTimeout(()=>{var t;e(document).trigger("gallery:close"),null===(t=e(".js-user-login--menu")[0])||void 0===t||t.click()},0)}}),Object.defineProperty(this,"showIfGuest",{enumerable:!0,configurable:!0,writable:!0,value:e=>null==i.a.currentUser&&(this.show(e),!0)}),Object.defineProperty(this,"showOnError",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{var s;return 401===e.status&&"basic"===(null===(s=e.responseJSON)||void 0===s?void 0:s.authentication)&&(null!=i.a.currentUser?osu.reloadPage():this.show(t),!0)}}),Object.defineProperty(this,"clearError",{enumerable:!0,configurable:!0,writable:!0,value:()=>{e(".js-login-form--error").text("")}}),Object.defineProperty(this,"loginError",{enumerable:!0,configurable:!0,writable:!0,value:(t,s)=>{t.preventDefault(),t.stopPropagation(),e(".js-login-form--error").text(osu.xhrErrorMessage(s)),window.setTimeout(()=>{var e;(null===(e=null==s?void 0:s.responseJSON)||void 0===e?void 0:e.captcha_triggered)&&this.captcha.trigger(),this.captcha.reset()},0)}}),Object.defineProperty(this,"loginSuccess",{enumerable:!0,configurable:!0,writable:!0,value:(t,s)=>{const r=this.callback;this.reset(),this.refreshToken(),e.publish("user:update",s.user),window.setTimeout(()=>{var t;null===(t=e(".js-user-login--menu")[0])||void 0===t||t.click(),e(".js-user-header").replaceWith(s.header),e(".js-user-header-popup").html(s.header_popup),this.captcha.untrigger(),(null!=r?r:osu.reloadPage)()},0)}}),Object.defineProperty(this,"onError",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{this.showOnError(t,Object(n.c)(e.target))}}),Object.defineProperty(this,"refreshToken",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var t;const s=null!==(t=r.get("XSRF-TOKEN"))&&void 0!==t?t:null;e('[name="_token"]').attr("value",s),e('[name="csrf-token"]').attr("content",s)}}),Object.defineProperty(this,"reset",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.callback=void 0}}),Object.defineProperty(this,"showOnClick",{enumerable:!0,configurable:!0,writable:!0,value:e=>{e.preventDefault(),this.show()}}),Object.defineProperty(this,"showOnLoad",{enumerable:!0,configurable:!0,writable:!0,value:()=>{window.showLoginModal&&(window.showLoginModal=void 0,this.show())}}),Object.defineProperty(this,"showToContinue",{enumerable:!0,configurable:!0,writable:!0,value:e=>{if(null!=i.a.currentUser)return;e.preventDefault();const t=Object(n.c)(e.target);window.setTimeout(()=>{this.show(t)},0)}}),e(document).on("ajax:success",".js-login-form",this.loginSuccess).on("ajax:error",".js-login-form",this.loginError).on("submit",".js-login-form",this.clearError).on("input",".js-login-form-input",this.clearError).on("click",".js-user-link",this.showOnClick).on("click",".js-login-required--click",this.showToContinue).on("ajax:before",".js-login-required--click",()=>null!=i.a.currentUser).on("ajax:error",this.onError).on("turbolinks:load",this.showOnLoad),e.subscribe("nav:popup:hidden",this.reset)}}}).call(this,s("5wds"))},bSvc:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));var r=s("lv9K");class i{constructor(){Object.defineProperty(this,"hasFocus",{enumerable:!0,configurable:!0,writable:!0,value:document.hasFocus()}),Object(r.p)(this),e(window).on("blur focus",Object(r.f)(()=>this.hasFocus=document.hasFocus()))}}(function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);n>3&&o&&Object.defineProperty(t,s,o)})([r.q],i.prototype,"hasFocus",void 0)}).call(this,s("5wds"))},bTQa:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("/G9H"),i=s("q7/B");function n({userAchievements:e}){return r.createElement(i.a,{label:osu.trans("users.show.stats.medals"),modifiers:"medals",value:e.length})}},"bfq+":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return l})),s.d(t,"c",(function(){return c})),s.d(t,"d",(function(){return u})),s.d(t,"e",(function(){return d})),s.d(t,"f",(function(){return p})),s.d(t,"g",(function(){return m}));var r=s("0h6b"),i=s("lv9K"),n=s("d+cC"),o=s("f4vq");function a(t,s){return e.post(Object(r.route)("chat.ack"),{history_since:s,since:t})}function l(t,s){return e.get(Object(r.route)("chat.channels.messages.index",Object.assign({channel:t,return_object:1},s))).then(Object(i.f)(e=>(o.a.dataStore.userStore.updateWithJson(e.users),e.messages.map(e=>n.a.fromJson(e)))))}function c(t,s){return e.get(Object(r.route)("chat.updates"),{history_since:s,includes:["presence","silences"],since:t})}function u(t,s){return e.ajax({type:"PUT",url:Object(r.route)("chat.channels.mark-as-read",{channel:t,message:s})})}function d(t,s){return e.post(Object(r.route)("chat.new"),{is_action:s.isAction,message:s.content,target_id:t,uuid:s.uuid})}function p(t,s){return e.ajax(Object(r.route)("chat.channels.part",{channel:t,user:s}),{method:"DELETE"})}function m(t){return e.post(Object(r.route)("chat.channels.messages.store",{channel:t.channelId}),{is_action:t.isAction,message:t.content,target_id:t.channelId,target_type:"channel",uuid:t.uuid})}}).call(this,s("5wds"))},bpgk:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));class r{}},cX0L:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));let r=0;function i(){return++r}},"d+cC":function(e,t,s){"use strict";s.d(t,"a",(function(){return u}));var r=s("Hs9Z"),i=s("lv9K"),n=s("srn7"),o=s("7EfK"),a=s("f4vq"),l=s("vZz4"),c=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class u{constructor(){Object.defineProperty(this,"channelId",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"errored",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isAction",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"messageId",{enumerable:!0,configurable:!0,writable:!0,value:osu.uuid()}),Object.defineProperty(this,"persisted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"senderId",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"timestamp",{enumerable:!0,configurable:!0,writable:!0,value:o().toISOString()}),Object.defineProperty(this,"uuid",{enumerable:!0,configurable:!0,writable:!0,value:this.messageId}),Object(i.p)(this)}get parsedContent(){return Object(l.g)(Object(r.escape)(this.content),!0)}get sender(){var e;return null!==(e=a.a.dataStore.userStore.get(this.senderId))&&void 0!==e?e:new n.a(-1)}static fromJson(e){var t;const s=new u;return Object.assign(s,{channelId:e.channel_id,content:e.content,isAction:e.is_action,messageId:e.message_id,persisted:!0,senderId:e.sender_id,timestamp:e.timestamp,uuid:null!==(t=e.uuid)&&void 0!==t?t:s.uuid})}persist(e){this.persisted||(this.messageId=e.message_id,this.timestamp=e.timestamp,this.persisted=!0)}}c([i.q],u.prototype,"channelId",void 0),c([i.q],u.prototype,"content",void 0),c([i.q],u.prototype,"errored",void 0),c([i.q],u.prototype,"isAction",void 0),c([i.q],u.prototype,"messageId",void 0),c([i.q],u.prototype,"persisted",void 0),c([i.q],u.prototype,"senderId",void 0),c([i.q],u.prototype,"timestamp",void 0),c([i.q],u.prototype,"uuid",void 0),c([i.h],u.prototype,"parsedContent",null),c([i.h],u.prototype,"sender",null),c([i.f],u.prototype,"persist",null)},dC65:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));class r{constructor(){Object.defineProperty(this,"createTooltip",{enumerable:!0,configurable:!0,writable:!0,value:(t,s)=>{e(t).qtip({content:{text:s},hide:{delay:200,effect(){e(this).fadeTo(110,0)},fixed:!0},position:{at:"top center",my:"bottom center",viewport:e(window)},show:{delay:200,effect(){e(this).fadeTo(110,1)},ready:!0},style:{classes:"tooltip-default tooltip-default--interactable"}})}}),Object.defineProperty(this,"showTooltip",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t;if(!(e.currentTarget instanceof HTMLAnchorElement))return;const s=e.currentTarget,r=s.getAttribute("href");if(null==r)return;const i=null===(t=document.querySelector(r))||void 0===t?void 0:t.firstElementChild;if(!(i instanceof HTMLParagraphElement))return;const n=document.createElement("div");n.insertAdjacentHTML("afterbegin",i.innerHTML),n.querySelectorAll("*").forEach(e=>{"doc-backlink"===e.getAttribute("role")?e.remove():e.removeAttribute("class")}),this.createTooltip(s,n)}}),e(document).on("mouseover",".js-reference-link",this.showTooltip)}}}).call(this,s("5wds"))},dMN7:function(e,t,s){"use strict";function r(e){return null!=e.accuracy}s.d(t,"a",(function(){return r}))},dqUM:function(e,t,s){"use strict";(function(e,r){s.d(t,"a",(function(){return d}));var i,n,o=s("/G9H"),a=s("I8Ok"),l=s("cX0L"),c=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty;o.createElement,i="notification-banner-v2",n=document.getElementsByClassName("js-notification-banners");var d=function(t){function s(e){this.createPortalContainer=c(this.createPortalContainer,this),this.removePortalContainer=c(this.removePortalContainer,this),this.render=c(this.render,this),this.componentWillUnmount=c(this.componentWillUnmount,this),this.componentDidMount=c(this.componentDidMount,this),s.__super__.constructor.call(this,e),this.eventId="notification-banner-"+Object(l.a)(),this.createPortalContainer()}return function(e,t){for(var s in t)u.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.prototype.componentDidMount=function(){return e(document).on("turbolinks:before-cache."+this.eventId,this.removePortalContainer)},s.prototype.componentWillUnmount=function(){return e(document).off("."+this.eventId),this.removePortalContainer()},s.prototype.render=function(){var e;return e=Object(a.div)({className:i+" "+i+"--"+this.props.type},Object(a.div)({className:i+"__col "+i+"__col--icon"}),Object(a.div)({className:i+"__col "+i+"__col--label"},Object(a.div)({className:i+"__type"},this.props.type),Object(a.div)({className:i+"__text"},this.props.title)),Object(a.div)({className:i+"__col"},Object(a.div)({className:i+"__text"},this.props.message))),r.createPortal(e,this.portalContainer)},s.prototype.removePortalContainer=function(){return this.portalContainer.remove()},s.prototype.createPortalContainer=function(){return this.portalContainer=document.createElement("div"),n[0].appendChild(this.portalContainer)},s}(o.PureComponent)}).call(this,s("5wds"),s("WKXC"))},eIGF:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));class r{constructor(){Object.defineProperty(this,"switchEdit",{enumerable:!0,configurable:!0,writable:!0,value:t=>{const s=e(t.target).parents(".js-forum-poll--container");if("1"===s.attr("data-edit")){s.attr("data-edit","0");const r=e(t.target).closest("form")[0];null!=r&&r.reset()}else s.attr("data-edit","1")}}),Object.defineProperty(this,"switchPage",{enumerable:!0,configurable:!0,writable:!0,value:t=>{const s=t.currentTarget;if(!(s instanceof HTMLElement))return;const r=s.dataset.targetPage;"string"==typeof r&&e(t.target).parents(".js-forum-poll--container").attr("data-page",r)}}),e(document).on("click",".js-forum-poll--switch-page",this.switchPage).on("click",".js-forum-poll--switch-edit",this.switchEdit)}}}).call(this,s("5wds"))},ed4P:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var r=s("/G9H"),i=s("ZG74"),n=s("XPyy"),o=s("tX/w");class a extends r.PureComponent{constructor(){super(...arguments),Object.defineProperty(this,"activeKeyDidChange",{enumerable:!0,configurable:!0,writable:!0,value:i.c.bind(this)}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:{}})}render(){const e=null!=this.state.activeKey?["menu-active"]:[];return e.push(this.props.viewMode),r.createElement(i.a.Provider,{value:{activeKeyDidChange:this.activeKeyDidChange}},r.createElement("div",{className:Object(o.a)("user-cards",e)},this.props.users.map(e=>{const t=this.state.activeKey===e.id;return r.createElement(i.b.Provider,{key:e.id,value:e.id},r.createElement(n.a,{activated:t,mode:this.props.viewMode,modifiers:["has-outline",...this.props.modifiers],user:e}))})))}}Object.defineProperty(a,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{modifiers:[]}})},eiXn:function(e,t,s){"use strict";s.d(t,"b",(function(){return u})),s.d(t,"c",(function(){return d})),s.d(t,"a",(function(){return h}));var r=s("kUxX"),i=s("Hs9Z"),n=s("f4vq"),o=s("tX/w"),a=s("/DQ7");const l="line-chart";function c(e){return e.toString()}function u(e){var t;return Object.assign(Object.assign({},p(e)),{scaleX:null!==(t=e.scaleX)&&void 0!==t?t:Object(r.scaleTime)()})}function d(e){var t;return Object.assign(Object.assign({},p(e)),{scaleX:null!==(t=e.scaleX)&&void 0!==t?t:Object(r.scaleLinear)()})}function p(e){var t,s,i,n,o,a,l,u,d,p,m,h,b,f;return{axisLabels:null===(t=e.axisLabels)||void 0===t||t,circleLine:null!==(s=e.circleLine)&&void 0!==s&&s,curve:null!==(i=e.curve)&&void 0!==i?i:r.curveMonotoneX,formatX:null!==(n=e.formatX)&&void 0!==n?n:c,formatY:null!==(o=e.formatY)&&void 0!==o?o:c,infoBoxFormatX:null!==(l=null!==(a=e.infoBoxFormatX)&&void 0!==a?a:e.formatX)&&void 0!==l?l:c,infoBoxFormatY:null!==(d=null!==(u=e.infoBoxFormatY)&&void 0!==u?u:e.formatY)&&void 0!==d?d:c,marginBottom:null!==(p=e.marginBottom)&&void 0!==p?p:50,marginLeft:null!==(m=e.marginLeft)&&void 0!==m?m:60,marginRight:null!==(h=e.marginRight)&&void 0!==h?h:20,marginTop:null!==(b=e.marginTop)&&void 0!==b?b:20,modifiers:e.modifiers,scaleY:null!==(f=e.scaleY)&&void 0!==f?f:Object(r.scaleLinear)(),ticksX:e.ticksX,tickValuesX:e.tickValuesX}}const m=10;class h{constructor(e,t){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"area",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoEndHoverTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"axes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"hover",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hoverArea",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hoverCircle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hoverInfoBox",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hoverInfoBoxX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hoverInfoBoxY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hoverLine",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"line",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"svg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"svgLine",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"svgWrapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"resize",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.setDimensions()&&(this.setScalesRange(),this.setSvgSize(),this.setWrapperSize(),this.setAxesSize(),this.setLineSize(),this.drawAxes(),this.drawLine(),this.hoverReset())}}),Object.defineProperty(this,"hoverEnd",{enumerable:!0,configurable:!0,writable:!0,value:()=>{Object(a.b)(this.hover.node())}}),Object.defineProperty(this,"hoverStart",{enumerable:!0,configurable:!0,writable:!0,value:()=>{Object(a.a)(this.hover.node())}}),Object.defineProperty(this,"onHover",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t,s;const o=Object(r.pointer)(e)[0]-m,a=this.options.scaleX.invert(o),l=Object(i.clamp)(this.lookupIndexFromX(a),1,this.data.length-1);this.hoverStart(),window.clearTimeout(this.autoEndHoverTimeout),n.a.windowSize.isMobile&&(this.autoEndHoverTimeout=window.setTimeout(this.hoverEnd,3e3));const c=a.valueOf()-this.data[l-1].x.valueOf()<=this.data[l].x.valueOf()-a.valueOf()?this.data[l-1]:this.data[l],u=[`${Math.round(this.options.scaleX(c.x))}px`,`${Math.round(this.options.scaleY(c.y))}px`];null===(t=this.hoverLine)||void 0===t||t.style("transform",`translateX(${u[0]})`),this.hoverCircle.style("transform",`translate(${u.join(",")})`),this.hoverInfoBoxX.html(this.options.infoBoxFormatX(c.x)),this.hoverInfoBoxY.html(this.options.infoBoxFormatY(c.y));const d=e.clientX,p=null===(s=this.hoverInfoBox.node())||void 0===s?void 0:s.getBoundingClientRect();null!=p&&("right"===this.hoverInfoBox.attr("data-float")?d>p.left&&this.hoverInfoBox.attr("data-float","left"):d<p.right&&this.hoverInfoBox.attr("data-float","right"))}}),this.area=Object(r.select)(e).classed(Object(o.a)(l,this.options.modifiers),!0),this.svg=this.area.append("svg"),this.svgWrapper=this.svg.append("g").classed(`${l}__wrapper`,!0),this.options.axisLabels&&(this.axes={svgX:this.svgWrapper.append("g").classed(`${l}__axis ${l}__axis--x`,!0),svgY:this.svgWrapper.append("g").classed(`${l}__axis ${l}__axis--y`,!0),x:Object(r.axisBottom)(this.options.scaleX).tickSizeOuter(0).tickPadding(5),y:Object(r.axisLeft)(this.options.scaleY).ticks(4)}),this.svgLine=this.svgWrapper.append("path").classed(`${l}__line`,!0),this.hoverArea=this.area.append("div").classed(`${l}__hover-area`,!0).style("top",`${this.options.marginTop}px`).style("bottom",`${this.options.marginBottom}px`).style("left",`${this.options.marginLeft-m}px`).style("right",`${this.options.marginRight-m}px`).style("padding",`0 ${m}px`).on("mouseout",this.hoverEnd).on("mousemove",this.onHover).on("drag",this.onHover),this.hover=this.hoverArea.append("div").classed(`${l}__hover`,!0).attr("data-visibility","hidden"),this.options.circleLine&&(this.hoverLine=this.hover.append("div").classed(`${l}__hover-line`,!0)),this.hoverCircle=this.hover.append("div").classed(`${l}__hover-circle`,!0),this.hoverInfoBox=this.hover.append("div").classed(`${l}__hover-info-box`,!0).attr("data-float","left"),this.hoverInfoBoxX=this.hoverInfoBox.append("div").classed(`${l}__hover-info-box-text ${l}__hover-info-box-text--x`,!0),this.hoverInfoBoxY=this.hoverInfoBox.append("div").classed(`${l}__hover-info-box-text ${l}__hover-info-box-text--y`,!0),this.line=Object(r.line)().curve(this.options.curve)}loadData(e){this.data=e,this.svgLine.datum(e),this.resize()}drawAxes(){null!=this.axes&&(this.axes.svgX.transition().attr("transform",`translate(0, ${this.height})`).call(this.axes.x),this.axes.svgY.transition().call(this.axes.y),this.axes.svgX.selectAll(".tick line").classed(`${l}__tick-line ${l}__tick-line--default`,!0),this.axes.svgY.selectAll(".tick line").classed(`${l}__tick-line ${l}__tick-line--default`,!0),this.axes.svgX.selectAll(".domain").classed("u-hidden",!0),this.axes.svgY.selectAll(".domain").classed("u-hidden",!0),this.axes.svgX.selectAll("text").style("text-anchor","start").attr("transform","rotate(45) translate(5, 0)").classed(`${l}__tick-text ${l}__tick-text--strong`,!0),this.axes.svgY.selectAll("text").classed(`${l}__tick-text`,!0))}drawLine(){this.svgLine.transition().attr("d",this.line)}hoverReset(){this.hoverStyle("transition","none"),this.hoverEnd(),this.hoverStyle("transform",""),window.setTimeout(()=>{this.hoverStyle("transition","")})}hoverStyle(e,t){for(const s of[this.hoverLine,this.hoverCircle])null==s||s.style(e,t)}lookupIndexFromX(e){return Object(r.bisector)(e=>e.x).left(this.data,e)}setAxesSize(){var e;null!=this.axes&&(this.axes.x.scale(this.options.scaleX).tickSizeInner(-this.height).ticks(null!==(e=this.options.ticksX)&&void 0!==e?e:15).tickFormat(this.options.formatX),null==this.options.tickValuesX?this.axes.x.tickValues(null):this.axes.x.tickValues(this.options.tickValuesX),this.axes.y.scale(this.options.scaleY).tickSizeInner(-this.width).tickFormat(this.options.formatY))}setDimensions(){var e;const t=null===(e=this.area.node())||void 0===e?void 0:e.getBoundingClientRect();return null!=t&&0!==t.width&&0!==t.height&&(this.width=t.width-(this.options.marginLeft+this.options.marginRight),this.height=t.height-(this.options.marginTop+this.options.marginBottom),!0)}setLineSize(){this.line.x(e=>this.options.scaleX(e.x)).y(e=>this.options.scaleY(e.y))}setScalesRange(){this.options.scaleX.range([0,this.width]);const[e,t]=Object(r.extent)(this.data.map(e=>e.x));null!=e&&null!=t&&this.options.scaleX.domain([e,t]),this.options.scaleY.range([this.height,0]);const[s,i]=Object(r.extent)(this.data.map(e=>e.y));null!=s&&null!=i&&this.options.scaleY.domain([s,i])}setSvgSize(){this.svg.attr("width",this.width+(this.options.marginLeft+this.options.marginRight)).attr("height",this.height+(this.options.marginTop+this.options.marginBottom))}setWrapperSize(){this.svgWrapper.attr("transform",`translate(${this.options.marginLeft}, ${this.options.marginTop})`)}}},elBb:function(e,t,s){"use strict";function r(e){return null!=e?JSON.parse(JSON.stringify(e)):e}function i(e){const t=n(e);if(null==t)throw new Error(`script element ${e} is missing or contains nullish value.`);return t}function n(e,t=!1){var s;const r=null===(s=window.newBody)||void 0===s?void 0:s.querySelector(`#${e}`);if(!(r instanceof HTMLScriptElement))return;const i=JSON.parse(r.text);return t&&r.remove(),i}function o(e,t){const s=JSON.stringify(t),r=document.getElementById(e);let i;if(null==r)(i=document.createElement("script")).id=e,i.type="application/json",document.body.appendChild(i);else{if(!(r instanceof HTMLScriptElement))throw new Error(`existing ${e} is not a script element.`);i=r}i.text=s}s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return n})),s.d(t,"d",(function(){return o}))},f4vq:function(e,t,s){"use strict";const r=new(s("BSzr").a);window.osuCore=r,t.a=r},f60u:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("/G9H"),i=s("tX/w");function n(e){let t=Object(i.a)("mod",e.modifiers);return t+=` mod--${e.mod}`,r.createElement("div",{className:t,title:osu.trans(`beatmaps.mods.${e.mod}`)})}},f7bm:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return o}));var r=s("iBbO"),i=s("/G9H");const n="click-to-copy";class o extends i.Component{constructor(){super(...arguments),Object.defineProperty(this,"api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"title",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"click",{enumerable:!0,configurable:!0,writable:!0,value:t=>{t.preventDefault();const s=t.currentTarget;null==this.api&&(this.api=e(s).qtip("api")),r.writeText(this.props.value),this.api.set("content.text",osu.trans("common.buttons.click_to_copy_copied")),window.clearTimeout(this.timer),this.timer=window.setTimeout(this.restoreTooltipText,1e3),null==this.title&&(this.title=s.getAttribute("title")||s.dataset.origTitle||null)}}),Object.defineProperty(this,"restoreTooltipText",{enumerable:!0,configurable:!0,writable:!0,value:()=>{null!=this.title&&(this.api.hide(),window.setTimeout(()=>{this.api.set("content.text",this.title)},100))}})}componentWillMount(){this.restoreTooltipText()}render(){return this.props.value?i.createElement("a",{className:n,"data-tooltip-hide-events":"mouseleave","data-tooltip-pin-position":!0,"data-tooltip-position":"bottom center",href:this.props.valueAsUrl?this.props.value:"#",onClick:this.click,title:osu.trans("common.buttons.click_to_copy")},this.props.label||this.props.value,this.props.showIcon&&i.createElement("i",{className:`fas fa-paste ${n}__icon`})):i.createElement("span",null)}}Object.defineProperty(o,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{showIcon:!1,valueAsUrl:!1}})}).call(this,s("5wds"))},g1Eu:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return a}));var r=s("/G9H"),i=s("I8Ok"),n=function(e,t){return function(){return e.apply(t,arguments)}},o={}.hasOwnProperty,a=function(t){function s(e){this.reset=n(this.reset,this),this.render=n(this.render,this),this.mountObserver=n(this.mountObserver,this),this.onScroll=n(this.onScroll,this),this.onClick=n(this.onClick,this),this.componentWillUnmount=n(this.componentWillUnmount,this),s.__super__.constructor.call(this,e),this.state={lastScrollY:null}}return function(e,t){for(var s in t)o.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.prototype.componentWillUnmount=function(){if(document.removeEventListener("scroll",this.onScroll),null!=this.observer)return this.observer.disconnect(),this.observer=null},s.prototype.onClick=function(t){var s,r;return null!=this.state.lastScrollY?(window.scrollTo(window.pageXOffset,this.state.lastScrollY),this.setState({lastScrollY:null})):(r=null!=(null!=(s=this.props.anchor)?s.current:void 0)?e(this.props.anchor.current).offset().top:0,window.pageYOffset>r?(this.setState({lastScrollY:window.pageYOffset}),window.scrollTo(window.pageXOffset,r),this.mountObserver()):void 0)},s.prototype.onScroll=function(e){if(this.setState({lastScrollY:null}),document.removeEventListener("scroll",this.onScroll),null!=this.observer)return this.observer.disconnect(),this.observer=null},s.prototype.mountObserver=function(){var e,t,s,r;return null!=window.IntersectionObserver?(s=null!=(e=null!=(t=this.props.anchor)?t.current:void 0)?e:document.body,this.observer=new IntersectionObserver((r=this,function(e){var t,i,n,o;for(o=[],i=0,n=e.length;i<n;i++){if((t=e[i]).target===s&&0===t.boundingClientRect.top){document.addEventListener("scroll",r.onScroll);break}o.push(void 0)}return o})),this.observer.observe(s)):Timeout.set(0,function(e){return function(){return document.addEventListener("scroll",e.onScroll)}}(this))},s.prototype.render=function(){return Object(i.button)({className:"back-to-top","data-tooltip-float":"fixed",onClick:this.onClick,title:null!=this.state.lastScrollY?osu.trans("common.buttons.back_to_previous"):osu.trans("common.buttons.back_to_top")},Object(i.i)({className:null!=this.state.lastScrollY?"fas fa-angle-down":"fas fa-angle-up"}))},s.prototype.reset=function(){return this.setState({lastScrollY:null})},s}(r.PureComponent)}).call(this,s("5wds"))},gcbN:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var r=s("/G9H"),i=s("tX/w"),n=s("rLgU"),o=s("ss8h");const a=e=>{const t=r.useContext(o.a),s=r.useCallback(s=>{s.preventDefault(),Object(n.h)(t,e.format)},[t,e.format]);return r.createElement("button",{className:Object(i.a)("beatmap-discussion-editor-toolbar__button",[Object(n.d)(t,e.format)?"active":""]),onMouseDown:s},r.createElement("i",{className:`fas fa-${e.format}`}))}},"h/Ip":function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("/G9H");const i=Object(r.createContext)({excludes:[],isWidget:!1})},"hC+F":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return c}));var r=s("0h6b"),i=s("f4vq"),n=s("/G9H"),o=s("PPOh"),a=s("tX/w"),l=s("cX0L");class c extends n.PureComponent{constructor(t){super(t),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"eventId",{enumerable:!0,configurable:!0,writable:!0,value:`follow-toggle-${Object(l.a)()}`}),Object.defineProperty(this,"toggleXhr",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"onClick",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var t;const s={follow:{notifiable_id:this.props.follow.notifiable_id,notifiable_type:this.props.follow.notifiable_type,subtype:this.props.follow.subtype}},i=this.state.following?"DELETE":"POST";null===(t=this.toggleXhr)||void 0===t||t.abort(),this.setState({toggling:!0},()=>{this.toggleXhr=e.ajax(Object(r.route)("follows.store"),{data:s,method:i}).done(()=>{"mapping"===this.props.follow.subtype?e.publish("user:followUserMapping:update",{following:!this.state.following,userId:this.props.follow.notifiable_id}):this.setState({following:!this.state.following})}).always(()=>{this.setState({toggling:!1})})})}}),Object.defineProperty(this,"refresh",{enumerable:!0,configurable:!0,writable:!0,value:()=>{"mapping"===this.props.follow.subtype&&this.setState({following:null!=i.a.currentUser&&i.a.currentUser.follow_user_mapping.includes(this.props.follow.notifiable_id)})}}),this.state={following:this.props.following,toggling:!1}}componentDidMount(){"mapping"===this.props.follow.subtype&&e.subscribe(`user:followUserMapping:refresh.${this.eventId}`,this.refresh)}componentWillUnmount(){e.unsubscribe(`.${this.eventId}`)}render(){return n.createElement("button",{className:Object(a.a)("btn-circle",this.props.modifiers),disabled:this.state.toggling,onClick:this.onClick,type:"button"},n.createElement("span",{className:"btn-circle__content"},this.renderToggleIcon()))}renderToggleIcon(){if(this.state.toggling)return n.createElement("span",{className:"btn-circle__icon"},n.createElement(o.a,null));let e,t;return this.state.following?(t="fas fa-bell",e="fas fa-bell-slash"):(t="far fa-bell",e="fas fa-bell"),n.createElement(n.Fragment,null,n.createElement("span",{className:"btn-circle__icon btn-circle__icon--hover-show"},n.createElement("span",{className:e})),n.createElement("span",{className:"btn-circle__icon btn-circle__icon--hover-hide"},n.createElement("span",{className:t})))}}Object.defineProperty(c,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{following:!0}})}).call(this,s("5wds"))},hc33:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return l}));var r=s("0h6b"),i=s("/G9H"),n=s("i+hk"),o=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]])}return s};const a={beatmapset:["UnwantedContent","Other"],beatmapset_discussion_post:["Insults","Spam","UnwantedContent","Nonsense","Other"],comment:["Insults","Spam","UnwantedContent","Nonsense","Other"],forum_post:["Insults","Spam","UnwantedContent","Nonsense","Other"],scores:["Cheating","MultipleAccounts","Other"]};class l extends i.PureComponent{constructor(t){super(t),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFormClose",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.setState({disabled:!1,showingForm:!1},this.props.onFormClose)}}),Object.defineProperty(this,"onSubmit",{enumerable:!0,configurable:!0,writable:!0,value:t=>{this.setState({disabled:!0});const s={data:{comments:t.comments,reason:t.reason,reportable_id:this.props.reportableId,reportable_type:this.props.reportableType},dataType:"json",type:"POST",url:Object(r.route)("reports.store")};e.ajax(s).done(()=>{this.timeout=window.setTimeout(this.onFormClose,1e3),this.setState({completed:!0})}).fail(e=>{osu.ajaxError(e),this.setState({disabled:!1})})}}),Object.defineProperty(this,"showForm",{enumerable:!0,configurable:!0,writable:!0,value:()=>{window.clearTimeout(this.timeout),this.setState({disabled:!1,showingForm:!0})}}),Object.defineProperty(this,"onShowFormButtonClick",{enumerable:!0,configurable:!0,writable:!0,value:e=>{0===e.button&&(e.preventDefault(),this.showForm())}}),this.state={completed:!1,disabled:!1,showingForm:!1}}render(){const e=this.props,{baseKey:t,icon:s,onFormClose:r,reportableId:l,reportableType:c,user:u}=e,d=o(e,["baseKey","icon","onFormClose","reportableId","reportableType","user"]),p=t||this.props.reportableType;return i.createElement(i.Fragment,null,i.createElement("button",Object.assign({key:"button",onClick:this.onShowFormButtonClick},d),s?i.createElement("span",{className:"textual-button textual-button--inline"},i.createElement("i",{className:"textual-button__icon fas fa-exclamation-triangle"})," ",osu.trans(`report.${p}.button`)):osu.trans(`report.${p}.button`)),this.state.showingForm&&i.createElement(n.a,{completed:this.state.completed,disabled:this.state.disabled,onClose:this.onFormClose,onSubmit:this.onSubmit,title:osu.trans(`report.${p}.title`,{username:`<strong>${u.username}</strong>`}),visible:!0,visibleOptions:a[p]}))}}Object.defineProperty(l,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{icon:!1,onFormClose:()=>{}}})}).call(this,s("5wds"))},hoYT:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));const r=["osu","taiko","fruits","mania"]},"i+hk":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var r,i=s("Hs9Z"),n=s("txhI"),o=s("/G9H"),a=s("I8Ok"),l=s("MeXQ"),c=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty;r="report-form";var d=function(t){function s(t){this.sendReport=c(this.sendReport,this),this.renderFormContent=c(this.renderFormContent,this),this.renderForm=c(this.renderForm,this),this.render=c(this.render,this),this.handleReasonChange=c(this.handleReasonChange,this),s.__super__.constructor.call(this,t),this.options=[{id:"Cheating",text:osu.trans("users.report.options.cheating")},{id:"MultipleAccounts",text:osu.trans("users.report.options.multiple_accounts")},{id:"Insults",text:osu.trans("users.report.options.insults")},{id:"Spam",text:osu.trans("users.report.options.spam")},{id:"UnwantedContent",text:osu.trans("users.report.options.unwanted_content")},{id:"Nonsense",text:osu.trans("users.report.options.nonsense")},{id:"Other",text:osu.trans("users.report.options.other")}],null!=t.visibleOptions&&(this.options=e.intersectionWith(this.options,t.visibleOptions,(function(e,t){return e.id===t}))),this.textarea=Object(o.createRef)(),this.state={selectedReason:this.options[0]}}return function(e,t){for(var s in t)u.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.prototype.handleReasonChange=function(e){return this.setState({selectedReason:e})},s.prototype.render=function(){return this.props.visible?this.renderForm():null},s.prototype.renderForm=function(){var e;return e=this.props.completed?osu.trans("users.report.thanks"):this.props.title,Object(o.createElement)(n.a,{onClose:this.props.onClose,visible:this.props.visible},Object(a.div)({className:r},Object(a.div)({className:r+"__header"},Object(a.div)({className:r+"__row "+r+"__row--exclamation"},Object(a.i)({className:"fas fa-exclamation-triangle"})),Object(a.div)({className:r+"__row "+r+"__row--title",dangerouslySetInnerHTML:{__html:"<span>"+e+"</span>"}})),this.props.completed?void 0:this.renderFormContent()))},s.prototype.renderFormContent=function(){return Object(a.div)(null,Object(i.isEmpty)(this.options)?void 0:[Object(a.div)({key:"label",className:r+"__row"},osu.trans("users.report.reason")),Object(a.div)({key:"options",className:r+"__row"},Object(o.createElement)(l.a,{blackout:!1,bn:r+"-select-options",onChange:this.handleReasonChange,options:this.options,selected:this.state.selectedReason}))],Object(a.div)({className:r+"__row"},osu.trans("users.report.comments")),Object(a.div)({className:r+"__row"},Object(a.textarea)({className:r+"__textarea",placeholder:osu.trans("users.report.placeholder"),ref:this.textarea})),Object(a.div)({className:r+"__row "+r+"__row--buttons"},[Object(a.button)({className:r+"__button "+r+"__button--report",disabled:this.props.disabled,key:"report",type:"button",onClick:this.sendReport},osu.trans("users.report.actions.send")),Object(a.button)({className:r+"__button",disabled:this.props.disabled,key:"cancel",type:"button",onClick:this.props.onClose},osu.trans("users.report.actions.cancel"))]))},s.prototype.sendReport=function(e){var t,s,r;return s={reason:null!=(r=this.state.selectedReason)?r.id:void 0,comments:this.textarea.current.value},"function"==typeof(t=this.props).onSubmit?t.onSubmit(s):void 0},s}(o.PureComponent)}).call(this,s("Hs9Z"))},iCid:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));class r{constructor(){Object.defineProperty(this,"observer",{enumerable:!0,configurable:!0,writable:!0,value:new MutationObserver(r.handleMutations)}),this.observer.observe(document,{attributeFilter:["datetime"],attributeOldValue:!0,childList:!0,subtree:!0})}}Object.defineProperty(r,"className",{enumerable:!0,configurable:!0,writable:!0,value:"js-timeago"}),Object.defineProperty(r,"searchQuery",{enumerable:!0,configurable:!0,writable:!0,value:`.${r.className}`}),Object.defineProperty(r,"handleMutation",{enumerable:!0,configurable:!0,writable:!0,value:t=>{switch(t.type){case"childList":e(t.addedNodes).find(r.searchQuery).addBack(r.searchQuery).timeago();break;case"attributes":t.target instanceof HTMLTimeElement&&t.target.dateTime!==t.oldValue&&t.target.classList.contains(r.className)&&e(t.target).timeago("updateFromDOM")}}}),Object.defineProperty(r,"handleMutations",{enumerable:!0,configurable:!0,writable:!0,value:t=>{null!=e.fn.timeago&&t.forEach(r.handleMutation)}})}).call(this,s("5wds"))},"iH//":function(e,t,s){"use strict";s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return c})),s.d(t,"c",(function(){return u}));var r=Object.freeze({colour:"hsl(var(--hsl-l1))",has_listing:!1,has_playmodes:!1,id:-1,identifier:"guest",is_probationary:!1,name:"Difficulty Guest",short_name:"GUEST"}),i=s("VxeA"),n=s("is6n"),o=s("vZz4"),a=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]])}return s};function l({beatmapset:e,currentBeatmap:t,discussion:s,user:n}){var o;return null==n?null:n.id===e.user_id?i.a:null!=t&&s.beatmap_id===t.id&&n.id===t.user_id?r:null===(o=n.groups)||void 0===o?void 0:o[0]}function c(e){return e.replace(o.j,(e,t)=>{const s=u(t),{children:r}=s,i=a(s,["children"]),n="string"==typeof r?r:t;return Object(o.f)(t,n,{props:i,unescape:!0})})}function u(e){const t=BeatmapDiscussionHelper.urlParse(Object(n.a)().href),s={children:e,rel:"nofollow noreferrer",target:"_blank"};let r;try{r=new URL(e)}catch(i){}if(null!=r&&r.host===Object(n.a)().host){const e=BeatmapDiscussionHelper.urlParse(r.href,null,{forceDiscussionId:!0});if(null!=(null==e?void 0:e.discussionId)&&null!=e.beatmapsetId){const r=[e.discussionId,e.postId].filter(Number.isFinite).join("/");(null==t?void 0:t.beatmapsetId)===e.beatmapsetId?(s.children=`#${r}`,s.className="js-beatmap-discussion--jump",s.target=void 0):s.children=`${e.beatmapsetId}#${r}`}}return s}},is6n:function(e,t,s){"use strict";function r(){var e;return null!==(e=window.newUrl)&&void 0!==e?e:document.location}function i(){const e=r();return e instanceof URL?e.searchParams:new URLSearchParams(e.search)}function n(){const e=r();return`${e.pathname}${e.search}`}s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return n}))},jEEn:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("/G9H"),i=s("tX/w");const n=e=>{return`/assets/images/flags/${e.split("").map(e=>(e.charCodeAt(0)+127397).toString(16)).join("-")}.svg`};function o({country:e,modifiers:t}){return null==e||null==e.code?null:r.createElement("div",{className:Object(i.a)("flag-country",t),style:{backgroundImage:`url('${n(e.code)}')`},title:e.name})}},jUJ3:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));let r=null;function i(e){var t;const s=function(){if(null==r&&null==(r=document.querySelector(".js-estimate-min-lines")))throw new Error("js-estimate-min-lines placeholder element is missing!");return r}();s.innerHTML=e;const i=s.firstChild;let n=s;i instanceof HTMLElement&&(n=i);const o=parseFloat(null!==(t=window.getComputedStyle(n).getPropertyValue("line-height"))&&void 0!==t?t:"0"),a=s.scrollHeight;return{count:Math.ceil(a/o),height:a,lineHeight:o}}},jpbm:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("/G9H"),i=s("q7/B");function n(e){return osu.formatNumber(Math.round(e))}function o({stats:e}){var t;let s="";return(null!==(t=e.variants)&&void 0!==t?t:[]).forEach(e=>{const t=osu.trans(`beatmaps.variant.${e.mode}.${e.variant}`),r=n(e.pp);s+=`<div>${t}: ${r}</div>`}),r.createElement(i.a,{label:"pp",modifiers:"pp",value:r.createElement("div",{"data-html-title":s,title:""},n(e.pp))})}},kD1C:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return a}));var r=s("Hs9Z"),i=s("f4vq"),n=s("/DQ7"),o=s("phBA");class a{constructor(){Object.defineProperty(this,"debouncedOnScroll",{enumerable:!0,configurable:!0,writable:!0,value:Object(r.debounce)(()=>this.onScroll(),20)}),Object.defineProperty(this,"onScroll",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.pin(),this.stickOrUnstick()}}),Object.defineProperty(this,"stickOrUnstick",{enumerable:!0,configurable:!0,writable:!0,value:()=>{const e=this.shouldStick;null!=e&&this.setVisible(e)}}),e(window).on("scroll",this.onScroll),e(document).on("turbolinks:load",this.debouncedOnScroll),e.subscribe("osu:page:change",this.debouncedOnScroll),e(window).on("resize",this.stickOrUnstick)}get breadcrumbsElement(){var e;return null===(e=window.newBody)||void 0===e?void 0:e.querySelector(".js-sticky-header-breadcrumbs")}get contentElement(){var e;return null===(e=window.newBody)||void 0===e?void 0:e.querySelector(".js-sticky-header-content")}get headerHeight(){const e=window._styles.header;return i.a.windowSize.isMobile?e.heightMobile:e.heightSticky}get header(){return document.querySelector(".js-pinned-header")}get marker(){return document.querySelector(".js-sticky-header")}get pinnedSticky(){return document.querySelector(".js-pinned-header-sticky")}get scrollOffsetValue(){const e=this.pinnedSticky,t=null==e?0:e.getBoundingClientRect().height;return this.headerHeight+t}get shouldStick(){const e=this.marker,t=this.pinnedSticky;if(null!=e&&null!=t)return e.getBoundingClientRect().top<this.headerHeight+t.getBoundingClientRect().height}scrollOffset(e){return Math.max(0,e-this.scrollOffsetValue)}pin(){null!=this.header&&(this.shouldPin()?document.body.classList.add("js-header-is-pinned"):document.body.classList.remove("js-header-is-pinned"))}setVisible(t){Object(n.c)(Object(o.e)(this.pinnedSticky),t),e(document).trigger("sticky-header:sticking",[t])}shouldPin(e){return(null!=e?e:window.pageYOffset)>30||this.shouldStick}}}).call(this,s("5wds"))},kiUL:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var r=s("WLnA"),i=s("0h6b"),n=s("Hs9Z"),o=s("lv9K"),a=s("y2EG"),l=s("nxXY"),c=s("uW+8"),u=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class d{constructor(){Object.defineProperty(this,"debouncedDeleteByIds",{enumerable:!0,configurable:!0,writable:!0,value:Object(n.debounce)(this.deleteByIds,500)}),Object.defineProperty(this,"debouncedSendQueuedMarkedAsRead",{enumerable:!0,configurable:!0,writable:!0,value:Object(n.debounce)(this.sendQueuedMarkedAsRead,500)}),Object.defineProperty(this,"deleteByIdsQueue",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"queuedMarkedAsRead",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"queuedMarkedAsReadIdentities",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object(o.p)(this)}delete(t){if(t.isDeleting=!0,t instanceof a.a)return this.deleteByIdsQueue.set(t.id,t),void this.debouncedDeleteByIds();e.ajax({data:{identities:[Object(l.d)(t.identity)]},dataType:"json",method:"DELETE",url:Object(i.route)("notifications.index")}).then(Object(o.f)(()=>{Object(r.a)(new c.a([t.identity],0))})).catch(osu.ajaxError).always(Object(o.f)(()=>t.isDeleting=!1))}loadMore(t,s,n){const o=Object(l.d)(t);delete o.id;const a=Object(i.route)("notifications.index",o),u={data:{cursor:n,unread:s.isWidget},dataType:"json",url:a};return e.ajax(u).then(e=>{Object(r.a)(new c.b(e,s))})}queueMarkAsRead(e){e.isMarkingAsRead=!0;const t=e.identity;"stack"!==Object(l.b)(t)?(e instanceof a.a&&e.canMarkRead?this.queuedMarkedAsRead.set(e.id,e):this.queuedMarkedAsReadIdentities.set(Object(l.e)(t),e),this.debouncedSendQueuedMarkedAsRead()):this.sendMarkAsReadRequest({identities:[Object(l.d)(e.identity)]}).then(Object(o.f)(()=>{Object(r.a)(new c.d([t],0))})).always(Object(o.f)(()=>e.isMarkingAsRead=!1))}deleteByIds(){if(0===this.deleteByIdsQueue.size)return;const t=[...this.deleteByIdsQueue.values()],s=t.map(e=>e.identity);this.deleteByIdsQueue.clear(),e.ajax({data:{notifications:s.map(l.d)},dataType:"json",method:"DELETE",url:Object(i.route)("notifications.index")}).then(Object(o.f)(()=>{Object(r.a)(new c.a(s,0))})).always(Object(o.f)(()=>t.forEach(e=>e.isDeleting=!1)))}sendMarkAsReadRequest(t){return e.ajax({data:t,dataType:"json",method:"POST",url:Object(i.route)("notifications.mark-read")}).catch(osu.ajaxError)}sendQueuedMarkedAsRead(){if(this.queuedMarkedAsRead.size>0){const e=[...this.queuedMarkedAsRead.values()],t=e.map(e=>e.identity);this.queuedMarkedAsRead.clear(),this.sendMarkAsReadRequest({notifications:t.map(l.d)}).then(Object(o.f)(()=>{Object(r.a)(new c.d(t,0))})).always(Object(o.f)(()=>e.forEach(e=>e.isMarkingAsRead=!1)))}if(this.queuedMarkedAsReadIdentities.size>0){const e=[...this.queuedMarkedAsReadIdentities.values()],t=e.map(e=>e.identity);this.queuedMarkedAsReadIdentities.clear(),this.sendMarkAsReadRequest({identities:t.map(l.d)}).then(Object(o.f)(()=>{Object(r.a)(new c.d(t,0))})).always(Object(o.f)(()=>e.forEach(e=>e.isMarkingAsRead=!1)))}}}u([o.f],d.prototype,"delete",null),u([o.f],d.prototype,"loadMore",null),u([o.f],d.prototype,"queueMarkAsRead",null)}).call(this,s("5wds"))},"l+Wg":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("qpPZ"),i=s("0h6b"),n=s("/G9H");function o(e){const t=[{active:"index"===e.section,title:osu.trans("news.index.title.info"),url:Object(i.route)("news.index")}];return"show"===e.section&&null!=e.post&&t.push({active:!0,title:e.post.title,url:Object(i.route)("news.show",{news:e.post.slug})}),n.createElement(r.a,{links:t,linksBreadcrumb:!0,theme:"news"})}},l424:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("/G9H"),i=s("yun6"),n=s("tX/w");function o(e){return r.createElement("div",{className:Object(n.a)("difficulty-badge",{"expert-plus":e.rating>=6.5}),style:{"--bg":Object(i.d)(e.rating)}},r.createElement("span",{className:"difficulty-badge__icon"},r.createElement("span",{className:"fas fa-star"})),osu.formatNumber(e.rating,2))}},leGJ:function(e,t,s){"use strict";(function(e,r){s.d(t,"a",(function(){return w}));var i,n,o,a=s("svbn"),l=s("AU96"),c=s("ukW2"),u=s("CnOT"),d=s("sHNI"),p=s("/G9H"),m=s("xZyo"),h=s("I8Ok"),b=s("uWCK"),f=s("iH//"),v=s("tX/w"),g=s("Ma8u"),y=function(e,t){return function(){return e.apply(t,arguments)}},_={}.hasOwnProperty;o=p.createElement,n="beatmap-discussion",i=function(e){var t,s,r;return s=e.type,t=e.discussion,r=e.users,Object(h.div)({className:"user-list-popup user-list-popup--blank"},t.votes[s]<1?osu.trans("beatmaps.discussions.votes.none."+s):o(p.Fragment,null,Object(h.div)({className:"user-list-popup__title"},osu.trans("beatmaps.discussions.votes.latest."+s),":"),t.votes.voters[s].map((function(e){var t;return Object(h.a)({href:laroute.route("users.show",{user:e}),className:"js-usercard user-list-popup__user",key:e,"data-user-id":e},o(b.a,{user:null!=(t=r[e])?t:[],modifiers:["full"]}))})),t.votes[s]>t.votes.voters[s].length?Object(h.div)({className:"user-list-popup__remainder-count"},osu.transChoice("common.count.plus_others",t.votes[s]-t.votes.voters[s].length)):void 0))};var w=function(t){function s(e){this.toggleCollapse=y(this.toggleCollapse,this),this.timestamp=y(this.timestamp,this),this.resolvedSystemPostId=y(this.resolvedSystemPostId,this),this.post=y(this.post,this),this.canBeRepliedTo=y(this.canBeRepliedTo,this),this.canDownvote=y(this.canDownvote,this),this.isVisible=y(this.isVisible,this),this.isRead=y(this.isRead,this),this.isOwner=y(this.isOwner,this),this.emitSetHighlight=y(this.emitSetHighlight,this),this.doVote=y(this.doVote,this),this.showVoters=y(this.showVoters,this),this.refreshTooltip=y(this.refreshTooltip,this),this.getTooltipContent=y(this.getTooltipContent,this),this.displayVote=y(this.displayVote,this),this.postFooter=y(this.postFooter,this),this.postButtons=y(this.postButtons,this),this.render=y(this.render,this),this.componentDidUpdate=y(this.componentDidUpdate,this),this.componentWillUnmount=y(this.componentWillUnmount,this),s.__super__.constructor.call(this,e),this.eventId="beatmap-discussion-entry-"+this.props.discussion.id,this.tooltips={}}return function(e,t){for(var s in t)_.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.prototype.componentWillUnmount=function(){var e;return null!=(e=this.voteXhr)?e.abort():void 0},s.prototype.componentDidUpdate=function(){var e,t,s,r;for(r in t=[],e=this.tooltips)_.call(e,r)&&(s=e[r],t.push(this.refreshTooltip(s.qtip("api"),r)));return t},s.prototype.render=function(){var e,t,s,r,i,a;return this.isVisible(this.props.discussion)&&(this.props.discussion.starting_post||this.props.discussion.posts&&0!==this.props.discussion.posts.length)?(s=Object(v.a)(n+"__line",{resolved:this.props.discussion.resolved}),!1,this._resolvedSystemPostId=null,e=this.props.discussion.starting_post||this.props.discussion.posts[0],i=Object(v.a)(n,{"horizontal-desktop":"review"!==this.props.discussion.message_type,deleted:null!=this.props.discussion.deleted_at,highlighted:this.props.highlighted,preview:this.props.preview,review:"review"===this.props.discussion.message_type,timeline:null!=this.props.discussion.timestamp,unread:!this.isRead(e)}),i+=" js-beatmap-discussion-jump",a=null!=(r=this.props.users[this.props.discussion.user_id])?r:this.props.users.null,t=Object(f.a)({beatmapset:this.props.beatmapset,currentBeatmap:this.props.currentBeatmap,discussion:this.props.discussion,user:a}),Object(h.div)({className:i,"data-id":this.props.discussion.id,onClick:this.emitSetHighlight},Object(h.div)({className:n+"__timestamp hidden-xs"},this.timestamp()),Object(h.div)({className:n+"__discussion"},Object(h.div)({className:n+"__top",style:osu.groupColour(t)},Object(h.div)({className:n+"__top-user"},o(u.a,{user:a,group:t,hideStripe:!0})),Object(h.div)({className:n+"__top-message"},this.post(e,"discussion")),Object(h.div)({className:n+"__top-actions"},this.props.preview?void 0:this.postButtons())),this.props.preview?void 0:this.postFooter(),Object(h.div)({className:s})))):null},s.prototype.postButtons=function(){return Object(h.div)({className:n+"__actions"},null!=this.props.parentDiscussion?Object(h.a)({href:BeatmapDiscussionHelper.url({discussion:this.props.parentDiscussion}),title:osu.trans("beatmap_discussions.review.go_to_parent"),className:n+"__link-to-parent js-beatmap-discussion--jump"},Object(h.i)({className:"fas fa-tasks"})):void 0,["up","down"].map((e=this,function(t){return Object(h.div)({key:t,"data-type":t,className:n+"__action",onMouseOver:e.showVoters,onTouchStart:e.showVoters},e.displayVote(t))})),Object(h.button)({className:n+"__action "+n+"__action--with-line",onClick:this.toggleCollapse},Object(h.div)({className:"beatmap-discussion-expand "+(this.props.collapsed?void 0:"beatmap-discussion-expand--expanded")},Object(h.i)({className:"fas fa-chevron-down"}))));var e},s.prototype.postFooter=function(){var e,t,s;return Object(h.div)({className:n+"__expanded "+(this.props.collapsed?"hidden":void 0)},Object(h.div)({className:n+"__replies"},function(){var r,i,n,o;for(o=[],r=0,i=(n=this.props.discussion.posts.slice(1)).length;r<i;r++)if(s=n[r],this.isVisible(s)){if(s.system&&"resolved"===s.message.type){if(e=s.message.value,t===e)continue;t=e}o.push(this.post(s,"reply"))}return o}.call(this)),this.canBeRepliedTo()?o(a.a,{currentUser:this.props.currentUser,beatmapset:this.props.beatmapset,currentBeatmap:this.props.currentBeatmap,discussion:this.props.discussion}):void 0)},s.prototype.displayVote=function(e){var t,s,r,i,n,o,a,l,c,u,d;if(d="beatmap-discussion-vote",t=(n=function(){switch(e){case"up":return[1,"thumbs-up"];case"down":return[-1,"thumbs-down"]}}())[0],i=n[1],null!=t)return s=null!=(o=this.props.discussion.current_user_attributes)?o.vote_score:void 0,c=d+" "+d+"--"+e,0!==(l=s===t?0:t)&&(c+=" "+d+"--inactive"),u=null!=(a=this.props.users[this.props.discussion.user_id])?a:this.props.users.null,r=this.isOwner()||u.is_bot||"down"===e&&!this.canDownvote()||!this.canBeRepliedTo(),Object(h.button)({className:c,"data-score":l,disabled:r,onClick:this.doVote},Object(h.i)({className:"fas fa-"+i}),Object(h.span)({className:d+"__count"},this.props.discussion.votes[e]))},s.prototype.getTooltipContent=function(e){return Object(m.renderToStaticMarkup)(o(i,{type:e,discussion:this.props.discussion,users:this.props.users}))},s.prototype.refreshTooltip=function(e,t){return null!=e?e.set("content.text",this.getTooltipContent(t)):void 0},s.prototype.showVoters=function(t){var s,r;if(!(s=t.currentTarget)._tooltip)return s._tooltip=!0,r=s.getAttribute("data-type"),this.tooltips[r]=e(s).qtip({style:{classes:"user-list-popup",def:!1,tip:!1},content:{text:this.getTooltipContent(r)},position:{at:"top center",my:"bottom center",viewport:e(window)},show:{delay:100,ready:!0,solo:!0,effect:function(){return e(this).fadeTo(110,1)}},hide:{fixed:!0,delay:500,effect:function(){return e(this).fadeTo(250,0)}}})},s.prototype.doVote=function(t){var s;return Object(g.b)(),null!=(s=this.voteXhr)&&s.abort(),this.voteXhr=e.ajax(laroute.route("beatmapsets.discussions.vote",{discussion:this.props.discussion.id}),{method:"PUT",data:{beatmap_discussion_vote:{score:t.currentTarget.dataset.score}}}).done((function(t){return e.publish("beatmapsetDiscussions:update",{beatmapset:t})})).fail(osu.ajaxError).always(g.a)},s.prototype.emitSetHighlight=function(t){if(!t.defaultPrevented)return e.publish("beatmapset-discussions:highlight",{discussionId:this.props.discussion.id})},s.prototype.isOwner=function(e){return null==e&&(e=this.props.discussion),null!=this.props.currentUser.id&&e.user_id===this.props.currentUser.id},s.prototype.isRead=function(e){var t;return(null!=(t=this.props.readPostIds)?t.has(e.id):void 0)||this.isOwner(e)||this.props.preview},s.prototype.isVisible=function(e){return null!=e&&(this.props.showDeleted||null==e.deleted_at)},s.prototype.canDownvote=function(){return this.props.currentUser.is_admin||this.props.currentUser.is_moderator||this.props.currentUser.is_bng},s.prototype.canBeRepliedTo=function(){return(!this.props.beatmapset.discussion_locked||BeatmapDiscussionHelper.canModeratePosts(this.props.currentUser))&&(null==this.props.discussion.beatmap_id||null==this.props.currentBeatmap.deleted_at)},s.prototype.post=function(e,t){var s,r,i,n,a,u,d;if(null!=e.id)return n=e.system?c.a:l.a,i=BeatmapDiscussionHelper.canModeratePosts(this.props.currentUser),r=this.isOwner(e)&&e.id>this.resolvedSystemPostId()&&!this.props.beatmapset.discussion_locked,s="discussion"===t?null!=(a=this.props.discussion.current_user_attributes)?a.can_destroy:void 0:i||r,o(n,{key:e.id,beatmapset:this.props.beatmapset,beatmap:this.props.currentBeatmap,discussion:this.props.discussion,post:e,type:t,read:this.isRead(e),users:this.props.users,user:null!=(u=this.props.users[e.user_id])?u:this.props.users.null,lastEditor:null!=e.last_editor_id?null!=(d=this.props.users[e.last_editor_id])?d:this.props.users.null:void 0,canBeEdited:this.props.currentUser.is_admin||r,canBeDeleted:s,canBeRestored:i,currentUser:this.props.currentUser})},s.prototype.resolvedSystemPostId=function(){var e,t;return null==this._resolvedSystemPostId&&(t=r.findLast(this.props.discussion.posts,(function(e){return null!=e&&e.system&&"resolved"===e.message.type})),this._resolvedSystemPostId=null!=(e=null!=t?t.id:void 0)?e:-1),this._resolvedSystemPostId},s.prototype.timestamp=function(){var e;return e="beatmap-discussion-timestamp",Object(h.div)({className:e},null!=this.props.discussion.timestamp&&this.props.isTimelineVisible?Object(h.div)({className:e+"__point"}):void 0,Object(h.div)({className:e+"__icons-container"},Object(h.div)({className:e+"__icons"},Object(h.div)({className:e+"__icon"},Object(h.span)({className:"beatmap-discussion-message-type beatmap-discussion-message-type--"+r.kebabCase(this.props.discussion.message_type)},Object(h.i)({className:d.a[this.props.discussion.message_type],title:osu.trans("beatmaps.discussions.message_type."+this.props.discussion.message_type)}))),this.props.discussion.resolved?Object(h.div)({className:e+"__icon "+e+"__icon--resolved"},Object(h.i)({className:"far fa-check-circle",title:osu.trans("beatmaps.discussions.resolved")})):void 0),Object(h.div)({className:e+"__text"},BeatmapDiscussionHelper.formatTimestamp(this.props.discussion.timestamp))))},s.prototype.toggleCollapse=function(){return e.publish("beatmapset-discussions:collapse",{discussionId:this.props.discussion.id})},s}(p.PureComponent)}).call(this,s("5wds"),s("Hs9Z"))},lo2x:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return O}));var r=s("OjW+"),i=s("ZJc0"),n=s("9JFa"),o=s("0h6b"),a=s("Hs9Z"),l=s("lv9K"),c=s("KUml"),u=s("f4vq"),d=s("/G9H"),p=s("X4fg"),m=s("mk7q"),h=s("peKF"),b=s("sAkl"),f=s("yun6"),v=s("ubBH"),g=s("tX/w"),y=s("phBA"),_=s("vZz4"),w=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};const O=["normal","extra"],j={approved:"ranked_date",graveyard:"last_updated",loved:"ranked_date",pending:"last_updated",qualified:"ranked_date",ranked:"ranked_date",wip:"last_updated"},E=Object(c.b)(({beatmap:e})=>d.createElement("div",{className:"beatmapset-panel__beatmap-dot",style:{"--bg":Object(f.d)(e.difficulty_rating)}})),P=Object(c.b)(({compact:e,beatmaps:t,mode:s})=>d.createElement("div",{className:"beatmapset-panel__extra-item beatmapset-panel__extra-item--dots"},d.createElement("div",{className:"beatmapset-panel__beatmap-icon"},d.createElement("i",{className:`fal fa-extra-mode-${s}`})),e?d.createElement("div",{className:"beatmapset-panel__beatmap-count"},t.length):t.map(e=>d.createElement(E,{key:e.id,beatmap:e})))),k=()=>d.createElement("span",{className:"beatmapset-badge beatmapset-badge--featured-artist beatmapset-badge--panel"},osu.trans("beatmapsets.featured_artist_badge.label")),N=Object(c.b)(({beatmapset:e})=>d.createElement(b.a,{className:"beatmapset-panel__mapper-link u-hover",user:{id:e.user_id,username:e.creator}})),S=()=>d.createElement("span",{className:"beatmapset-badge beatmapset-badge--nsfw beatmapset-badge--panel"},osu.trans("beatmapsets.nsfw_badge.label")),x=({icon:e,titleVariant:t})=>d.createElement("div",{className:"beatmapset-panel__play-icon",title:osu.trans(`beatmapsets.show.info.${t}`)},d.createElement("i",{className:e})),T=({icon:e,title:t,type:s,value:r})=>d.createElement("div",{className:`beatmapset-panel__stats-item beatmapset-panel__stats-item--${s}`,title:t},d.createElement("span",{className:"beatmapset-panel__stats-item-icon"},d.createElement("i",{className:`fa-fw ${e}`})),d.createElement("span",null,Object(y.d)(r,void 0,{maximumFractionDigits:1,minimumFractionDigits:0})));let C=class extends d.Component{constructor(t){super(t),Object.defineProperty(this,"beatmapsPopupHover",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"beatmapsPopupRef",{enumerable:!0,configurable:!0,writable:!0,value:d.createRef()}),Object.defineProperty(this,"blockRef",{enumerable:!0,configurable:!0,writable:!0,value:d.createRef()}),Object.defineProperty(this,"mobileExpanded",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timeouts",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"beatmapsPopupDelayedHide",{enumerable:!0,configurable:!0,writable:!0,value:()=>{window.clearTimeout(this.timeouts.beatmapsPopup),this.beatmapsPopupHover&&(this.timeouts.beatmapsPopup=window.setTimeout(Object(l.f)(()=>{this.beatmapsPopupHover=!1}),500))}}),Object.defineProperty(this,"beatmapsPopupDelayedShow",{enumerable:!0,configurable:!0,writable:!0,value:()=>{window.clearTimeout(this.timeouts.beatmapsPopup),this.beatmapsPopupHover||(this.timeouts.beatmapsPopup=window.setTimeout(Object(l.f)(()=>{this.beatmapsPopupHover=!0}),100))}}),Object.defineProperty(this,"beatmapsPopupHide",{enumerable:!0,configurable:!0,writable:!0,value:()=>{window.clearTimeout(this.timeouts.beatmapsPopup),this.beatmapsPopupHover=!1}}),Object.defineProperty(this,"beatmapsPopupKeep",{enumerable:!0,configurable:!0,writable:!0,value:()=>{window.clearTimeout(this.timeouts.beatmapsPopup),this.beatmapsPopupHover=!0}}),Object.defineProperty(this,"onBeatmapsPopupEnter",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.beatmapsPopupKeep()}}),Object.defineProperty(this,"onBeatmapsPopupLeave",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.beatmapsPopupDelayedHide()}}),Object.defineProperty(this,"onDocumentClick",{enumerable:!0,configurable:!0,writable:!0,value:t=>{var s,r,i;this.mobileExpanded&&(null!==(s=this.blockRef.current)&&void 0!==s&&s.contains(t.target)||null!==(i=null===(r=this.beatmapsPopupRef.current)||void 0===r?void 0:r.contentRef.current)&&void 0!==i&&i.contains(t.target)||(e(document).off("click",this.onDocumentClick),this.mobileExpanded=!1))}}),Object.defineProperty(this,"onExtraRowEnter",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.beatmapsPopupDelayedShow()}}),Object.defineProperty(this,"onExtraRowLeave",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.beatmapsPopupDelayedHide()}}),Object.defineProperty(this,"onMobileExpandToggleClick",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.mobileExpanded=!this.mobileExpanded,this.mobileExpanded&&e(document).on("click",this.onDocumentClick)}}),Object.defineProperty(this,"toggleFavourite",{enumerable:!0,configurable:!0,writable:!0,value:()=>{Object(v.c)(this.props.beatmapset)}}),Object(l.p)(this)}get beatmapDotsCompact(){return null!=this.props.beatmapset.beatmaps&&this.props.beatmapset.beatmaps.length>12}get displayDate(){const e=j[this.props.beatmapset.status];return this.props.beatmapset[e]}get downloadLink(){var e;if(null==u.a.currentUser)return{title:osu.trans("beatmapsets.show.details.logged-out")};if(null===(e=this.props.beatmapset.availability)||void 0===e?void 0:e.download_disabled)return{title:osu.trans("beatmapsets.availability.disabled")};let t,s,r=u.a.userPreferences.get("beatmapset_download");if("direct"!==r||u.a.currentUser.is_supporter||(r="all"),"direct"===r)t=Object(_.b)(this.props.beatmapset.id),s="direct";else{const e={beatmapset:this.props.beatmapset.id};this.props.beatmapset.video?"no_video"===r?(e.noVideo=1,s="no_video"):s="video":s="all",t=Object(o.route)("beatmapsets.download",e)}return{title:osu.trans(`beatmapsets.panel.download.${s}`),url:t}}get favourite(){return this.props.beatmapset.has_favourited?{icon:"fas fa-heart",toggleTitleVariant:"unfavourite"}:{icon:"far fa-heart",toggleTitleVariant:"favourite"}}get groupedBeatmaps(){return Object(f.g)(this.props.beatmapset.beatmaps)}get isBeatmapsPopupVisible(){return this.beatmapsPopupHover||this.mobileExpanded}get nominations(){return null!=this.props.beatmapset.nominations_summary?this.props.beatmapset.nominations_summary:null!=this.props.beatmapset.nominations?this.props.beatmapset.nominations.legacy_mode?this.props.beatmapset.nominations:{current:Object(a.sum)(Object(a.values)(this.props.beatmapset.nominations.current)),required:Object(a.sum)(Object(a.values)(this.props.beatmapset.nominations.required))}:void 0}get showHypeCounts(){return null!=this.props.beatmapset.hype}get showVisual(){return Object(v.b)(this.props.beatmapset)}get url(){return Object(o.route)("beatmapsets.show",{beatmapset:this.props.beatmapset.id})}componentWillUnmount(){e(document).off("click",this.onDocumentClick),Object.values(this.timeouts).forEach(e=>{window.clearTimeout(e)})}render(){let e=Object(g.a)("beatmapset-panel",{"beatmaps-popup-visible":this.isBeatmapsPopupVisible,"mobile-expanded":this.mobileExpanded,[`size-${u.a.userPreferences.get("beatmapset_card_size")}`]:!0,"with-hype-counts":this.showHypeCounts});return this.showVisual&&(e+=" js-audio--player"),d.createElement("div",{ref:this.blockRef,className:e,"data-audio-url":this.props.beatmapset.preview_url,onMouseLeave:this.beatmapsPopupHide,style:{"--beatmaps-popup-transition-duration":"150ms"}},this.renderBeatmapsPopup(),this.renderCover(),d.createElement("div",{className:"beatmapset-panel__content"},this.renderPlayArea(),this.renderInfoArea(),this.renderMenuArea()),d.createElement("button",{className:"beatmapset-panel__mobile-expand",onClick:this.onMobileExpandToggleClick,type:"button"},d.createElement("span",{className:`fas fa-angle-${this.mobileExpanded?"up":"down"}`})))}renderBeatmapsPopup(){return d.createElement(p.a,{in:this.isBeatmapsPopupVisible,mountOnEnter:!0,timeout:{enter:0,exit:150},unmountOnExit:!0},e=>d.createElement(r.a,{ref:this.beatmapsPopupRef,groupedBeatmaps:this.groupedBeatmaps,onMouseEnter:this.onBeatmapsPopupEnter,onMouseLeave:this.onBeatmapsPopupLeave,parent:this.blockRef.current,state:e,transitionDuration:150}))}renderCover(){return d.createElement("a",{className:"beatmapset-panel__cover-container",href:this.url},d.createElement("div",{className:"beatmapset-panel__cover-col beatmapset-panel__cover-col--play"},d.createElement("div",{className:"beatmapset-panel__cover beatmapset-panel__cover--default"}),this.showVisual&&d.createElement(n.a,{className:"beatmapset-panel__cover",hideOnError:!0,src:this.props.beatmapset.covers.list})),d.createElement("div",{className:"beatmapset-panel__cover-col beatmapset-panel__cover-col--info"},d.createElement("div",{className:"beatmapset-panel__cover beatmapset-panel__cover--default"}),this.showVisual&&u.a.windowSize.isDesktop&&d.createElement(n.a,{className:"beatmapset-panel__cover",hideOnError:!0,src:this.props.beatmapset.covers.card})))}renderInfoArea(){return d.createElement("div",{className:"beatmapset-panel__info"},d.createElement("div",{className:"beatmapset-panel__info-row beatmapset-panel__info-row--title"},d.createElement("a",{className:"beatmapset-panel__main-link u-ellipsis-overflow",href:this.url},Object(f.f)(this.props.beatmapset)),this.props.beatmapset.nsfw&&d.createElement(S,null)),d.createElement("div",{className:"beatmapset-panel__info-row beatmapset-panel__info-row--artist"},d.createElement("a",{className:"beatmapset-panel__main-link u-ellipsis-overflow",href:this.url},osu.trans("beatmapsets.show.details.by_artist",{artist:Object(f.c)(this.props.beatmapset)})),null!=this.props.beatmapset.track_id&&d.createElement(k,null)),d.createElement("div",{className:"beatmapset-panel__info-row beatmapset-panel__info-row--source"},d.createElement("div",{className:"u-ellipsis-overflow"},this.props.beatmapset.source)),d.createElement("div",{className:"beatmapset-panel__info-row beatmapset-panel__info-row--mapper"},d.createElement("div",{className:"u-ellipsis-overflow"},d.createElement(m.a,{mappings:{mapper:d.createElement(N,{beatmapset:this.props.beatmapset})},pattern:osu.trans("beatmapsets.show.details.mapped_by")}))),d.createElement("div",{className:"beatmapset-panel__info-row beatmapset-panel__info-row--stats"},this.showHypeCounts&&null!=this.props.beatmapset.hype&&d.createElement(T,{icon:"fas fa-bullhorn",title:osu.trans("beatmaps.hype.required_text",{current:osu.formatNumber(this.props.beatmapset.hype.current),required:osu.formatNumber(this.props.beatmapset.hype.required)}),type:"hype",value:this.props.beatmapset.hype.current}),this.showHypeCounts&&null!=this.nominations&&d.createElement(T,{icon:"fas fa-thumbs-up",title:osu.trans("beatmaps.nominations.required_text",{current:osu.formatNumber(this.nominations.current),required:osu.formatNumber(this.nominations.required)}),type:"nominations",value:this.nominations.current}),d.createElement(T,{icon:this.favourite.icon,title:osu.trans("beatmaps.panel.favourites",{count:osu.formatNumber(this.props.beatmapset.favourite_count)}),type:"favourite-count",value:this.props.beatmapset.favourite_count}),d.createElement(T,{icon:"fas fa-play-circle",title:osu.trans("beatmaps.panel.playcount",{count:osu.formatNumber(this.props.beatmapset.play_count)}),type:"play-count",value:this.props.beatmapset.play_count}),d.createElement("div",{className:"beatmapset-panel__stats-item beatmapset-panel__stats-item--date"},d.createElement("span",{className:"beatmapset-panel__stats-item-icon"},d.createElement("i",{className:"fa-fw fas fa-check-circle"})),d.createElement(h.a,{dateTime:this.displayDate}))),d.createElement("a",{className:"beatmapset-panel__info-row beatmapset-panel__info-row--extra",href:this.url,onMouseEnter:this.onExtraRowEnter,onMouseLeave:this.onExtraRowLeave},d.createElement("div",{className:"beatmapset-panel__extra-item"},d.createElement("div",{className:"beatmapset-status beatmapset-status--panel",style:{"--bg":`var(--beatmapset-${this.props.beatmapset.status}-bg)`,"--colour":`var(--beatmapset-${this.props.beatmapset.status}-colour)`}},osu.trans(`beatmapsets.show.status.${this.props.beatmapset.status}`))),[...this.groupedBeatmaps].map(([e,t])=>t.length>0&&d.createElement(P,{key:e,beatmaps:t,compact:this.beatmapDotsCompact,mode:e}))))}renderMenuArea(){return d.createElement("div",{className:"beatmapset-panel__menu-container"},d.createElement("div",{className:"beatmapset-panel__menu"},null==u.a.currentUser?d.createElement("span",{className:"beatmapset-panel__menu-item beatmapset-panel__menu-item--disabled",title:osu.trans("beatmapsets.show.details.favourite_login")},d.createElement("span",{className:this.favourite.icon})):d.createElement("button",{className:"beatmapset-panel__menu-item",onClick:this.toggleFavourite,title:osu.trans(`beatmapsets.show.details.${this.favourite.toggleTitleVariant}`),type:"button"},d.createElement("span",{className:this.favourite.icon})),null==this.downloadLink.url?d.createElement("span",{className:"beatmapset-panel__menu-item beatmapset-panel__menu-item--disabled",title:this.downloadLink.title},d.createElement("span",{className:"fas fa-file-download"})):d.createElement("a",{className:"beatmapset-panel__menu-item","data-turbolinks":"false",href:this.downloadLink.url,title:this.downloadLink.title},d.createElement("span",{className:"fas fa-file-download"}))))}renderPlayArea(){return d.createElement("div",{className:"beatmapset-panel__play-container"},this.showVisual&&d.createElement("button",{className:"beatmapset-panel__play js-audio--play",type:"button"},d.createElement("span",{className:"play-button"})),d.createElement("div",{className:"beatmapset-panel__play-progress"},d.createElement(i.a,{current:0,ignoreProgress:!0,max:1,onlyShowAsWarning:!1,theme:"beatmapset-panel"})),d.createElement("div",{className:"beatmapset-panel__play-icons"},this.props.beatmapset.video&&d.createElement(x,{icon:"fas fa-film",titleVariant:"video"}),this.props.beatmapset.storyboard&&d.createElement(x,{icon:"fas fa-image",titleVariant:"storyboard"})))}};w([l.q],C.prototype,"beatmapsPopupHover",void 0),w([l.q],C.prototype,"mobileExpanded",void 0),w([l.h],C.prototype,"beatmapDotsCompact",null),w([l.h],C.prototype,"displayDate",null),w([l.h],C.prototype,"downloadLink",null),w([l.h],C.prototype,"favourite",null),w([l.h],C.prototype,"groupedBeatmaps",null),w([l.h],C.prototype,"isBeatmapsPopupVisible",null),w([l.h],C.prototype,"nominations",null),w([l.h],C.prototype,"showHypeCounts",null),w([l.h],C.prototype,"showVisual",null),w([l.h],C.prototype,"url",null),w([l.f],C.prototype,"beatmapsPopupHide",void 0),w([l.f],C.prototype,"beatmapsPopupKeep",void 0),w([l.f],C.prototype,"onDocumentClick",void 0),w([l.f],C.prototype,"onMobileExpandToggleClick",void 0),C=w([c.b],C),t.b=C}).call(this,s("5wds"))},mArn:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));const r="//platform.enchant.com";class i{constructor(t){Object.defineProperty(this,"turbolinksReload",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"load",{enumerable:!0,configurable:!0,writable:!0,value:()=>{null!=document.querySelector(".enchant-help-center")&&(window.enchant=[],this.turbolinksReload.load(r))}}),Object.defineProperty(this,"showMessageWindow",{enumerable:!0,configurable:!0,writable:!0,value:e=>{e.preventDefault(),null!=window.enchant&&null!=window.enchant.messenger&&"function"==typeof window.enchant.messenger.open&&window.enchant.messenger.open()}}),Object.defineProperty(this,"unload",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.turbolinksReload.forget(r),e('#enchant-messenger-main, #enchant-messenger-launcher, iframe[src^="https://enchantwidgets-"]').remove(),document.querySelectorAll("style").forEach(t=>{const s=t.textContent;null!=s&&/#enchant-/.exec(s)&&e(t).remove()})}}),e(document).on("turbolinks:load",this.load),e(document).on("turbolinks:before-cache",this.unload),e(document).on("click",".js-enchant--show",this.showMessageWindow)}}}).call(this,s("5wds"))},mQSo:function(e,t,s){"use strict";(function(e,r){s.d(t,"a",(function(){return p}));var i,n,o=s("/G9H"),a=s("I8Ok"),l=s("mk7q"),c=s("peKF"),u=function(e,t){return function(){return e.apply(t,arguments)}},d={}.hasOwnProperty;n=o.createElement,i="beatmapset-mapping";var p=function(t){function s(){return this.renderDate=u(this.renderDate,this),this.render=u(this.render,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)d.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.prototype.render=function(){var e,t,s;return s={id:this.props.beatmapset.user_id,username:this.props.beatmapset.creator,avatar_url:null!=(e=null!=(t=this.props.user)?t:this.props.beatmapset.user)?e.avatar_url:void 0},Object(a.div)({className:i},null!=s.id?Object(a.a)({href:laroute.route("users.show",{user:s.id}),className:"avatar avatar--beatmapset",style:{backgroundImage:osu.urlPresence(s.avatar_url)}}):Object(a.span)({className:"avatar avatar--beatmapset avatar--guest"}),Object(a.div)({className:i+"__content"},Object(a.div)({className:i+"__mapper",dangerouslySetInnerHTML:{__html:osu.trans("beatmapsets.show.details.mapped_by",{mapper:this.userLink(s)})}}),this.renderDate("submitted","submitted_date"),this.props.beatmapset.ranked>0?this.renderDate(this.props.beatmapset.status,"ranked_date"):this.renderDate("updated","last_updated")))},s.prototype.renderDate=function(t,s){return Object(a.div)(null,n(l.a,{pattern:osu.trans("beatmapsets.show.details_date."+t),mappings:{timeago:Object(a.strong)(null,n(c.a,{dateTime:this.props.beatmapset[s],relative:Math.abs(e().diff(e(this.props.beatmapset[s]),"weeks"))<4}))}}))},s.prototype.userLink=function(e){var t;return null!=e.id?laroute.link_to_route("users.show",e.username,{user:e.id},{class:i+"__user js-usercard","data-user-id":e.id}):"<span class='"+i+"__user'>"+r.escape(null!=(t=e.username)?t:osu.trans("users.deleted"))+"</span>"},s}(o.PureComponent)}).call(this,s("7EfK"),s("Hs9Z"))},mjdM:function(e,t,s){"use strict";var r=s("KUml"),i=s("h/Ip"),n=s("8Xmz"),o=s("9zVE"),a=s("/G9H"),l=s("peKF"),c=s("tX/w"),u=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let d=class extends a.Component{constructor(){super(...arguments),Object.defineProperty(this,"handleContainerClick",{enumerable:!0,configurable:!0,writable:!0,value:e=>{osu.isClickable(e.target)||null!=this.props.markRead&&this.props.markRead()}})}get canMarkAsRead(){var e;return null!==(e=this.props.canMarkAsRead)&&void 0!==e?e:this.props.item.canMarkRead}render(){return a.createElement("div",{className:this.blockClass(),onClick:this.handleContainerClick},this.renderCover(),a.createElement("div",{className:"notification-popup-item__main"},a.createElement("div",{className:"notification-popup-item__content"},this.renderCategory(),this.renderMessage(),this.renderTime(),this.renderExpandButton()),this.renderMarkAsReadButton(),this.renderDeleteButton()),this.renderUnreadStripe())}blockClass(){const e=[...this.props.modifiers,this.props.item.category];return this.props.item.isRead&&!this.props.canMarkAsRead&&e.push("read"),`clickable-row ${Object(c.a)("notification-popup-item",e)}`}renderCategory(){if(!this.props.withCategory)return null;const e=osu.trans(`notifications.item.${this.props.item.displayType}.${this.props.item.category}._`);return""===e?null:a.createElement("div",{className:"notification-popup-item__row notification-popup-item__row--category"},e)}renderCover(){const e=this.props.withCoverImage?this.props.item.details.coverUrl:null;return a.createElement("div",{className:"notification-popup-item__cover",style:{backgroundImage:osu.urlPresence(e)}},a.createElement("div",{className:"notification-popup-item__cover-overlay"},this.renderCoverIcons()))}renderCoverIcons(){return null==this.props.icons?null:this.props.icons.map(e=>a.createElement("div",{key:e,className:"notification-popup-item__cover-icon"},a.createElement("span",{className:e})))}renderDeleteButton(){var e;return this.context.isWidget?null:a.createElement(n.a,{isDeleting:null!==(e=this.props.isDeleting)&&void 0!==e?e:this.props.item.isDeleting,modifiers:["fancy"],onDelete:this.props.delete})}renderExpandButton(){return null==this.props.expandButton?null:a.createElement("div",{className:"notification-popup-item__row notification-popup-item__row--expand"},this.props.expandButton)}renderMarkAsReadButton(){var e;return this.canMarkAsRead?a.createElement(o.a,{isMarkingAsRead:null!==(e=this.props.isMarkingAsRead)&&void 0!==e?e:this.props.item.isMarkingAsRead,modifiers:["fancy"],onMarkAsRead:this.props.markRead}):null}renderMessage(){return a.createElement("a",{className:"notification-popup-item__row notification-popup-item__row--message clickable-row-link",href:this.props.url,onClick:this.props.markRead},this.props.message)}renderTime(){if(null!=this.props.item.createdAtJson)return a.createElement("div",{className:"notification-popup-item__row notification-popup-item__row--time"},a.createElement(l.a,{dateTime:this.props.item.createdAtJson,relative:!0}))}renderUnreadStripe(){return this.context.isWidget||!this.canMarkAsRead?null:a.createElement("span",{className:"notification-popup-item__unread-stripe"})}};Object.defineProperty(d,"contextType",{enumerable:!0,configurable:!0,writable:!0,value:i.a}),d=u([r.b],d),t.a=d},mk7q:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("/G9H");function i(e){const t=Object.keys(e.mappings);if(0===t.length)return r.createElement(r.Fragment,null,e.pattern);const s=new RegExp(`(:${t.join("|:")})`),i=e.pattern.split(s);return r.createElement(r.Fragment,null,i.map(t=>{const s=":"===t[0]?t.slice(1):null,i=null==s||null==e.mappings[s]?t:e.mappings[s];return"string"==typeof i?i:r.createElement(r.Fragment,{key:t},i)}))}},mkgZ:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));class r{}},msVt:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return l}));var r=s("lv9K"),i=s("JsCm"),n=s("5e07");const o=()=>{const e=document.createElement("div");return e.className="audio-player audio-player--main",e.innerHTML=`\n    <button\n      type="button"\n      class="audio-player__button audio-player__button--prev js-audio--nav"\n      data-audio-nav="prev"\n    ><span class="fas fa-fw fa-step-backward"></span></button>\n\n    <button\n      type="button"\n      class="audio-player__button audio-player__button--play js-audio--main-play"\n    ><span class="fa-fw play-button"></span></button>\n\n    <button\n      type="button"\n      class="audio-player__button audio-player__button--next js-audio--nav"\n      data-audio-nav="next"\n    ><span class="fas fa-fw fa-step-forward"></span></button>\n\n    <div class="audio-player__bar audio-player__bar--progress js-audio--seek">\n      <div class="audio-player__bar-current"></div>\n    </div>\n\n    <div class="audio-player__timestamps">\n      <div class="audio-player__timestamp audio-player__timestamp--current"></div>\n      <div class="audio-player__timestamp-separator">/</div>\n      <div class="audio-player__timestamp audio-player__timestamp--total"></div>\n    </div>\n\n    <div class="audio-player__volume-control">\n      <button type="button" class="audio-player__volume-button js-audio--toggle-mute"></button>\n      <div class="audio-player__bar audio-player__bar--volume js-audio--volume">\n        <div class="audio-player__bar-current"></div>\n      </div>\n    </div>\n\n    <div class="audio-player__autoplay-control">\n      <button type="button" class="audio-player__autoplay-button js-audio--toggle-autoplay" title="${osu.trans("layout.audio.autoplay")}"></button>\n    </div>\n  `,e},a=()=>{const e=document.createElement("div");return e.className="audio-player js-audio--player",e.innerHTML='\n    <button\n    type="button"\n    class="audio-player__button audio-player__button--play js-audio--play"\n    ><span class="fa-fw play-button"></span></button>\n\n    <div class="audio-player__bar audio-player__bar--progress js-audio--seek">\n      <div class="audio-player__bar-current"></div>\n    </div>\n\n    <div class="audio-player__timestamps">\n      <div class="audio-player__timestamp audio-player__timestamp--current"></div>\n      <div class="audio-player__timestamp-separator">/</div>\n      <div class="audio-player__timestamp audio-player__timestamp--total"></div>\n    </div>\n  ',e};class l{constructor(t){Object.defineProperty(this,"userPreferences",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:new Audio}),Object.defineProperty(this,"currentSlider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"durationFormatted",{enumerable:!0,configurable:!0,writable:!0,value:"'0:00'"}),Object.defineProperty(this,"hasWorkingVolumeControl",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"hideMainPlayerTimeout",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"mainPlayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pagePlayer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"playerNext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"playerPrev",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settingNavigation",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:"paused"}),Object.defineProperty(this,"timeFormat",{enumerable:!0,configurable:!0,writable:!0,value:"minute_minimal"}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkVolumeSettings",{enumerable:!0,configurable:!0,writable:!0,value:()=>{const e=this.audio.volume,t=.1===e?.2:.1;this.audio.volume=t,setTimeout(()=>{this.hasWorkingVolumeControl=this.audio.volume===t,this.audio.volume=e,this.syncVolumeDisplay()},0)}}),Object.defineProperty(this,"ensurePagePlayerIsAttached",{enumerable:!0,configurable:!0,writable:!0,value:()=>{null==this.pagePlayer||document.body.contains(this.pagePlayer)||(this.pagePlayer=void 0)}}),Object.defineProperty(this,"load",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=e.dataset.audioUrl;if(null==t)throw new Error("Player is missing url");this.audio.paused||this.stop(),this.setTime(0),this.pagePlayer=e,this.url=t,this.audio.setAttribute("src",t),this.audio.currentTime=0,this.setState("loading");const s=this.audio.play();null==s||s.catch(e=>{if(l.ignoredErrors.includes(e.name))return console.debug("playback failed:",e.name),void this.stop();throw e}),this.setNavigation()}}),Object.defineProperty(this,"nav",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=e.currentTarget;t instanceof HTMLElement&&("prev"===t.dataset.audioNav&&null!=this.playerPrev?this.load(this.playerPrev):"next"===t.dataset.audioNav&&null!=this.playerNext&&this.load(this.playerNext))}}),Object.defineProperty(this,"observePage",{enumerable:!0,configurable:!0,writable:!0,value:e=>{this.ensurePagePlayerIsAttached();const t=[],s=[],r=null==this.pagePlayer;e.forEach(e=>{e.addedNodes.forEach(e=>{if(e instanceof HTMLElement&&(e instanceof HTMLAudioElement?t.push(e):t.push(...e.querySelectorAll("audio")),r))if(e.classList.contains("js-audio--player"))s.push(e);else for(const t of[...e.querySelectorAll(".js-audio--player")])t instanceof HTMLElement&&s.push(t)})}),s.push(...this.replaceAudioElems(t)),this.reattachPagePlayer(s)}}),Object.defineProperty(this,"onClickPlay",{enumerable:!0,configurable:!0,writable:!0,value:e=>{e.preventDefault();const t=this.findPlayer(e.currentTarget);if(null==t)throw new Error("couldn't find pagePlayer of the play button");t===this.pagePlayer?this.togglePlay():this.load(t)}}),Object.defineProperty(this,"onDocumentReady",{enumerable:!0,configurable:!0,writable:!0,value:()=>{if(null==this.mainPlayer){const e=document.querySelector(".js-audio--main");if(null==e)return void console.debug("page is missing main player placeholder");this.mainPlayer=o(),e.replaceWith(this.mainPlayer),Object(r.g)(()=>this.audio.muted=this.userPreferences.get("audio_muted")),Object(r.g)(()=>this.audio.volume=this.userPreferences.get("audio_volume")),this.checkVolumeSettings(),this.syncState()}null==this.observer&&(this.observer=new MutationObserver(this.observePage),this.observer.observe(document,{childList:!0,subtree:!0})),this.replaceAudioElems(),this.reattachPagePlayer()}}),Object.defineProperty(this,"onEnded",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.stop(),null!=this.playerNext&&this.userPreferences.get("audio_autoplay")&&this.load(this.playerNext)}}),Object.defineProperty(this,"onPlaying",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.setTimeFormat(),this.durationFormatted=Object(n.a)(this.audio.duration,this.timeFormat),this.setState("playing")}}),Object.defineProperty(this,"onSeekEnd",{enumerable:!0,configurable:!0,writable:!0,value:e=>{this.currentSlider=void 0;const t=1===e.getPercentage()?this.audio.duration-.01:this.audio.duration*e.getPercentage();this.setTime(t)}}),Object.defineProperty(this,"onSeekStart",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=e.currentTarget;t instanceof HTMLElement&&(null!=this.pagePlayer&&this.pagePlayer.contains(t)||null!=this.mainPlayer&&this.mainPlayer.contains(t))&&Number.isFinite(this.audio.duration)&&0!==this.audio.duration&&(this.currentSlider=i.a.start({bar:t,endCallback:this.onSeekEnd,initialEvent:e}))}}),Object.defineProperty(this,"onTimeupdate",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.audio.paused&&this.syncProgress()}}),Object.defineProperty(this,"onVolumeChangeEnd",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.currentSlider=void 0,this.userPreferences.set("audio_volume",this.audio.volume)}}),Object.defineProperty(this,"onVolumeChangeMove",{enumerable:!0,configurable:!0,writable:!0,value:e=>{this.audio.volume=e.getPercentage()}}),Object.defineProperty(this,"onVolumeChangeStart",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=e.currentTarget;t instanceof HTMLElement&&(this.currentSlider=i.a.start({bar:t,endCallback:this.onVolumeChangeEnd,initialEvent:e,moveCallback:this.onVolumeChangeMove}))}}),Object.defineProperty(this,"pause",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.audio.pause(),this.setState("paused")}}),Object.defineProperty(this,"reattachPagePlayer",{enumerable:!0,configurable:!0,writable:!0,value:e=>{if(this.ensurePagePlayerIsAttached(),null!=this.url&&null==this.pagePlayer){null==e&&(e=[...document.querySelectorAll(".js-audio--player")]);for(const t of e)if(t instanceof HTMLElement&&t.dataset.audioUrl===this.url){this.pagePlayer=t,this.syncState();break}}this.setNavigation()}}),Object.defineProperty(this,"replaceAudioElem",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t,s;const r=null!==(t=osu.presence(e.src))&&void 0!==t?t:osu.presence(null===(s=e.querySelector("source"))||void 0===s?void 0:s.src);if(null==r)throw new Error("audio element is missing src");const i=a();return i.dataset.audioUrl=r,i.dataset.audioState="paused",e.replaceWith(i),i}}),Object.defineProperty(this,"replaceAudioElems",{enumerable:!0,configurable:!0,writable:!0,value:e=>(null==e&&(e=[...document.querySelectorAll("audio")]),e.map(this.replaceAudioElem))}),Object.defineProperty(this,"setNavigation",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.settingNavigation||(this.settingNavigation=!0,window.setTimeout(()=>{var e;this.playerNext=void 0,this.playerPrev=void 0;const t=null===(e=this.pagePlayer)||void 0===e?void 0:e.closest(".js-audio--group");if(t instanceof HTMLElement){const e=t.querySelectorAll(".js-audio--player");for(let t=0;t<e.length;t++)if(e[t]===this.pagePlayer){if(t>0){const s=e[t-1];s instanceof HTMLElement&&(this.playerPrev=s)}const s=e[t+1];s instanceof HTMLElement&&(this.playerNext=s);break}}null!=this.mainPlayer&&(this.mainPlayer.dataset.audioHasPrev=null==this.playerPrev?"0":"1",this.mainPlayer.dataset.audioHasNext=null==this.playerNext?"0":"1"),this.settingNavigation=!1}))}}),Object.defineProperty(this,"setState",{enumerable:!0,configurable:!0,writable:!0,value:e=>{this.state=e,this.syncState(),"playing"===this.state||"loading"===this.state?(window.clearTimeout(this.hideMainPlayerTimeout),null!=this.mainPlayer&&(this.mainPlayer.dataset.audioVisible="1")):this.hideMainPlayerTimeout=window.setTimeout(()=>{null!=this.mainPlayer&&(this.mainPlayer.dataset.audioVisible="0")},4e3)}}),Object.defineProperty(this,"setTime",{enumerable:!0,configurable:!0,writable:!0,value:e=>{this.audio.currentTime=e,this.syncProgress()}}),Object.defineProperty(this,"setTimeFormat",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.audio.duration<600?this.timeFormat="minute_minimal":this.audio.duration<3600?this.timeFormat="minute":this.audio.duration<36e3?this.timeFormat="hour_minimal":this.timeFormat="hour"}}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var e;this.audio.pause(),null===(e=this.currentSlider)||void 0===e||e.end(),this.audio.currentTime=0,this.pause()}}),Object.defineProperty(this,"syncProgress",{enumerable:!0,configurable:!0,writable:!0,value:()=>{if(this.audio.duration>0){const e=this.audio.currentTime/this.audio.duration,t=e>=.5?"1":"0",s=e.toString(),r=Object(n.a)(this.audio.currentTime,this.timeFormat);this.updatePlayers(e=>{e.style.setProperty("--current-time",r),e.style.setProperty("--progress",s),e.dataset.audioOver50=t})}this.audio.paused||requestAnimationFrame(this.syncProgress)}}),Object.defineProperty(this,"syncState",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.updatePlayers(e=>{e.dataset.audioAutoplay=this.userPreferences.get("audio_autoplay")?"1":"0",e.dataset.audioHasDuration=Number.isFinite(this.audio.duration)?"1":"0",e.dataset.audioState=this.state,e.dataset.audioTimeFormat=this.timeFormat,e.style.setProperty("--duration",this.durationFormatted)}),this.syncProgress(),this.syncVolumeDisplay()}}),Object.defineProperty(this,"syncVolumeDisplay",{enumerable:!0,configurable:!0,writable:!0,value:()=>{null!=this.mainPlayer&&(this.mainPlayer.dataset.audioVolumeBarVisible=this.hasWorkingVolumeControl?"1":"0",this.mainPlayer.dataset.audioVolume=this.volumeIcon(),this.mainPlayer.style.setProperty("--volume",this.audio.volume.toString()))}}),Object.defineProperty(this,"toggleAutoplay",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.userPreferences.set("audio_autoplay",!this.userPreferences.get("audio_autoplay")),this.syncState()}}),Object.defineProperty(this,"toggleMute",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.userPreferences.set("audio_muted",!this.userPreferences.get("audio_muted"))}}),Object.defineProperty(this,"togglePlay",{enumerable:!0,configurable:!0,writable:!0,value:()=>{null!=this.url&&(this.audio.paused?this.audio.play():this.pause())}}),Object.defineProperty(this,"updatePlayers",{enumerable:!0,configurable:!0,writable:!0,value:e=>{[this.mainPlayer,this.pagePlayer].forEach(t=>{null!=t&&e(t)})}}),Object.defineProperty(this,"volumeIcon",{enumerable:!0,configurable:!0,writable:!0,value:()=>this.audio.muted?"muted":0===this.audio.volume?"silent":this.audio.volume<.4?"quiet":"normal"}),this.audio.volume=0,this.audio.addEventListener("playing",this.onPlaying),this.audio.addEventListener("ended",this.onEnded),this.audio.addEventListener("timeupdate",this.onTimeupdate),this.audio.addEventListener("volumechange",this.syncVolumeDisplay),e(document).on("click",".js-audio--play",this.onClickPlay),e(document).on("click",".js-audio--main-play",this.togglePlay),e(document).on(i.a.startEvents,".js-audio--seek",this.onSeekStart),e(document).on(i.a.startEvents,".js-audio--volume",this.onVolumeChangeStart),e(document).on("click",".js-audio--toggle-mute",this.toggleMute),e(document).on("click",".js-audio--toggle-autoplay",this.toggleAutoplay),e(document).on("click",".js-audio--nav",this.nav),e(document).on("turbolinks:load",this.onDocumentReady)}findPlayer(e){var t,s;const r=null!==(s=null===(t=this.mainPlayer)||void 0===t?void 0:t.contains(e))&&void 0!==s&&s?this.pagePlayer:e.closest(".js-audio--player");if(r instanceof HTMLElement)return r}}Object.defineProperty(l,"ignoredErrors",{enumerable:!0,configurable:!0,writable:!0,value:["AbortError","NotAllowedError","NotSupportedError"]})}).call(this,s("5wds"))},nN9y:function(e,t,s){"use strict";var r=s("WLnA");const i=["chat.channel.join","chat.channel.part"];var n=s("tz7b"),o=s("205K"),a=s("rqcF"),l=s("2hxc");function c(e){if("chat.message.new"===e.event)return new l.a(e.data);if(function(e){return null!=e.event&&i.includes(e.event)}(e))switch(e.event){case"chat.channel.join":return new o.a(e.data);case"chat.channel.part":return new a.a(e.data.channel_id)}}let u=class{handleDispatchAction(e){if(!(e instanceof n.a))return;const t=c(e.message);null!=t&&Object(r.a)(t)}};u=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o}([r.b],u);t.a=u},nW1t:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return o}));var r=s("Hs9Z"),i=s("/G9H"),n=s("tX/w");class o extends i.Component{constructor(){super(...arguments),Object.defineProperty(this,"count",{enumerable:!0,configurable:!0,writable:!0,value:e=>{if(null!=this.props.counts)return this.props.counts[e];const t=Object(r.sumBy)(this.props.beatmaps.get(e),e=>e.convert?0:1);return t>0?t:void 0}}),Object.defineProperty(this,"switchMode",{enumerable:!0,configurable:!0,writable:!0,value:t=>{t.preventDefault();const s=t.currentTarget,r=s.dataset.mode;this.props.currentMode!==r&&"true"!==s.dataset.disabled&&e.publish("playmode:set",{mode:r})}})}render(){return i.createElement("div",{className:"game-mode game-mode--beatmapsets"},i.createElement("ul",{className:"game-mode__items"},[...this.props.beatmaps].map(([e,t])=>{var s,r,o;const a=0===t.length,l=Object(n.a)("game-mode-link",{active:e===this.props.currentMode,disabled:a}),c=this.count(e);return i.createElement("li",{key:e,className:"game-mode__item"},i.createElement("a",{className:l,"data-disabled":a.toString(),"data-mode":e,href:null!==(o=null===(r=(s=this.props).hrefFunc)||void 0===r?void 0:r.call(s,e))&&void 0!==o?o:"#",onClick:this.switchMode},osu.trans(`beatmaps.mode.${e}`),null!=c&&i.createElement("span",{className:"game-mode-link__badge"},c)))})))}}}).call(this,s("5wds"))},nxXY:function(e,t,s){"use strict";function r(e){return`${e.objectType}-${e.objectId}-${e.category}`}function i(e){return null!=e.objectId&&null!=e.category?null!=e.id?"notification":"stack":"type"}function n(e){return{category:e.category,id:e.id,objectId:e.object_id,objectType:e.object_type}}function o(e){return{category:e.category,id:e.id,object_id:e.objectId,object_type:e.objectType}}function a(e){return`${e.objectType}-${e.objectId}-${e.category}-${e.id}`}s.d(t,"c",(function(){return r})),s.d(t,"b",(function(){return i})),s.d(t,"a",(function(){return n})),s.d(t,"d",(function(){return o})),s.d(t,"e",(function(){return a}))},o70V:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return i}));var r=s("5b8Q");class i{constructor(){Object.defineProperty(this,"handleCancel",{enumerable:!0,configurable:!0,writable:!0,value:t=>{var s;t.preventDefault(),e.publish("forum-post-input:clear",[t.target]);const i=e(t.target).parents(".js-forum-post-edit--container");i.html(null!==(s=i.attr("data-original-post"))&&void 0!==s?s:"").attr("data-original-post",null),Object(r.a)()}}),Object.defineProperty(this,"handleEditSaved",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{const s=e.target;setTimeout(()=>{this.saved(s,t)})}}),Object.defineProperty(this,"handleEditStart",{enumerable:!0,configurable:!0,writable:!0,value:(e,t)=>{const s=e.target;setTimeout(()=>{this.start(s,t)})}}),Object.defineProperty(this,"saved",{enumerable:!0,configurable:!0,writable:!0,value:(t,s)=>{if(!(t instanceof HTMLElement))throw new Error("target must be instance of HTMLElement");e(t).parents(".js-forum-post").replaceWith(s),Object(r.a)()}}),Object.defineProperty(this,"start",{enumerable:!0,configurable:!0,writable:!0,value:(t,s)=>{if(!(t instanceof HTMLElement))throw new Error("target must be instance of HTMLElement");const i=e(t).parents(".js-forum-post-edit--container");i.attr("data-original-post",i.html()).html(s).find("[name=body]").focus(),e.publish("forum-post-input:restore",[i[0]]),Object(r.a)()}}),e(document).on("ajax:success",".js-edit-post-start",this.handleEditStart).on("click",".js-edit-post-cancel",this.handleCancel).on("ajax:success",".js-forum-post-edit",this.handleEditSaved)}}}).call(this,s("5wds"))},oQBk:function(e,t,s){"use strict";var r=s("/G9H");const i=Object(r.createContext)({isFriendsPage:!1});t.a=i},pTWL:function(e,t,s){"use strict";(function(e,r){s.d(t,"a",(function(){return a}));var i=s("lv9K"),n=s("WKXC"),o=s("is6n");class a{constructor(t){Object.defineProperty(this,"turbolinksReload",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"components",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"newVisit",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"pageReady",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"renderedContainers",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"scrolled",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timeoutScroll",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"boot",{enumerable:!0,configurable:!0,writable:!0,value:()=>{if(this.pageReady&&null!=window.newBody)for(const[e,t]of this.components.entries()){const s=window.newBody.querySelectorAll(`.js-react--${e}`);for(const e of s)e instanceof HTMLElement&&!this.renderedContainers.has(e)&&(this.renderedContainers.add(e),Object(i.u)(()=>{n.render(t(e),e)}))}}}),Object.defineProperty(this,"destroy",{enumerable:!0,configurable:!0,writable:!0,value:()=>{for(const e of this.renderedContainers.values())document.body.contains(e)||(n.unmountComponentAtNode(e),this.renderedContainers.delete(e))}}),Object.defineProperty(this,"handleBeforeCache",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.pageReady=!1,window.clearTimeout(this.timeoutScroll)}}),Object.defineProperty(this,"handleBeforeRender",{enumerable:!0,configurable:!0,writable:!0,value:e=>{window.newBody=e.originalEvent.data.newBody,this.setNewUrl(),this.pageReady=!0,this.loadScripts(!1),this.boot()}}),Object.defineProperty(this,"handleBeforeVisit",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.newVisit=!0}}),Object.defineProperty(this,"handleLoad",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var t;null!==(t=window.newBody)&&void 0!==t||(window.newBody=document.body),window.newUrl=null,this.pageReady=!0,this.scrolled=!1,e(window).off("scroll",this.handleWindowScroll),e(window).on("scroll",this.handleWindowScroll),window.setTimeout(()=>{this.destroy(),this.loadScripts(),this.boot(),this.timeoutScroll=window.setTimeout(this.scrollOnNewVisit,100)},1)}}),Object.defineProperty(this,"handleWindowScroll",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.scrolled=this.scrolled||0!==window.scrollX||0!==window.scrollY}}),Object.defineProperty(this,"scrollOnNewVisit",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var t;e(window).off("scroll",this.handleWindowScroll);const s=this.newVisit;if(this.newVisit=!1,!s||this.scrolled)return;const r=decodeURIComponent(Object(o.a)().hash.substr(1));""!==r&&(null===(t=document.getElementById(r))||void 0===t||t.scrollIntoView())}}),e(document).on("turbolinks:before-cache",this.handleBeforeCache),e(document).on("turbolinks:before-visit",this.handleBeforeVisit),e(document).on("turbolinks:load",this.handleLoad),e(document).on("turbolinks:before-render",this.handleBeforeRender)}register(e,t){this.components.has(e)||(this.components.set(e,t),this.boot())}runAfterPageLoad(t,s){document.body===window.newBody?s():e(document).one(`turbolinks:load.${t}`,s)}loadScripts(e=!0){if(null==window.newBody)return;const t=e?"load":"loadSync";window.newBody.querySelectorAll(".js-react-turbolinks--script").forEach(e=>{if(e instanceof HTMLDivElement){const s=e.dataset.src;null!=s&&this.turbolinksReload[t](s)}})}setNewUrl(){var e,t,s,i;const n=null!==(s=null===(t=null===(e=r.controller.currentVisit)||void 0===e?void 0:e.redirectedToLocation)||void 0===t?void 0:t.absoluteURL)&&void 0!==s?s:null===(i=r.controller.currentVisit)||void 0===i?void 0:i.location.absoluteURL;window.newUrl=null==n?document.location:new URL(n)}}}).call(this,s("5wds"),s("dMdw"))},peKF:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("7EfK"),i=s("/G9H"),n=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]])}return s};function o(e){const{dateTime:t,format:s="ll",relative:o=!1}=e,a=n(e,["dateTime","format","relative"]),l="string"==typeof t?t:t.format();let c,u=l;if(o)c="js-timeago";else{c="js-tooltip-time",u=("string"==typeof t?r(t):t).format(s)}return i.createElement("time",Object.assign({className:c,dateTime:l,title:l},a),u)}},phBA:function(e,t,s){"use strict";(function(e){function r(){return 0===i()}function i(){const e=document.documentElement;return e.scrollHeight-e.scrollTop-e.clientHeight}function n(t){if(t instanceof HTMLElement)return t instanceof HTMLFormElement?()=>e(t).submit():()=>t.click()}function o(e,t,s){if(null==e)return;const r=["","k","m","b","t"],i=e=>(null!=s||(s={}),null!=t&&(s.minimumFractionDigits=t,s.maximumFractionDigits=t),e.toLocaleString("en",s));if(e<1e3)return i(e);const n=Math.min(r.length-1,Math.floor(Math.log(e)/Math.log(1e3)));return`${i(e/Math.pow(1e3,n))}${r[n]}`}function a(e){return e instanceof HTMLElement?e:null}s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return n})),s.d(t,"d",(function(){return o})),s.d(t,"e",(function(){return a})),s.d(t,"h",(function(){return l})),s.d(t,"f",(function(){return c})),s.d(t,"g",(function(){return u}));const l="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function c(e){if(null!=e)return e.replace(/(\.[^.]+)$/,"@2x$1")}function u(e){return e.replace(/<[^>]*>/g,"")}}).call(this,s("5wds"))},"q7/B":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("/G9H"),i=s("tX/w");const n="value-display";function o({description:e,label:t,modifiers:s,value:o}){return r.createElement("div",{className:Object(i.a)(n,s)},r.createElement("div",{className:`${n}__label`},t),r.createElement("div",{className:`${n}__value`},o),null!=e&&r.createElement("div",{className:`${n}__description`},e))}},"qhp/":function(e,t,s){"use strict";s.d(t,"a",(function(){return p}));var r=s("0h6b"),i=s("Hs9Z"),n=s("srn7"),o=s("/G9H"),a=s("peKF"),l=s("tX/w"),c=s("vZz4");const u=e=>"beatmap_owner_change"===e.type,d=e=>"nomination_reset_received"===e.type;class p extends o.PureComponent{get beatmapsetId(){var e;return null===(e=this.props.event.beatmapset)||void 0===e?void 0:e.id}get discussionId(){var e;return null===(e=this.props.event.comment)||void 0===e?void 0:e.beatmap_discussion_id}get discussion(){var e,t,s;return null!==(e=this.props.event.discussion)&&void 0!==e?e:null===(t=this.props.discussions)||void 0===t?void 0:t[null!==(s=this.discussionId)&&void 0!==s?s:""]}get firstPost(){var e,t,s,r;return null!==(t=null===(e=this.discussion)||void 0===e?void 0:e.starting_post)&&void 0!==t?t:null===(r=null===(s=this.discussion)||void 0===s?void 0:s.posts)||void 0===r?void 0:r[0]}render(){return"discussions"===this.props.mode?this.renderDiscussionsVersion():this.renderProfileVersion()}renderDiscussionsVersion(){var e;const t=null!==(e=this.props.time)&&void 0!==e?e:this.props.event.created_at;return o.createElement("div",{className:"beatmapset-event"},o.createElement("div",{className:"beatmapset-event__icon",style:this.iconStyle()}),o.createElement("div",{className:"beatmapset-event__time"},o.createElement(a.a,{dateTime:t,format:"LT"})),o.createElement("div",{className:"beatmapset-event__content",dangerouslySetInnerHTML:{__html:this.contentText()}}))}renderProfileVersion(){var e,t;const s=null===(t=null===(e=this.props.event.beatmapset)||void 0===e?void 0:e.covers)||void 0===t?void 0:t.list;let i;return null!=this.beatmapsetId&&(i=Object(r.route)("beatmapsets.discussion",{beatmapset:this.beatmapsetId}),null!=this.discussionId&&(i=`${i}#/${this.discussionId}`)),o.createElement("div",{className:"beatmapset-event"},null!=i?o.createElement("a",{href:i},o.createElement("img",{className:"beatmapset-cover",src:s})):o.createElement("span",{className:"beatmapset-cover"},"beatmap deleted"),o.createElement("div",{className:Object(l.a)("beatmapset-event__icon",["beatmapset-activities"]),style:this.iconStyle()}),o.createElement("div",null,o.createElement("div",{className:"beatmapset-event__content",dangerouslySetInnerHTML:{__html:this.contentText()}}),o.createElement("div",{className:"beatmap-discussion-post__info"},o.createElement(a.a,{dateTime:this.props.event.created_at,relative:!0}))))}contentText(){var e,t,s;let o,a="",l="[unknown user]",p="",m="";if(null!=this.discussionId){if(null==this.discussion)m=Object(r.route)("beatmapsets.discussions.show",{discussion:this.discussionId}),p=osu.trans("beatmapset_events.item.discussion_deleted");else{const t=null===(e=this.firstPost)||void 0===e?void 0:e.message;m=BeatmapDiscussionHelper.url({discussion:this.discussion}),p=null!=t?BeatmapDiscussionHelper.previewMessage(t):"[no preview]";const s=this.props.users[this.discussion.user_id];null!=s&&(l=Object(c.f)(Object(r.route)("users.show",{user:s.id}),s.username))}a=Object(c.f)(m,`#${this.discussionId}`,{classNames:["js-beatmap-discussion--jump"]})}else p=BeatmapDiscussionHelper.format(this.props.event.comment,{newlines:!1});if("discussion_lock"!==this.props.event.type&&"remove_from_loved"!==this.props.event.type||(p=BeatmapDiscussionHelper.format(this.props.event.comment.reason,{newlines:!1})),null!=this.props.event.user_id){const e=this.props.users[this.props.event.user_id];o=null==e?Object(i.escape)(n.b.username):Object(c.f)(Object(r.route)("users.show",{user:e.id}),e.username)}const h=Object.assign({discussion:a,discussion_user:l,text:p,user:o},this.props.event.comment);let b="disqualify"===this.props.event.type&&null==this.discussion?"disqualify_legacy":this.props.event.type;if("nominate"===b&&(null===(t=this.props.event.comment)||void 0===t?void 0:t.modes.length)>0){b="nominate_modes";const e=this.props.event.comment.modes.map(e=>osu.trans(`beatmaps.mode.${e}`));h.modes=osu.transArray(e)}if("nsfw_toggle"===b){b+=`.${(null===(s=this.props.event.comment)||void 0===s?void 0:s.new)?"to_1":"to_0"}`}if(u(this.props.event)){const e=this.props.event.comment;h.new_user=Object(c.f)(Object(r.route)("users.show",{user:e.new_user_id}),e.new_user_username),h.beatmap=Object(c.f)(Object(r.route)("beatmaps.show",{beatmap:e.beatmap_id}),e.beatmap_version)}if(d(this.props.event)){const e=this.props.event.comment;"profile"===this.props.mode?(b+="_profile",h.user=Object(c.f)(Object(r.route)("users.show",{user:e.source_user_id}),e.source_user_username)):h.source_user=Object(c.f)(Object(r.route)("users.show",{user:e.source_user_id}),e.source_user_username)}const f=`beatmapset_events.event.${b}`;let v=osu.trans(f,h);return null==o||osu.trans(f).includes(":user")||(v+=` (${o})`),v}iconStyle(){return{"--bg":`var(--bg-${Object(i.kebabCase)(this.props.event.type)})`}}}},qpPZ:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var r=s("f4vq"),i=s("/G9H"),n=s("PPOh"),o=s("tX/w"),a=s("elBb");class l extends i.Component{render(){var e,t;const s=Object(o.a)("header-v4",osu.presence(this.props.theme),{restricted:null!==(t=null===(e=r.a.currentUser)||void 0===e?void 0:e.is_restricted)&&void 0!==t&&t});return i.createElement("div",{className:s},i.createElement("div",{className:"header-v4__container header-v4__container--main"},i.createElement("div",{className:"header-v4__bg-container"},i.createElement("div",{className:"header-v4__bg",style:{backgroundImage:osu.urlPresence(this.props.backgroundImage)}})),this.props.isCoverUpdating&&i.createElement("div",{className:"header-v4__spinner"},i.createElement(n.a,null)),i.createElement("div",{className:"header-v4__content"},this.props.contentPrepend,i.createElement("div",{className:"header-v4__row header-v4__row--title"},i.createElement("div",{className:"header-v4__icon"}),i.createElement("div",{className:"header-v4__title"},this.title()),this.props.titleAppend),this.props.contentAppend)),this.props.links.length>0&&i.createElement("div",{className:"header-v4__container"},i.createElement("div",{className:"header-v4__content"},i.createElement("div",{className:"header-v4__row header-v4__row--bar"},this.renderLinks(),this.renderLinksMobile()))))}renderLinks(){const e=this.props.links.map(e=>{const t=[];return e.active&&t.push("active"),i.createElement("li",{key:`${e.url}-${e.title}`,className:"header-nav-v4__item"},i.createElement("a",Object.assign({className:Object(o.a)("header-nav-v4__link",t),href:e.url,onClick:this.props.onLinkClick},e.data),i.createElement("span",{className:"fake-bold","data-content":e.title},e.title)))}),t=this.props.linksBreadcrumb?"ol":"ul",s=[];return s.push(this.props.linksBreadcrumb?"breadcrumb":"list"),i.createElement(t,{className:Object(o.a)("header-nav-v4",s)},e)}renderLinksMobile(){if(this.props.linksBreadcrumb)return null;if(0===this.props.links.length)return null;let e=this.props.links[0];const t=this.props.links.map(t=>{const s=[];return t.active&&(s.push("active"),e=t),i.createElement("li",{key:`${t.url}-${t.title}`},i.createElement("a",Object.assign({className:"header-nav-mobile__item js-click-menu--close",href:t.url,onClick:this.props.onLinkClick},t.data),t.title))});return i.createElement("div",{className:"header-nav-mobile"},i.createElement("a",{className:"header-nav-mobile__toggle js-click-menu","data-click-menu-target":"header-nav-mobile",href:e.url},e.title,i.createElement("span",{className:"header-nav-mobile__toggle-icon"},i.createElement("span",{className:"fas fa-chevron-down"}))),i.createElement("ul",{className:"header-nav-mobile__menu js-click-menu","data-click-menu-id":"header-nav-mobile","data-visibility":"hidden"},t))}title(){const e=Object(a.b)("json-route-section"),t=[`page_title.${e.namespace}.${e.controller}.${e.action}`,`page_title.${e.namespace}.${e.controller}._`,`page_title.${e.namespace}._`];for(const s of t)if(osu.transExists(s,fallbackLocale))return osu.trans(s);return"unknown"}}Object.defineProperty(l,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{links:[],linksBreadcrumb:!1}})},rLgU:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"g",(function(){return n})),s.d(t,"b",(function(){return o})),s.d(t,"c",(function(){return a})),s.d(t,"d",(function(){return l})),s.d(t,"h",(function(){return u})),s.d(t,"f",(function(){return p})),s.d(t,"e",(function(){return m}));var r=s("tSlR");const i=e=>e.length,n=e=>0===e.length||1===e.length&&"paragraph"===e[0].type&&1===e[0].children.length&&""===e[0].children[0].text,o=e=>{var t;return"embed"===(null===(t=c(e))||void 0===t?void 0:t.type)},a=e=>{const t=c(e);return!!t&&r.a.isEmpty(e,t)},l=(e,t)=>{const[s]=r.a.nodes(e,{match:e=>!0===e[t],mode:"all"});return!!s},c=e=>{if(e.selection)return r.c.parent(e,r.f.start(e.selection).path)},u=(e,t)=>{r.h.setNodes(e,{[t]:!l(e,t)||null},{match:e=>r.g.isText(e),split:!0})};function d(e){const t=[],s={bold:!1,italic:!1};return e.children.forEach(e=>{var r,i,n,o;""!==e.text&&(s.bold!==(null!==(r=e.bold)&&void 0!==r&&r)&&(s.bold=null!==(i=e.bold)&&void 0!==i&&i,t.push("**")),s.italic!==(null!==(n=e.italic)&&void 0!==n&&n)&&(s.italic=null!==(o=e.italic)&&void 0!==o&&o,t.push("*"))),t.push(e.text.replace("*","\\*"))}),s.bold&&t.push("**"),s.italic&&t.push("*"),t.join("")}const p=e=>e.some(e=>"embed"===e.type&&"problem"===e.discussionType&&!e.discussionId),m=e=>{const t=[];e.forEach(e=>{switch(e.type){case"paragraph":t.push({text:d(e),type:"paragraph"});break;case"embed":t.push(function(e){return e.discussionId?{discussion_id:e.discussionId,type:"embed"}:{beatmap_id:e.beatmapId,discussion_type:e.discussionType,text:e.children[0].text,timestamp:e.timestamp?BeatmapDiscussionHelper.parseTimestamp(e.timestamp):null,type:"embed"}}(e))}});const s=t[t.length-1];return"paragraph"!==s.type||osu.present(s.text)||t.pop(),JSON.stringify(t)}},rqcF:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("mkgZ");class i extends r.a{constructor(e){super(),Object.defineProperty(this,"channelId",{enumerable:!0,configurable:!0,writable:!0,value:e})}}},sAkl:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("0h6b"),i=s("/G9H");class n extends i.PureComponent{render(){var e;let t="js-usercard";null!=this.props.className&&(t+=` ${this.props.className}`);const s=this.props.user.id?Object(r.route)("users.show",{mode:this.props.mode,user:this.props.user.id}):void 0;return i.createElement("a",{className:t,"data-tooltip-position":this.props.tooltipPosition,"data-user-id":this.props.user.id,href:s},null!==(e=this.props.children)&&void 0!==e?e:this.props.user.username)}}},sHNI:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));const r={hype:"fas fa-bullhorn",mapper_note:"far fa-sticky-note",praise:"fas fa-heart",problem:"fas fa-exclamation-circle",review:"fas fa-tasks",suggestion:"far fa-circle"}},sS1J:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var r=s("Hs9Z"),i=s("/G9H"),n=s("tX/w");class o extends i.Component{constructor(){super(...arguments),Object.defineProperty(this,"bodyRef",{enumerable:!0,configurable:!0,writable:!0,value:i.createRef()}),Object.defineProperty(this,"sizeSelectRef",{enumerable:!0,configurable:!0,writable:!0,value:i.createRef()}),Object.defineProperty(this,"cancel",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t;((null===(t=this.bodyRef.current)||void 0===t?void 0:t.value)===this.props.rawValue||confirm(osu.trans("common.confirmation_unsaved")))&&(null!=this.bodyRef.current&&(this.bodyRef.current.value=this.props.rawValue),this.sendOnChange({event:e,type:"cancel"}))}}),Object.defineProperty(this,"onKeyDown",{enumerable:!0,configurable:!0,writable:!0,value:e=>{27===e.keyCode&&this.cancel()}}),Object.defineProperty(this,"save",{enumerable:!0,configurable:!0,writable:!0,value:e=>{this.sendOnChange({event:e,type:"save"})}})}componentDidMount(){null!=this.sizeSelectRef.current&&(this.sizeSelectRef.current.value=""),null!=this.bodyRef.current&&(this.bodyRef.current.selectionEnd=0,this.bodyRef.current.focus())}render(){let e=Object(n.a)("bbcode-editor",this.props.modifiers);return e+=" js-bbcode-preview--form",i.createElement("form",{className:e,"data-state":"write"},i.createElement("div",{className:"bbcode-editor__content"},i.createElement("textarea",{ref:this.bodyRef,className:"bbcode-editor__body js-bbcode-preview--body",defaultValue:this.props.rawValue,disabled:this.props.disabled,name:"body",onKeyDown:this.onKeyDown,placeholder:this.props.placeholder}),i.createElement("div",{className:"bbcode-editor__preview"},i.createElement("div",{className:"forum-post-content js-bbcode-preview--preview"})),i.createElement("div",{className:"bbcode-editor__buttons-bar"},i.createElement("div",{className:"bbcode-editor__buttons bbcode-editor__buttons--toolbar"},this.renderToolbar()),i.createElement("div",{className:"bbcode-editor__buttons bbcode-editor__buttons--actions"},i.createElement("div",{className:"bbcode-editor__button bbcode-editor__button--cancel"},this.actionButton(this.cancel,osu.trans("common.buttons.cancel"))),i.createElement("div",{className:"bbcode-editor__button bbcode-editor__button--hide-on-write"},this.renderPreviewHideButton()),i.createElement("div",{className:"bbcode-editor__button bbcode-editor__button--hide-on-preview"},this.renderPreviewShowButton()),i.createElement("div",{className:"bbcode-editor__button"},this.actionButton(this.save,osu.trans("common.buttons.save"),"forum-primary"))))))}actionButton(e,t,s="forum-secondary"){return i.createElement("button",{className:Object(n.a)("btn-osu-big",s),disabled:this.props.disabled,onClick:e,type:"button"},t)}renderPreviewHideButton(){return i.createElement("button",{className:"js-bbcode-preview--hide btn-osu-big btn-osu-big--forum-secondary",disabled:this.props.disabled,type:"button"},osu.trans("forum.topic.create.preview_hide"))}renderPreviewShowButton(){return i.createElement("button",{className:"js-bbcode-preview--show btn-osu-big btn-osu-big--forum-secondary",disabled:this.props.disabled,type:"button"},osu.trans("forum.topic.create.preview"))}renderToolbar(){return i.createElement("div",{className:"post-box-toolbar"},this.toolbarButton("bold",i.createElement("i",{className:"fas fa-bold"})),this.toolbarButton("italic",i.createElement("i",{className:"fas fa-italic"})),this.toolbarButton("strikethrough",i.createElement("i",{className:"fas fa-strikethrough"})),this.toolbarButton("heading",i.createElement("i",{className:"fas fa-heading"})),this.toolbarButton("link",i.createElement("i",{className:"fas fa-link"})),this.toolbarButton("spoilerbox",i.createElement("i",{className:"fas fa-barcode"})),this.toolbarButton("list-numbered",i.createElement("i",{className:"fas fa-list-ol"})),this.toolbarButton("list",i.createElement("i",{className:"fas fa-list"})),this.toolbarButton("image",i.createElement("i",{className:"fas fa-image"})),this.toolbarSizeSelect())}sendOnChange({event:e,type:t}){var s,r;this.props.onChange({event:e,hasChanged:(null===(s=this.bodyRef.current)||void 0===s?void 0:s.value)!==this.props.rawValue,type:t,value:null===(r=this.bodyRef.current)||void 0===r?void 0:r.value})}toolbarButton(e,t){return i.createElement("button",{className:`btn-circle btn-circle--bbcode js-bbcode-btn--${e}`,disabled:this.props.disabled,title:osu.trans(`bbcode.${Object(r.snakeCase)(e)}`),type:"button"},i.createElement("span",{className:"btn-circle__content"},t))}toolbarSizeSelect(){return i.createElement("label",{className:"bbcode-size-select",title:osu.trans("bbcode.size._")},i.createElement("span",{className:"bbcode-size-select__label"},osu.trans("bbcode.size._")),i.createElement("i",{className:"fas fa-chevron-down"}),i.createElement("select",{ref:this.sizeSelectRef,className:"bbcode-size-select__select js-bbcode-btn--size",disabled:this.props.disabled},i.createElement("option",{value:"50"},osu.trans("bbcode.size.tiny")),i.createElement("option",{value:"85"},osu.trans("bbcode.size.small")),i.createElement("option",{value:"100"},osu.trans("bbcode.size.normal")),i.createElement("option",{value:"150"},osu.trans("bbcode.size.large"))))}}Object.defineProperty(o,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{disabled:!1}})},sTr9:function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var r=s("bfq+"),i=s("Rfpg"),n=s("Hs9Z"),o=s("lv9K"),a=s("f4vq"),l=s("d+cC"),c=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o},u=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(t){n(t)}}function a(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};class d{constructor(e){Object.defineProperty(this,"canMessageError",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"channelId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstMessageId",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"icon",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputText",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"lastReadId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"loadingEarlierMessages",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"loadingMessages",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"needsRefresh",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"newPmChannel",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:"TEMPORARY"}),Object.defineProperty(this,"uiState",{enumerable:!0,configurable:!0,writable:!0,value:{autoScroll:!0,scrollY:0}}),Object.defineProperty(this,"users",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"messagesMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"serverLastMessageId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.channelId=e,Object(o.p)(this)}get canMessage(){return null==this.canMessageError}get firstMessage(){return this.messages.length>0?this.messages[0]:void 0}get hasEarlierMessages(){return this.firstMessageId!==this.minMessageId}get isDisplayable(){return this.name.length>0&&null!=this.icon}get isUnread(){return null!=this.lastReadId?this.lastMessageId>this.lastReadId:this.lastMessageId>-1}get lastMessage(){return this.messages[this.messages.length-1]}get lastMessageId(){var e;for(let t=this.messages.length-1;t>=0;t--)if("number"==typeof this.messages[t].messageId)return this.messages[t].messageId;return null!==(e=this.serverLastMessageId)&&void 0!==e?e:-1}get messages(){return Object(n.sortBy)([...this.messagesMap.values()],["timestamp","channelId"])}get minMessageId(){const e=this.messages.length>0?this.messages[0].messageId:void 0;return"number"==typeof e?e:-1}get pmTarget(){if("PM"===this.type)return this.users.find(e=>e!==a.a.currentUserOrFail.id)}get supportedType(){return i.c.has(this.type)?this.type:null}static newPM(e,t){const s=new d(null!=t?t:-1);return s.newPmChannel=null==t,s.type="PM",s.name=e.username,s.icon=e.avatarUrl,s.users=[a.a.currentUserOrFail.id,e.id],s}addMessage(e){var t;if(null!=e.uuid&&e.sender_id===(null===(t=a.a.currentUser)||void 0===t?void 0:t.id)){const t=this.messagesMap.get(e.uuid);if(null!=t)return this.persistMessage(t,e)}const s=l.a.fromJson(e);this.messagesMap.set(s.messageId,s)}addMessages(e){e.forEach(e=>this.messagesMap.set(e.messageId,e))}addSendingMessage(e){this.messagesMap.set(e.messageId,e),this.markAsRead()}afterSendMesssage(e,t){null!=t?(this.persistMessage(e,t),this.setLastReadId(t.message_id)):e.errored=!0}load(){this.newPmChannel||this.refreshMessages()}loadEarlierMessages(){return u(this,void 0,void 0,(function*(){if(!this.hasEarlierMessages||this.loadingEarlierMessages)return;let e;this.loadingEarlierMessages=!0,this.minMessageId>0&&(e=this.minMessageId);try{const t=yield Object(r.b)(this.channelId,{until:e});Object(o.u)(()=>{this.addMessages(t),0===t.length&&(this.firstMessageId=this.minMessageId)})}finally{Object(o.u)(()=>{this.loadingEarlierMessages=!1})}}))}markAsRead(){this.setLastReadId(this.lastMessageId)}removeMessagesFromUserIds(e){for(const[,t]of this.messagesMap)e.has(t.senderId)&&this.messagesMap.delete(t.messageId)}setInputText(e){this.inputText=e}updateWithJson(e){var t,s;this.name=e.name,this.description=e.description,this.type=e.type,this.icon=null!==(t=e.icon)&&void 0!==t?t:d.defaultIcon,this.users=null!==(s=e.users)&&void 0!==s?s:this.users,this.serverLastMessageId=e.last_message_id,null!=e.current_user_attributes&&(this.canMessageError=e.current_user_attributes.can_message_error,this.setLastReadId(e.current_user_attributes.last_read_id))}persistMessage(e,t){null!=t.uuid&&this.messagesMap.delete(t.uuid),e.persist(t),this.messagesMap.set(e.messageId,e)}refreshMessages(){return u(this,void 0,void 0,(function*(){if(!this.needsRefresh||this.loadingMessages)return;let e;this.loadingMessages=!0,this.messages.length>0&&this.lastMessageId>0&&(e=this.lastMessageId);try{const t=yield Object(r.b)(this.channelId);Object(o.u)(()=>{var s,r;(null!==(r=null===(s=Object(n.minBy)(t,"messageId"))||void 0===s?void 0:s.messageId)&&void 0!==r?r:-1)>this.lastMessageId&&this.messagesMap.clear(),this.addMessages(t),this.needsRefresh=!1,this.loadingMessages=!1,0!==t.length||null!=e||(this.firstMessageId=this.minMessageId)})}catch(t){Object(o.u)(()=>this.loadingMessages=!1)}}))}setLastReadId(e){var t;e>(null!==(t=this.lastReadId)&&void 0!==t?t:0)&&(this.lastReadId=e)}}Object.defineProperty(d,"defaultIcon",{enumerable:!0,configurable:!0,writable:!0,value:"/images/layout/chat/channel-default.png"}),c([o.q],d.prototype,"canMessageError",void 0),c([o.q],d.prototype,"channelId",void 0),c([o.q],d.prototype,"description",void 0),c([o.q],d.prototype,"firstMessageId",void 0),c([o.q],d.prototype,"icon",void 0),c([o.q],d.prototype,"inputText",void 0),c([o.q],d.prototype,"lastReadId",void 0),c([o.q],d.prototype,"loadingEarlierMessages",void 0),c([o.q],d.prototype,"loadingMessages",void 0),c([o.q],d.prototype,"name",void 0),c([o.q],d.prototype,"newPmChannel",void 0),c([o.q],d.prototype,"type",void 0),c([o.q],d.prototype,"uiState",void 0),c([o.q],d.prototype,"users",void 0),c([o.q],d.prototype,"messagesMap",void 0),c([o.h],d.prototype,"canMessage",null),c([o.h],d.prototype,"firstMessage",null),c([o.h],d.prototype,"hasEarlierMessages",null),c([o.h],d.prototype,"isDisplayable",null),c([o.h],d.prototype,"isUnread",null),c([o.h],d.prototype,"lastMessage",null),c([o.h],d.prototype,"lastMessageId",null),c([o.h],d.prototype,"messages",null),c([o.h],d.prototype,"minMessageId",null),c([o.h],d.prototype,"pmTarget",null),c([o.h],d.prototype,"supportedType",null),c([o.f],d.prototype,"addMessage",null),c([o.f],d.prototype,"addMessages",null),c([o.f],d.prototype,"addSendingMessage",null),c([o.f],d.prototype,"afterSendMesssage",null),c([o.f],d.prototype,"load",null),c([o.f],d.prototype,"loadEarlierMessages",null),c([o.f],d.prototype,"markAsRead",null),c([o.f],d.prototype,"removeMessagesFromUserIds",null),c([o.f],d.prototype,"setInputText",null),c([o.f],d.prototype,"updateWithJson",null),c([o.f],d.prototype,"persistMessage",null),c([o.f],d.prototype,"refreshMessages",null),c([o.f],d.prototype,"setLastReadId",null)},srn7:function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return o}));var r=s("lv9K"),i=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class n{constructor(e){Object.defineProperty(this,"avatarUrl",{enumerable:!0,configurable:!0,writable:!0,value:"/images/layout/avatar-guest.png"}),Object.defineProperty(this,"countryCode",{enumerable:!0,configurable:!0,writable:!0,value:"XX"}),Object.defineProperty(this,"defaultGroup",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"groups",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isActive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBot",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isDeleted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isOnline",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isSupporter",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lastVisit",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"loaded",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"pmFriendsOnly",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"profileColour",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"username",{enumerable:!0,configurable:!0,writable:!0,value:""}),this.id=e,Object(r.p)(this)}static fromJson(e){const t=new n(e.id);return Object.assign(t,{avatarUrl:e.avatar_url,countryCode:e.country_code,defaultGroup:e.default_group,groups:e.groups,isActive:e.is_active,isBot:e.is_bot,isOnline:e.is_online,isSupporter:e.is_supporter,loaded:!0,pmFriendsOnly:e.pm_friends_only,profileColour:e.profile_colour,username:e.username})}is(e){return null!=e&&e.id===this.id}load(){}toJson(){return{avatar_url:this.avatarUrl,country_code:this.countryCode,default_group:this.defaultGroup,groups:this.groups,id:this.id,is_active:this.isActive,is_bot:this.isBot,is_deleted:this.isDeleted,is_online:this.isOnline,is_supporter:this.isSupporter,last_visit:this.lastVisit,pm_friends_only:this.pmFriendsOnly,profile_colour:this.profileColour,username:this.username}}updateFromJson(e){var t;this.username=e.username,this.avatarUrl=e.avatar_url,this.profileColour=null!==(t=e.profile_colour)&&void 0!==t?t:"",this.countryCode=e.country_code,this.isSupporter=e.is_supporter,this.isActive=e.is_active,this.isBot=e.is_bot,this.isOnline=e.is_online,this.pmFriendsOnly=e.pm_friends_only,this.loaded=!0}}i([r.q],n.prototype,"avatarUrl",void 0),i([r.q],n.prototype,"countryCode",void 0),i([r.q],n.prototype,"defaultGroup",void 0),i([r.q],n.prototype,"groups",void 0),i([r.q],n.prototype,"id",void 0),i([r.q],n.prototype,"isActive",void 0),i([r.q],n.prototype,"isBot",void 0),i([r.q],n.prototype,"isDeleted",void 0),i([r.q],n.prototype,"isOnline",void 0),i([r.q],n.prototype,"isSupporter",void 0),i([r.q],n.prototype,"lastVisit",void 0),i([r.q],n.prototype,"loaded",void 0),i([r.q],n.prototype,"pmFriendsOnly",void 0),i([r.q],n.prototype,"profileColour",void 0),i([r.q],n.prototype,"username",void 0),i([r.f],n.prototype,"updateFromJson",null);const o=new n(-1);o.isDeleted=!0,o.username=osu.trans("users.deleted")},ss8h:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("/G9H");const i=r.createContext(null)},stCr:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return d}));var r,i,n=s("4QOX"),o=s("f4vq"),a=s("/G9H"),l=(s("I8Ok"),s("6e4D")),c=function(e,t){return function(){return e.apply(t,arguments)}},u={}.hasOwnProperty;r=a.createElement,i=o.a.dataStore.uiState;var d=function(t){function s(){return this.render=c(this.render,this),this.handleChange=c(this.handleChange,this),s.__super__.constructor.apply(this,arguments)}return function(e,t){for(var s in t)u.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.prototype.handleChange=function(t){return e.publish("comments:sort",{sort:t.target.dataset.value})},s.prototype.render=function(){return r(n.a,null,(e=this,function(){var t;return r(l.a,{currentValue:null!=(t=i.comments.loadingSort)?t:i.comments.currentSort,modifiers:e.props.modifiers,onChange:e.handleChange,values:["new","old","top"]})}));var e},s}(a.PureComponent)}).call(this,s("5wds"))},svbn:function(e,t,s){"use strict";(function(e,r){s.d(t,"a",(function(){return v}));var i,n,o=s("Yin1"),a=s("C+VY"),l=s("f4vq"),c=s("/G9H"),u=s("LQV2"),d=s.n(u),p=s("I8Ok"),m=s("uWCK"),h=(s("phBA"),s("Ma8u")),b=function(e,t){return function(){return e.apply(t,arguments)}},f={}.hasOwnProperty;n=c.createElement,i="beatmap-discussion-post";var v=function(t){var s;function u(t){this.validPost=b(this.validPost,this),this.setMessage=b(this.setMessage,this),this.post=b(this.post,this),this.isTimeline=b(this.isTimeline,this),this.handleKeyDownCallback=b(this.handleKeyDownCallback,this),this.editStart=b(this.editStart,this),this.canResolve=b(this.canResolve,this),this.canReopen=b(this.canReopen,this),this.renderReplyButton=b(this.renderReplyButton,this),this.renderPlaceholder=b(this.renderPlaceholder,this),this.renderCancelButton=b(this.renderCancelButton,this),this.renderBox=b(this.renderBox,this),this.render=b(this.render,this),this.componentWillUnmount=b(this.componentWillUnmount,this),u.__super__.constructor.call(this,t),this.box=c.createRef(),this.throttledPost=e.throttle(this.post,1e3),this.handleKeyDown=InputHandler.textarea(this.handleKeyDownCallback),this.state={editing:!1,message:"",posting:null}}return function(e,t){for(var s in t)f.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(u,t),s={reply_resolve:"fas fa-check",reply_reopen:"fas fa-exclamation-circle",reply:"fas fa-reply"},u.prototype.componentWillUnmount=function(){var e;return this.throttledPost.cancel(),null!=(e=this.postXhr)?e.abort():void 0},u.prototype.render=function(){return this.state.editing?this.renderBox():this.renderPlaceholder()},u.prototype.renderBox=function(){return Object(p.div)({className:i+" "+i+"--reply "+i+"--new-reply"},this.renderCancelButton(),Object(p.div)({className:i+"__content"},Object(p.div)({className:i+"__avatar"},n(m.a,{user:this.props.currentUser,modifiers:["full-rounded"]})),Object(p.div)({className:i+"__message-container"},n(d.a,{disabled:null!=this.state.posting,className:i+"__message "+i+"__message--editor",value:this.state.message,onChange:this.setMessage,onKeyDown:this.handleKeyDown,placeholder:osu.trans("beatmaps.discussions.reply_placeholder"),ref:this.box}))),Object(p.div)({className:i+"__footer "+i+"__footer--notice"},osu.trans("beatmaps.discussions.reply_notice"),n(o.a,{message:this.state.message,isTimeline:this.isTimeline()})),Object(p.div)({className:i+"__footer"},Object(p.div)({className:i+"__actions"},Object(p.div)({className:i+"__actions-group"},this.canResolve()&&!this.props.discussion.resolved?this.renderReplyButton("reply_resolve"):void 0,this.canReopen()&&this.props.discussion.resolved?this.renderReplyButton("reply_reopen"):void 0,this.renderReplyButton("reply")))))},u.prototype.renderCancelButton=function(){return Object(p.button)({className:i+"__action "+i+"__action--cancel",disabled:null!=this.state.posting,onClick:(e=this,function(){return e.setState({editing:!1})})},Object(p.i)({className:"fas fa-times"}));var e},u.prototype.renderPlaceholder=function(){var e,t,s,r;return r=(s=null!=this.props.currentUser.id?[osu.trans("beatmap_discussions.reply.open.user"),"fas fa-reply",this.props.currentUser.is_silenced]:[osu.trans("beatmap_discussions.reply.open.guest"),"fas fa-sign-in-alt",!1])[0],t=s[1],e=s[2],Object(p.div)({className:i+" "+i+"--reply "+i+"--new-reply "+i+"--new-reply-placeholder"},n(a.a,{disabled:e,icon:t,modifiers:"beatmap-discussion-reply-open",props:{onClick:this.editStart},text:r}))},u.prototype.renderReplyButton=function(e){return Object(p.div)({className:i+"__action"},n(a.a,{disabled:!this.validPost()||null!=this.state.posting,icon:s[e],isBusy:this.state.posting===e,text:osu.trans("common.buttons."+e),props:{"data-action":e,onClick:this.throttledPost}}))},u.prototype.canReopen=function(){return this.props.discussion.can_be_resolved&&this.props.discussion.current_user_attributes.can_reopen},u.prototype.canResolve=function(){return this.props.discussion.can_be_resolved&&this.props.discussion.current_user_attributes.can_resolve},u.prototype.editStart=function(){var e;if(!l.a.userLogin.showIfGuest(this.editStart))return this.setState({editing:!0},(e=this,function(){var t;return null!=(t=e.box.current)?t.focus():void 0}))},u.prototype.handleKeyDownCallback=function(e,t){switch(e){case InputHandler.CANCEL:return this.setState({editing:!1});case InputHandler.SUBMIT:return this.throttledPost(t)}},u.prototype.isTimeline=function(){return null!=this.props.discussion.timestamp},u.prototype.post=function(e){var t,s,i,n,o;if(this.validPost())return Object(h.b)(),null!=(s=this.postXhr)&&s.abort(),t=null!=(i=e.currentTarget.dataset.action)?i:"reply",this.setState({posting:t}),n=function(){switch(t){case"reply_resolve":return!0;case"reply_reopen":return!1;default:return null}}(),this.postXhr=r.ajax(laroute.route("beatmapsets.discussions.posts.store"),{method:"POST",data:{beatmap_discussion_id:this.props.discussion.id,beatmap_discussion:null!=n?{resolved:n}:{},beatmap_discussion_post:{message:this.state.message}}}).done((o=this,function(e){return o.setState({message:"",editing:!1}),r.publish("beatmapDiscussionPost:markRead",{id:e.beatmap_discussion_post_ids}),r.publish("beatmapsetDiscussions:update",{beatmapset:e.beatmapset})})).fail(osu.ajaxError).always(function(e){return function(){return Object(h.a)(),e.setState({posting:null})}}(this))},u.prototype.setMessage=function(e){return this.setState({message:e.target.value})},u.prototype.validPost=function(){return BeatmapDiscussionHelper.validMessageLength(this.state.message,this.isTimeline())},u}(c.PureComponent)}).call(this,s("Hs9Z"),s("5wds"))},"tX/w":function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return o}));var r=s("Hs9Z");const i=(e,t)=>{e.forEach(e=>{Array.isArray(e)?e.forEach(e=>{null!=e&&t(e)}):"string"==typeof e?t(e):Object(r.forEach)(e,(e,s)=>{e&&t(s)})})};function n(e,...t){let s=e;return i(t,t=>s+=` ${e}--${t}`),s}function o(...e){const t=[];return i(e,e=>t.push(e)),t}},thX6:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return u}));var r=s("eiXn"),i=s("kUxX"),n=s("Hs9Z"),o=s("f4vq"),a=s("/G9H"),l=s("cX0L");const c=Object(r.c)({axisLabels:!1,circleLine:!0,infoBoxFormatX:function(e){return 0===e?osu.trans("common.time.now"):osu.transChoice("common.time.days_ago",-e)},infoBoxFormatY:function(e){return`<strong>${osu.trans("users.show.rank.global_simple")}</strong> #${osu.formatNumber(-e)}`},marginBottom:15,marginLeft:15,marginRight:15,marginTop:15,modifiers:"profile-page",scaleX:Object(i.scaleLinear)(),scaleY:Object(i.scaleLog)()});class u extends a.Component{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:`rank-chart-${Object(l.a)()}`}),Object.defineProperty(this,"rankChart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"rankChartArea",{enumerable:!0,configurable:!0,writable:!0,value:a.createRef()}),Object.defineProperty(this,"loadRankChart",{enumerable:!0,configurable:!0,writable:!0,value:()=>{var e;null===(e=this.rankChart)||void 0===e||e.loadData(this.data)}})}get data(){var e,t;if(!this.props.stats.is_ranked)return[];const s=null!==(t=null===(e=this.props.rankHistory)||void 0===e?void 0:e.data)&&void 0!==t?t:[],r=s.map((e,t)=>({x:t-s.length+1,y:-e})).filter(e=>e.y<0);if(r.length>0){1===r.length&&r.unshift({x:r[0].x-1,y:r[0].y});const e=Object(n.last)(r);0===(null==e?void 0:e.x)?e.y=-this.props.stats.global_rank:r.push({x:0,y:-this.props.stats.global_rank})}return r}componentDidMount(){null!=this.rankChartArea.current&&(null==this.rankChart&&(this.rankChart=new r.a(this.rankChartArea.current,c),e(window).on(`resize.${this.id}`,this.rankChart.resize)),o.a.reactTurbolinks.runAfterPageLoad(this.id,this.loadRankChart))}componentDidUpdate(){this.loadRankChart()}componentWillUnmount(){e(window).off(`.${this.id}`)}render(){return a.createElement("div",{ref:this.rankChartArea})}}}).call(this,s("5wds"))},tnRH:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("/G9H");function i(e){return r.createElement("div",{className:"u-relative"},r.createElement("h2",{className:"title title--page-extra"},osu.trans(`users.show.extra.${e.name}.title`)),e.withEdit&&r.createElement("span",{className:"page-extra-dragdrop hidden-xs js-profile-page-extra--sortable-handle"},r.createElement("i",{className:"fas fa-bars"})))}},txhI:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return c}));var r=s("/G9H"),i=s("I8Ok"),n=s("WKXC"),o=s("+bOe"),a=function(e,t){return function(){return e.apply(t,arguments)}},l={}.hasOwnProperty,c=function(t){function s(){this.renderPortalContent=a(this.renderPortalContent,this),this.render=a(this.render,this),this.hideModal=a(this.hideModal,this),this.handleMouseUp=a(this.handleMouseUp,this),this.handleMouseDown=a(this.handleMouseDown,this),this.handleEsc=a(this.handleEsc,this),this.componentWillUnmount=a(this.componentWillUnmount,this),this.componentDidUpdate=a(this.componentDidUpdate,this),this.componentDidMount=a(this.componentDidMount,this),this.ref=Object(r.createRef)()}return function(e,t){for(var s in t)l.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(s,t),s.isOpen=function(){return document.body.classList.contains("js-react-modal---is-open")},s.prototype.close=function(){return document.body.classList.remove("js-react-modal---is-open"),Object(o.c)(!1,.5)},s.prototype.componentDidMount=function(){var t;return document.body.appendChild(this.portal),document.addEventListener("keydown",this.handleEsc),e(document).on("turbolinks:before-cache.modal",(t=this,function(){return t.close(),document.body.removeChild(t.portal)})),this.props.visible?this.open():this.close()},s.prototype.componentDidUpdate=function(e){if(e.visible!==this.props.visible)return this.props.visible?this.open():this.close()},s.prototype.componentWillUnmount=function(){return this.close(),document.removeEventListener("keydown",this.handleEsc),e(document).off(".modal")},s.prototype.handleEsc=function(e){var t;if(27===e.keyCode)return"function"==typeof(t=this.props).onClose?t.onClose():void 0},s.prototype.handleMouseDown=function(e){return this.clickStartTarget=e.target},s.prototype.handleMouseUp=function(e){return this.clickEndTarget=e.target},s.prototype.hideModal=function(e){var t;if(0===e.button&&e.target===this.ref.current&&this.clickEndTarget===this.clickStartTarget)return"function"==typeof(t=this.props).onClose?t.onClose():void 0},s.prototype.open=function(){return document.body.classList.add("js-react-modal---is-open"),Object(o.c)(!0,.5)},s.prototype.render=function(){return null==this.portal&&(this.portal=document.createElement("div")),Object(n.createPortal)(this.renderPortalContent(),this.portal)},s.prototype.renderPortalContent=function(){return Object(i.div)({className:"js-react-modal",onClick:this.hideModal,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,ref:this.ref},this.props.children)},s}(r.PureComponent)}).call(this,s("5wds"))},tz7b:function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"a",(function(){return n}));var r=s("mkgZ");function i(e){return"object"==typeof e&&null!=e&&"event"in e}class n extends r.a{constructor(e){super(),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:e})}}},"u/q5":function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return o})),s.d(t,"d",(function(){return a})),s.d(t,"e",(function(){return c}));var r=s("f4vq");function i(e){return null!=e.best_id&&!e.user.is_deleted&&null!=r.a.currentUser&&e.user_id!==r.a.currentUser.id}function n(e){return i(e)||o(e)||a(e)}function o(e){return e.replay}function a(e){return null!=e.best_id}const l=osu.trans("beatmapsets.show.scoreboard.headers.miss"),c={fruits:[{attribute:"count_300",label:"fruits"},{attribute:"count_100",label:"ticks"},{attribute:"count_katu",label:"drp miss"},{attribute:"count_miss",label:l}],mania:[{attribute:"count_geki",label:"max"},{attribute:"count_300",label:"300"},{attribute:"count_katu",label:"200"},{attribute:"count_100",label:"100"},{attribute:"count_50",label:"50"},{attribute:"count_miss",label:l}],osu:[{attribute:"count_300",label:"300"},{attribute:"count_100",label:"100"},{attribute:"count_50",label:"50"},{attribute:"count_miss",label:l}],taiko:[{attribute:"count_300",label:"great"},{attribute:"count_100",label:"good"},{attribute:"count_miss",label:l}]}},"uW+8":function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return o})),s.d(t,"a",(function(){return a})),s.d(t,"d",(function(){return l}));var r=s("mkgZ"),i=s("nxXY");class n extends r.a{constructor(e,t){super(),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"context",{enumerable:!0,configurable:!0,writable:!0,value:t})}}class o extends r.a{constructor(e){super(),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:e})}}class a extends r.a{constructor(e,t){super(),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"readCount",{enumerable:!0,configurable:!0,writable:!0,value:t})}static fromJson(e){const t=e.data.notifications.map(e=>Object(i.a)(e));return new a(t,e.data.read_count)}}class l extends r.a{constructor(e,t){super(),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"readCount",{enumerable:!0,configurable:!0,writable:!0,value:t})}static fromJson(e){const t=e.data.notifications.map(e=>Object(i.a)(e));return new l(t,e.data.read_count)}}},uWCK:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("/G9H"),i=s("tX/w");function n(e){return r.createElement("span",{className:`${Object(i.a)("avatar",e.modifiers)} avatar--guest`,style:{backgroundImage:osu.urlPresence(e.user.avatar_url)}})}},ubBH:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return u})),s.d(t,"c",(function(){return d}));var r=s("LXy+"),i=s("0h6b"),n=s("Hs9Z"),o=s("lv9K"),a=s("f4vq"),l=s("/jJF");function c(e,t){return Object(r.a)(e)?e[t]:Object(n.sum)(Object.values(e[t]))}function u(e){return!e.nsfw||a.a.userPreferences.get("beatmapset_show_nsfw")}const d=Object(o.f)(t=>{const s=()=>d(t);if(a.a.userLogin.showIfGuest(s))return;const r=!t.has_favourited;t.has_favourited=r,t.favourite_count+=r?1:-1,e.ajax(Object(i.route)("beatmapsets.favourites.store",{beatmapset:t.id}),{data:{action:r?"favourite":"unfavourite"},method:"POST"}).fail(Object(o.f)((e,i)=>{t.has_favourited=!r,t.favourite_count+=r?-1:1,Object(l.a)(e,i,s)})).done(Object(o.f)(e=>{t.favourite_count=e.favourite_count}))})}).call(this,s("5wds"))},ueqr:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));const r={audio_autoplay:!1,audio_muted:!1,audio_volume:.45,beatmapset_card_size:"normal",beatmapset_download:"all",beatmapset_show_nsfw:!1,beatmapset_title_show_original:!1,comments_show_deleted:!1,forum_posts_show_deleted:!0,ranking_expanded:!0,user_list_filter:"all",user_list_sort:"last_visit",user_list_view:"card"}},ufn5:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return P}));var r=s("ZJc0"),i=s("PQII"),n=s.n(i),o=s("0h6b"),a=s("Hs9Z"),l=s("f4vq"),c=s("/G9H"),u=s("tSlR"),d=s("21/t"),p=s("dTpI"),m=s("PPOh"),h=s("yun6"),b=s("ubBH"),f=s("tX/w"),v=s("5AHq"),g=s("BCxl"),y=s("rLgU"),_=s("/cS6"),w=s("BTwX"),O=s("XMjx"),j=s("6b0J"),E=s("ss8h");class P extends c.Component{constructor(t){super(t),Object.defineProperty(this,"bn",{enumerable:!0,configurable:!0,writable:!0,value:"beatmap-discussion-editor"}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"emptyDocTemplate",{enumerable:!0,configurable:!0,writable:!0,value:[{children:[{text:""}],type:"paragraph"}]}),Object.defineProperty(this,"insertMenuRef",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"localStorageKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"scrollContainerRef",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"slateEditor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"toolbarRef",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"xhr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockWrapper",{enumerable:!0,configurable:!0,writable:!0,value:e=>c.createElement("div",{className:`${this.bn}__block`},e)}),Object.defineProperty(this,"decorateTimestamps",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const[t,s]=e,r=[];if(!u.g.isText(t))return r;const i=RegExp(BeatmapDiscussionHelper.TIMESTAMP_REGEX,"g");let n;for(;null!==(n=i.exec(t.text));)r.push({anchor:{offset:n.index,path:s},focus:{offset:n.index+n[0].length,path:s},timestamp:n[0]});return r}}),Object.defineProperty(this,"isCurrentBeatmap",{enumerable:!0,configurable:!0,writable:!0,value:e=>null!=e&&e.beatmapset_id===this.props.beatmapset.id}),Object.defineProperty(this,"onChange",{enumerable:!0,configurable:!0,writable:!0,value:e=>{if(0===e.length&&(e=this.emptyDocTemplate),!this.props.editMode){const t=JSON.stringify(e);Object(y.g)(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,t)}this.setState({blockCount:Object(y.a)(e),value:e},()=>{var e,t;p.b.isFocused(this.slateEditor)&&this.props.onFocus&&this.props.onFocus(),null===(t=(e=this.props).onChange)||void 0===t||t.call(e)})}}),Object.defineProperty(this,"onKeyDown",{enumerable:!0,configurable:!0,writable:!0,value:e=>{n()("mod+b",e)?(e.preventDefault(),Object(y.h)(this.slateEditor,"bold")):n()("mod+i",e)?(e.preventDefault(),Object(y.h)(this.slateEditor,"italic")):n()("shift+enter",e)?Object(y.b)(this.slateEditor)&&(e.preventDefault(),this.slateEditor.insertText("\n")):(n()("delete",e)||n()("backspace",e))&&Object(y.c)(this.slateEditor)&&(e.preventDefault(),u.h.removeNodes(this.slateEditor))}}),Object.defineProperty(this,"post",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.showConfirmationIfRequired()&&this.setState({posting:!0},()=>{this.xhr=e.ajax(Object(o.route)("beatmapsets.discussion.review",{beatmapset:this.props.beatmapset.id}),{data:{document:this.serialize()},method:"POST"}).done(t=>{e.publish("beatmapsetDiscussions:update",{beatmapset:t}),this.resetInput()}).fail(osu.ajaxError).always(()=>this.setState({posting:!1}))})}}),Object.defineProperty(this,"renderBlockCount",{enumerable:!0,configurable:!0,writable:!0,value:e=>c.createElement(r.a,{current:this.state.blockCount,max:this.context.max_blocks,onlyShowAsWarning:!0,theme:e,tooltip:osu.trans("beatmap_discussions.review.block_count",{max:this.context.max_blocks,used:this.state.blockCount})})}),Object.defineProperty(this,"renderElement",{enumerable:!0,configurable:!0,writable:!0,value:e=>{let t;switch(e.element.type){case"embed":t=c.createElement(g.a,Object.assign({beatmaps:this.sortedBeatmaps(),beatmapset:this.props.beatmapset,currentBeatmap:this.props.currentBeatmap,discussions:this.props.discussions,editMode:this.props.editMode,readOnly:this.state.posting},e));break;default:t=e.children}return this.blockWrapper(t)}}),Object.defineProperty(this,"renderLeaf",{enumerable:!0,configurable:!0,writable:!0,value:e=>{let t=e.children;return e.leaf.bold&&(t=c.createElement("strong",Object.assign({},e.attributes),t)),e.leaf.italic&&(t=c.createElement("em",Object.assign({},e.attributes),t)),e.leaf.timestamp?c.createElement("span",Object.assign({className:"beatmap-discussion-timestamp-decoration"},e.attributes),t):c.createElement("span",Object.assign({},e.attributes),t)}}),Object.defineProperty(this,"resetInput",{enumerable:!0,configurable:!0,writable:!0,value:e=>{e&&(e.preventDefault(),!confirm(osu.trans("common.confirmation")))||(u.h.deselect(this.slateEditor),this.onChange(this.emptyDocTemplate))}}),Object.defineProperty(this,"serialize",{enumerable:!0,configurable:!0,writable:!0,value:()=>Object(y.e)(this.state.value)}),Object.defineProperty(this,"showConfirmationIfRequired",{enumerable:!0,configurable:!0,writable:!0,value:()=>{const e=Object(y.f)(this.state.value),t=null!=l.a.currentUser&&(l.a.currentUser.is_admin||l.a.currentUser.is_moderator||l.a.currentUser.is_full_bn),s="qualified"===this.props.beatmapset.status&&e,r=null!=l.a.currentUser&&(l.a.currentUser.is_admin||l.a.currentUser.is_nat||l.a.currentUser.is_bng),i="pending"===this.props.beatmapset.status&&this.props.beatmapset.nominations&&Object(b.a)(this.props.beatmapset.nominations,"current")>0&&e;return t&&s?confirm(osu.trans("beatmaps.nominations.reset_confirm.disqualify")):!r||!i||confirm(osu.trans("beatmaps.nominations.reset_confirm.nomination_reset"))}}),Object.defineProperty(this,"sortedBeatmaps",{enumerable:!0,configurable:!0,writable:!0,value:()=>{if(null==this.cache.sortedBeatmaps){const e=a.filter(this.props.beatmaps,this.isCurrentBeatmap);this.cache.sortedBeatmaps=Object(h.i)(e)}return this.cache.sortedBeatmaps}}),Object.defineProperty(this,"updateDrafts",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.cache.draftEmbeds=this.state.value.filter(e=>"embed"===e.type&&!e.discussion_id)}}),Object.defineProperty(this,"withNormalization",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const{insertData:t,normalizeNode:s}=e;return e.insertData=s=>{Object(y.b)(this.slateEditor)?e.insertText(s.getData("text/plain")):t(s)},e.normalizeNode=t=>{const[r,i]=t;if(u.b.isElement(r)&&"embed"===r.type)for(const[s,n]of u.c.children(e,i)){if(u.b.isElement(s)&&!e.isInline(s))return void u.h.unwrapNodes(e,{at:n});if(s.bold||s.italic)return void u.h.unsetNodes(e,["bold","italic"],{at:n});if(null!=r.beatmapId){const t="number"==typeof r.beatmapId?this.props.beatmaps[r.beatmapId]:void 0;null!=t&&null==t.deleted_at||u.h.setNodes(e,{beatmapId:void 0},{at:i})}}s(t)},e}}),this.slateEditor=this.withNormalization(Object(d.a)(Object(p.d)(Object(u.i)()))),this.scrollContainerRef=c.createRef(),this.toolbarRef=c.createRef(),this.insertMenuRef=c.createRef(),this.localStorageKey=`newDiscussion-${this.props.beatmapset.id}`;let s=this.emptyDocTemplate;if(t.editMode)s=this.valueFromProps();else{const e=localStorage.getItem(this.localStorageKey);if(null!=e)try{s=JSON.parse(e)}catch(i){console.error("invalid json in localStorage, ignoring"),localStorage.removeItem(this.localStorageKey)}}this.state={blockCount:Object(y.a)(s),posting:!1,value:s}}get canSave(){return!this.state.posting&&this.state.blockCount<=this.context.max_blocks}componentDidMount(){this.scrollContainerRef.current&&(this.toolbarRef.current&&this.toolbarRef.current.setScrollContainer(this.scrollContainerRef.current),this.insertMenuRef.current&&this.insertMenuRef.current.setScrollContainer(this.scrollContainerRef.current))}componentDidUpdate(e){if(this.props.document!==e.document){const e=this.valueFromProps();this.setState({blockCount:Object(y.a)(e),value:e})}}componentWillUnmount(){this.xhr&&this.xhr.abort()}componentWillUpdate(){this.cache={}}render(){const e="beatmap-discussion-editor",t=this.props.editMode?["edit-mode"]:[];return this.state.posting&&t.push("readonly"),this.updateDrafts(),c.createElement("div",{className:Object(f.a)(e,t)},c.createElement("div",{className:`${e}__content`},c.createElement(E.a.Provider,{value:this.slateEditor},c.createElement(p.c,{editor:this.slateEditor,onChange:this.onChange,value:this.state.value},c.createElement("div",{ref:this.scrollContainerRef,className:`${e}__input-area`},c.createElement(w.a,{ref:this.toolbarRef}),c.createElement(_.a,{ref:this.insertMenuRef,currentBeatmap:this.props.currentBeatmap}),c.createElement(v.a.Provider,{value:this.cache.draftEmbeds||[]},c.createElement(p.a,{decorate:this.decorateTimestamps,onKeyDown:this.onKeyDown,placeholder:osu.trans("beatmaps.discussions.message_placeholder.review"),readOnly:this.state.posting,renderElement:this.renderElement,renderLeaf:this.renderLeaf}))),this.props.editMode&&c.createElement("div",{className:`${e}__inner-block-count`},this.renderBlockCount("lighter")),!this.props.editMode&&c.createElement("div",{className:`${e}__button-bar`},c.createElement("button",{className:"btn-osu-big btn-osu-big--forum-secondary",disabled:this.state.posting,onClick:this.resetInput,type:"button"},osu.trans("common.buttons.clear")),c.createElement("div",null,c.createElement("span",{className:`${e}__block-count`},this.renderBlockCount()),c.createElement("button",{className:"btn-osu-big btn-osu-big--forum-primary",disabled:!this.canSave,onClick:this.post,type:"submit"},this.state.posting?c.createElement(m.a,null):osu.trans("common.buttons.post"))))))))}valueFromProps(){return this.props.editing&&null!=this.props.document&&null!=this.props.discussions?Object(O.a)(this.props.document,this.props.discussions):[]}}Object.defineProperty(P,"contextType",{enumerable:!0,configurable:!0,writable:!0,value:j.a}),Object.defineProperty(P,"defaultProps",{enumerable:!0,configurable:!0,writable:!0,value:{editing:!1}})}).call(this,s("5wds"))},ukW2:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var r,i=s("/G9H"),n=s("I8Ok"),o=s("vZz4");i.createElement,r="beatmap-discussion-system-post";var a=function(e){var t,s;return t=function(){switch(e.post.message.type){case"resolved":return osu.trans("beatmap_discussions.system.resolved."+e.post.message.value,{user:Object(o.f)(laroute.route("users.show",{user:e.user.id}),e.user.username,{classNames:[r+"__user"]})})}}(),s=r+" "+r+"--"+e.post.message.type,e.post.deleted_at&&(s+=" "+r+"--deleted"),Object(n.div)({className:s},Object(n.div)({className:r+"__content",dangerouslySetInnerHTML:{__html:t}}))}},vZz4:function(e,t,s){"use strict";s.d(t,"j",(function(){return c})),s.d(t,"a",(function(){return u})),s.d(t,"b",(function(){return d})),s.d(t,"c",(function(){return p})),s.d(t,"d",(function(){return m})),s.d(t,"e",(function(){return h})),s.d(t,"h",(function(){return b})),s.d(t,"f",(function(){return f})),s.d(t,"g",(function(){return v})),s.d(t,"i",(function(){return g})),s.d(t,"k",(function(){return y}));var r=s("0h6b"),i=s("Hs9Z"),n=s("is6n"),o=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(s[r[i]]=e[r[i]])}return s};const a=["admin","api/v2","beatmaps","beatmapsets","client-verifications","comments","community","help","home","groups","legal","multiplayer","notifications","oauth","rankings","scores","session","store","users","wiki"].join("|"),l=RegExp(`^/(?:${a})(?:$|/|#)`),c=/(https?:\/\/((?:(?:[a-z0-9]\.|[a-z0-9][a-z0-9-]*[a-z0-9]\.)*[a-z][a-z0-9-]*[a-z0-9](?::\d+)?)(?:(?:(?:\/+(?:[a-z0-9$_.+!*',;:@&=-]|%[0-9a-f]{2})*)*(?:\?(?:[a-z0-9$_.+!*',;:@&=-]|%[0-9a-f]{2})*)?)?(?:#(?:[a-z0-9$_.+!*',;:@&=/?-]|%[0-9a-f]{2})*)?)?(?:[^.,:\s])))/gi;function u(e){return`osu://b/${e}`}function d(e){return`osu://s/${e}`}function p(e){return Object(r.route)("changelog.build",{build:e.version,stream:e.update_stream.name})}function m(e){return e.isHTML()||Object(i.startsWith)(e.getPath(),"/home/changelog/")}function h(e){return l.test(e.getPath())}function b(e){return`osu://edit/${e}`}function f(e,t,s){(null==s?void 0:s.unescape)&&(e=unescape(e),t=unescape(t));const r=document.createElement("a");if(r.textContent=t,r.setAttribute("href",e),null!=s&&(s.isRemote&&r.setAttribute("data-remote","1"),null!=s.classNames&&(r.className=s.classNames.join(" ")),null!=s.props)){const e=s.props,{className:t}=e,i=o(e,["className"]);null!=t&&(r.className=t);for(const[s,n]of Object.entries(i))null!=n&&r.setAttribute(s,n)}return r.outerHTML}function v(e,t=!1){return e.replace(c,`<a href="$1" rel="nofollow noreferrer"${t?' target="_blank"':""}>$2</a>`)}function g(e,t){const s=Object(n.a)(),r=new URL(null!=e?e:s.href,s.origin);for(const[i,n]of Object.entries(t))null!=n?r.searchParams.set(i,n):r.searchParams.delete(i);return r.href}function y(e,t){return Object(r.route)("wiki.show",{locale:null!=t?t:currentLocale,path:"WIKI_PATH"}).replace("WIKI_PATH",encodeURI(e))}},va1x:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return c}));var r=s("bpgk"),i=s("WLnA"),n=s("UZmH"),o=s("0h6b"),a=s("lv9K"),l=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let c=class{constructor(e){Object.defineProperty(this,"beatmapsetStore",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"recommendedDifficulties",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"resultSets",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"xhr",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object(a.p)(this)}cancel(){this.xhr&&this.xhr.abort()}get(e,t=0){if(t<0)throw Error("from must be > 0");const s=e.toKeyString(),r=this.getOrCreate(s);return t>0&&t<r.beatmapsetIds.size||0===t&&!r.isExpired?Promise.resolve(r):this.fetch(e,t).then(s=>(null!=s&&Object(a.u)(()=>{0===t&&r.reset(),this.updateBeatmapsetStore(s),r.append(s),this.recommendedDifficulties.set(e.mode,s.recommended_difficulty)}),r))}getResultSet(e){const t=e.toKeyString();return this.getOrCreate(t)}handleDispatchAction(e){e instanceof r.a&&this.clear()}initialize(e,t){this.updateBeatmapsetStore(t);const s=e.toKeyString(),r=this.getOrCreate(s);null==r.fetchedAt&&(r.append(t),this.recommendedDifficulties.set(e.mode,t.recommended_difficulty))}clear(){this.resultSets.clear(),this.recommendedDifficulties.clear()}fetch(t,s){this.cancel();const r=t.queryParams,i=t.toKeyString(),n=this.getOrCreate(i).cursor;if(s>0)if(null!=n)r.cursor=n;else if(null===n)return Promise.resolve(null);const a=Object(o.route)("beatmapsets.search");return this.xhr=e.ajax(a,{data:r,dataType:"json",method:"get"}),this.xhr}getOrCreate(e){let t=this.resultSets.get(e);return null==t&&(t=new n.a,this.resultSets.set(e,t)),t}updateBeatmapsetStore(e){for(const t of e.beatmapsets)this.beatmapsetStore.update(t)}};l([a.q],c.prototype,"recommendedDifficulties",void 0),l([a.q],c.prototype,"resultSets",void 0),l([a.f],c.prototype,"get",null),l([a.f],c.prototype,"initialize",null),l([a.f],c.prototype,"clear",null),c=l([i.b],c)}).call(this,s("5wds"))},vcN5:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return o}));var r=s("/G9H"),i=s("WKXC"),n=s("cX0L");class o extends r.PureComponent{constructor(t){super(t),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"eventId",{enumerable:!0,configurable:!0,writable:!0,value:`portal-${Object(n.a)()}`}),Object.defineProperty(this,"addPortal",{enumerable:!0,configurable:!0,writable:!0,value:()=>document.body.appendChild(this.container)}),Object.defineProperty(this,"componentWillUnmount",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.removePortal(),e(document).off(`turbolinks:before-cache.${this.eventId}`)}}),Object.defineProperty(this,"removePortal",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.container.parentElement===document.body&&document.body.removeChild(this.container)}}),Object.defineProperty(this,"render",{enumerable:!0,configurable:!0,writable:!0,value:()=>Object(i.createPortal)(this.props.children,this.container)}),this.container=document.createElement("div")}componentDidMount(){this.addPortal(),e(document).on(`turbolinks:before-cache.${this.eventId}`,this.removePortal)}}}).call(this,s("5wds"))},vp2U:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var r=s("/G9H");function i(e){return null==e.score.best_id?r.createElement("span",{title:osu.trans("scores.status.non_best")},"-"):null==e.score.pp?r.createElement("span",{className:"fas fa-exclamation-triangle",title:osu.trans("scores.status.processing")}):r.createElement("span",{title:osu.formatNumber(e.score.pp)},osu.formatNumber(Math.round(e.score.pp)),e.suffix)}},vqG7:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var r=s("/G9H"),i=s("q7/B");function n({modifiers:e,stats:t,type:s}){var n;const o=`${s}_rank`,a=[];for(const r of null!==(n=t.variants)&&void 0!==n?n:[]){const e=r[o];if(null==e)continue;const t=osu.trans(`beatmaps.variant.${r.mode}.${r.variant}`),s=`#${osu.formatNumber(e)}`;a.push(`<div>${t}: ${s}</div>`)}const l=t[o];return r.createElement(i.a,{label:osu.trans(`users.show.rank.${s}_simple`),modifiers:e,value:r.createElement("div",{"data-html-title":a.join(""),title:""},null!=l?`#${osu.formatNumber(l)}`:"-")})}},w9NC:function(e,t,s){"use strict";(function(e,r,i){s.d(t,"a",(function(){return b}));var n,o,a=s("lv9K"),l=s("4QOX"),c=s("f4vq"),u=s("elBb"),d=s("cX0L"),p=function(e,t){return function(){return e.apply(t,arguments)}},m={}.hasOwnProperty,h=[].indexOf||function(e){for(var t=0,s=this.length;t<s;t++)if(t in this&&this[t]===e)return t;return-1};o=c.a.dataStore.uiState,n=e.createElement;var b=function(e){function t(e){var s,r;this.updateSort=p(this.updateSort,this),this.toggleFollow=p(this.toggleFollow,this),this.saveState=p(this.saveState,this),this.jsonStorageId=p(this.jsonStorageId,this),this.handleCommentUpdated=p(this.handleCommentUpdated,this),this.handleCommentsNew=p(this.handleCommentsNew,this),this.handleCommentsAdded=p(this.handleCommentsAdded,this),this.render=p(this.render,this),this.componentWillUnmount=p(this.componentWillUnmount,this),this.componentDidMount=p(this.componentDidMount,this),t.__super__.constructor.call(this,e),null!=e.commentableType&&null!=e.commentableId&&(null!=(s=Object(u.c)("json-comments-"+e.commentableType+"-"+e.commentableId,!0))&&(c.a.dataStore.updateWithCommentBundleJson(s),o.initializeWithCommentBundleJson(s)),null!=(r=Object(u.c)(this.jsonStorageId()))&&o.importCommentsUIState(r)),this.id="comments-"+Object(d.a)()}return function(e,t){for(var s in t)m.call(t,s)&&(e[s]=t[s]);function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype}(t,e),t.prototype.SORTS=["new","old","top"],t.prototype.componentDidMount=function(){return r.subscribe("comments:added."+this.id,this.handleCommentsAdded),r.subscribe("comments:new."+this.id,this.handleCommentsNew),r.subscribe("comments:sort."+this.id,this.updateSort),r.subscribe("comments:toggle-follow."+this.id,this.toggleFollow),r.subscribe("comment:updated."+this.id,this.handleCommentUpdated),r(document).on("turbolinks:before-cache."+this.id,this.saveState)},t.prototype.componentWillUnmount=function(){return r.unsubscribe("."+this.id),r(document).off("."+this.id)},t.prototype.render=function(){return n(l.a,null,(e=this,function(){var t;return(t=i.assign({},e.props.componentProps)).commentableId=e.props.commentableId,t.commentableType=e.props.commentableType,t.user=e.props.user,n(e.props.component,t)}));var e},t.prototype.handleCommentsAdded=function(e,t){return Object(a.u)((function(){return c.a.dataStore.updateWithCommentBundleJson(t),o.updateFromCommentsAdded(t)}))},t.prototype.handleCommentsNew=function(e,t){return Object(a.u)((function(){return c.a.dataStore.updateWithCommentBundleJson(t),o.updateFromCommentsNew(t)}))},t.prototype.handleCommentUpdated=function(e,t){return Object(a.u)((function(){return c.a.dataStore.updateWithCommentBundleJson(t),o.updateFromCommentUpdated(t)}))},t.prototype.jsonStorageId=function(){return"json-comments-manager-state-"+this.props.commentableType+"-"+this.props.commentableId},t.prototype.saveState=function(){if(null!=this.props.commentableType&&null!=this.props.commentableId)return Object(u.d)(this.jsonStorageId(),o.exportCommentsUIState())},t.prototype.toggleFollow=function(){var e;if(e={follow:{notifiable_type:this.props.commentableType,notifiable_id:this.props.commentableId,subtype:"comment"}},!o.comments.loadingFollow)return o.comments.loadingFollow=!0,r.ajax(laroute.route("follows.store"),{data:e,dataType:"json",method:o.comments.userFollow?"DELETE":"POST"}).always((function(){return o.comments.loadingFollow=!1})).done((function(){return o.comments.userFollow=!o.comments.userFollow})).fail((function(e,t){if("abort"!==t)return osu.ajaxError(e)}))},t.prototype.updateSort=function(e,t){var s,i;if(i=t.sort,this.props.commentableType&&this.props.commentableId&&!(h.call(this.SORTS,i)<0))return Object(a.u)((function(){return o.comments.loadingSort=i})),s={commentable_type:this.props.commentableType,commentable_id:this.props.commentableId,sort:i,parent_id:0},r.ajax(laroute.route("comments.index"),{data:s,dataType:"json"}).done((function(e){return c.a.userPreferences.set("comments_sort",i),Object(a.u)((function(){return c.a.dataStore.commentStore.flushStore(),c.a.dataStore.updateWithCommentBundleJson(e),o.initializeWithCommentBundleJson(e)}))})).always((function(){return Object(a.u)((function(){return o.comments.loadingSort=null}))}))},t}(e.PureComponent)}).call(this,s("/G9H"),s("5wds"),s("Hs9Z"))},x6t3:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return n}));var r=s("lv9K"),i=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class n{constructor(){Object.defineProperty(this,"privateIsDesktop",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"handleResize",{enumerable:!0,configurable:!0,writable:!0,value:()=>{this.privateIsDesktop=window.matchMedia("(min-width: 900px)").matches;const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`)}}),this.handleResize(),Object(r.p)(this),e(window).on("resize",this.handleResize)}get isDesktop(){return this.privateIsDesktop}get isMobile(){return!this.privateIsDesktop}}i([r.q],n.prototype,"privateIsDesktop",void 0),i([r.f],n.prototype,"handleResize",void 0)}).call(this,s("5wds"))},y2EG:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var r=s("Hs9Z"),i=s("lv9K"),n=s("71br"),o=s("5evE");var a=s("f4vq"),l=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class c{constructor(e,t){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"objectType",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"createdAtJson",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:Object(n.a)()}),Object.defineProperty(this,"isDeleting",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isMarkingAsRead",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isRead",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"objectId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sourceUserId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"updateFromJson",{enumerable:!0,configurable:!0,writable:!0,value:e=>{var t,s;return this.createdAtJson=e.created_at,this.isRead=e.is_read,this.name=e.name,this.objectId=e.object_id,this.sourceUserId=e.source_user_id,this.details=Object(n.a)(),"object"==typeof e.details&&(Object(r.forEach)(e.details,(e,t)=>{this.details[Object(r.camelCase)(t)]=e}),"comment_new"===e.name&&(null===(t=e.details.reply_to)||void 0===t?void 0:t.user_id)===(null===(s=a.a.currentUser)||void 0===s?void 0:s.id)&&(this.name="comment_reply")),this}}),Object(i.p)(this)}get canMarkRead(){return this.id>0&&!this.isRead}get category(){var e;return Object(o.a)(null!==(e=this.name)&&void 0!==e?e:"")}get categoryGroupKey(){return Object(o.b)(this)}get displayType(){return"legacy_pm"===(e=this).name?"legacy_pm":null!=e.objectType&&null!=e.objectId?"user_achievement_unlock"===e.name?"user_achievement":e.objectType:void 0;var e}get identity(){return{category:this.category,id:this.id,objectId:this.objectId,objectType:this.objectType}}get stackId(){return`${this.objectType}-${this.objectId}-${this.category}`}get title(){var e;return a.a.userPreferences.get("beatmapset_title_show_original")&&null!==(e=osu.presence(this.details.titleUnicode))&&void 0!==e?e:this.details.title}static fromJson(e){return new c(e.id,e.object_type).updateFromJson(e)}}l([i.q],c.prototype,"isDeleting",void 0),l([i.q],c.prototype,"isMarkingAsRead",void 0),l([i.q],c.prototype,"isRead",void 0),l([i.h],c.prototype,"canMarkRead",null),l([i.h],c.prototype,"category",null),l([i.h],c.prototype,"categoryGroupKey",null),l([i.h],c.prototype,"displayType",null),l([i.h],c.prototype,"stackId",null),l([i.h],c.prototype,"title",null)},yJmy:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var r=s("+AAq"),i=s("/G9H"),n=s("tSlR"),o=s("dTpI"),a=s("TezV"),l=s("ss8h");class c extends i.Component{constructor(){super(...arguments),Object.defineProperty(this,"select",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t="all"!==e?parseInt(e,10):void 0,s=o.b.findPath(this.context,this.props.element);n.h.setNodes(this.context,{beatmapId:t},{at:s})}})}render(){var e;const t=[];return t.push({icon:i.createElement("i",{className:"fas fa-fw fa-star-of-life"}),id:"all",label:osu.trans("beatmaps.discussions.mode.scopes.generalAll")}),this.props.beatmaps.forEach(e=>{e.deleted_at||t.push({icon:i.createElement(r.a,{beatmap:e,showTitle:!1}),id:e.id.toString(),label:e.version})}),i.createElement(a.a,{disabled:this.props.disabled,menuOptions:t,onSelect:this.select,selected:null===(e=this.props.element.beatmapId)||void 0===e?void 0:e.toString()})}}Object.defineProperty(c,"contextType",{enumerable:!0,configurable:!0,writable:!0,value:l.a})},yoRQ:function(e,t,s){"use strict";var r=s("KUml"),i=s("tnRH"),n=s("/G9H"),o=s("Ncbg"),a=s("mk7q"),l=s("peKF"),c=s("PVx+"),u=s("vZz4"),d=s("q7/B");function p({kudosu:e}){const t={amount:n.createElement("strong",{className:"profile-extra-entries__kudosu-amount"},osu.trans("users.show.extra.kudosu.entry.amount",{amount:osu.formatNumber(Math.abs(e.amount))})),giver:null==e.giver?osu.trans("users.deleted"):n.createElement("a",{href:e.giver.url},e.giver.username),post:null==e.post.url?e.post.title:n.createElement("a",{href:e.post.url},e.post.title)};return n.createElement("li",{className:"profile-extra-entries__item"},n.createElement("div",{className:"profile-extra-entries__detail"},n.createElement("div",{className:"profile-extra-entries__text"},n.createElement(a.a,{mappings:t,pattern:osu.trans(`users.show.extra.kudosu.entry.${e.model}.${e.action}`)}))),n.createElement("div",{className:"profile-extra-entries__time"},n.createElement(l.a,{dateTime:e.created_at,relative:!0})))}let m=class extends n.Component{render(){return n.createElement("div",{className:"page-extra"},n.createElement(i.a,{name:this.props.name,withEdit:this.props.withEdit}),n.createElement("div",{className:"kudosu-box"},n.createElement(d.a,{description:n.createElement(a.a,{mappings:{link:n.createElement("a",{href:Object(u.k)("Kudosu")},osu.trans("users.show.extra.kudosu.total_info.link"))},pattern:osu.trans("users.show.extra.kudosu.total_info._")}),label:osu.trans("users.show.extra.kudosu.total"),modifiers:"kudosu",value:osu.formatNumber(this.props.total)})),this.renderEntries())}renderEntries(){return 0===Object(c.d)(this.props.kudosu.items)?n.createElement("div",{className:"profile-extra-entries profile-extra-entries--kudosu"},osu.trans("users.show.extra.kudosu.entry.empty")):n.createElement("ul",{className:"profile-extra-entries profile-extra-entries--kudosu"},Array.isArray(this.props.kudosu.items)&&this.props.kudosu.items.map(e=>n.createElement(p,{key:e.id,kudosu:e})),n.createElement("li",{className:"profile-extra-entries__item"},n.createElement(o.a,Object.assign({},this.props.kudosu.pagination,{callback:this.props.onShowMore,modifiers:"profile-page"}))))}};m=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o}([r.b],m),t.a=m},yun6:function(e,t,s){"use strict";(function(e){s.d(t,"b",(function(){return u})),s.d(t,"a",(function(){return d})),s.d(t,"e",(function(){return p})),s.d(t,"d",(function(){return m})),s.d(t,"c",(function(){return h})),s.d(t,"f",(function(){return b})),s.d(t,"g",(function(){return f})),s.d(t,"h",(function(){return v})),s.d(t,"i",(function(){return g}));var r=s("kUxX"),i=s("dMN7"),n=s("hoYT"),o=s("Hs9Z"),a=s("f4vq"),l=s("elBb");const c=r.scaleLinear().domain([.1,1.25,2,2.5,3.3,4.2,4.9,5.8,6.7,7.7,9]).clamp(!0).range(["#4290FB","#4FC0FF","#4FFFD5","#7CFF4F","#F6F05C","#FF8068","#FF4E6F","#C645B8","#6563DE","#18158E","#000000"]).interpolate(r.interpolateRgb.gamma(2.2));function u(t){var s,r,a;if(null!=t.items){let a,c=null;const u=function(t){var s,r;null==_&&(_=null!==(s=Object(l.c)("json-recommended-star-difficulty-all"))&&void 0!==s?s:{},e(document).one("turbolinks:before-cache",()=>{_=null}));return null!==(r=_[t])&&void 0!==r?r:1}(null!==(s=t.mode)&&void 0!==s?s:n.a[0]);return t.items.forEach(e=>{const t=Math.abs(e.difficulty_rating-u);(function(e){return!Object(i.a)(e)||null==e.deleted_at&&!e.convert})(e)&&(null==a||t<a)&&(a=t,c=e)}),null!==(r=null!=c?c:o.last(t.items))&&void 0!==r?r:null}if(null==t.group)return null;const c=null==t.mode?y():[t.mode];for(const e of c){const s=u({items:null!==(a=t.group.get(e))&&void 0!==a?a:[],mode:e});if(null!=s)return s}return null}function d(e){var t;const s=null==e.mode?y():[e.mode];for(const r of s){const s=null===(t=e.group.get(r))||void 0===t?void 0:t.find(t=>t.id===e.id);if(null!=s)return s}return null}function p(e){return e<2?"easy":e<2.7?"normal":e<4?"hard":e<5.3?"insane":e<6.5?"expert":"expert-plus"}function m(e){return e<.1?"#AAAAAA":e>=9?"#000000":c(e)}function h(e){return a.a.userPreferences.get("beatmapset_title_show_original")?e.artist_unicode:e.artist}function b(e){return a.a.userPreferences.get("beatmapset_title_show_original")?e.title_unicode:e.title}function f(e){const t=o.groupBy(null!=e?e:[],"mode"),s=new Map;return n.a.forEach(e=>{var r;s.set(e,function(e){if(0===e.length)return[];if("mania"===e[0].mode)return o.orderBy(e,["convert","cs","difficulty_rating"],["desc","asc","asc"]);return o.orderBy(e,["convert","difficulty_rating"],["desc","asc"])}(null!==(r=t[e])&&void 0!==r?r:[]))}),s}function v(e){return"ranked"===e.status||"approved"===e.status}function g(e){return[...f(e).values()].flat()}function y(){var e;const t=null===(e=a.a.currentUser)||void 0===e?void 0:e.playmode;if(null==t||!n.a.includes(t))return n.a;const s=o.without(n.a,t);return s.unshift(t),s}let _=null}).call(this,s("5wds"))},zFzD:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return p}));var r=s("UZmH"),i=s("WD1s"),n=s("0h6b"),o=s("Hs9Z"),a=s("lv9K"),l=s("f4vq"),c=s("is6n"),u=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o},d=function(e,t,s,r){return new(s||(s=Promise))((function(i,n){function o(e){try{l(r.next(e))}catch(t){n(t)}}function a(e){try{l(r.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))};class p{constructor(e){Object.defineProperty(this,"beatmapsetSearch",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"advancedSearch",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"currentResultSet",{enumerable:!0,configurable:!0,writable:!0,value:new r.a}),Object.defineProperty(this,"filters",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isExpanded",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"searchStatus",{enumerable:!0,configurable:!0,writable:!0,value:{error:null,from:0,state:"completed"}}),Object.defineProperty(this,"debouncedFilterChangedSearch",{enumerable:!0,configurable:!0,writable:!0,value:Object(o.debounce)(this.filterChangedSearch,500)}),Object.defineProperty(this,"filtersObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"initialErrorMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filterChangedHandler",{enumerable:!0,configurable:!0,writable:!0,value:e=>{"update"===e.type&&e.oldValue===e.newValue||"remove"!==e.type&&"sort"===e.name&&null==e.newValue||(this.searchStatus.state="input",this.debouncedFilterChangedSearch(),"query"!==e.name&&this.debouncedFilterChangedSearch.flush())}}),Object(a.p)(this)}get currentBeatmapsetIds(){return[...this.currentResultSet.beatmapsetIds]}get error(){return this.searchStatus.error}get hasMore(){return this.currentResultSet.hasMoreForPager}get isBusy(){return"searching"===this.searchStatus.state||"input"===this.searchStatus.state}get isPaging(){return"paging"===this.searchStatus.state}get isSupporterMissing(){var e,t;return!(null!==(t=null===(e=l.a.currentUser)||void 0===e?void 0:e.is_supporter)&&void 0!==t&&t)&&BeatmapsetFilter.supporterRequired(this.filters).length>0}get recommendedDifficulty(){return this.beatmapsetSearch.recommendedDifficulties.get(this.filters.mode)}get supporterRequiredFilterText(){const e=BeatmapsetFilter.supporterRequired(this.filters),t=Object(o.map)(e,e=>osu.trans(`beatmaps.listing.search.filters.${e}`));return osu.transArray(t)}cancel(){this.debouncedFilterChangedSearch.cancel(),this.beatmapsetSearch.cancel()}initialize(e){this.restoreStateFromUrl(),this.beatmapsetSearch.initialize(this.filters,e),this.initialErrorMessage=e.error}loadMore(){!this.isBusy&&this.hasMore&&this.search(this.currentResultSet.beatmapsetIds.size)}restoreTurbolinks(){this.restoreStateFromUrl(),this.search(0,!0),null!=this.initialErrorMessage&&(osu.popup(this.initialErrorMessage,"danger"),delete this.initialErrorMessage)}search(e=0,t=!1){return d(this,void 0,void 0,(function*(){if(this.isSupporterMissing||e<0)return void(this.searchStatus={error:null,from:e,restore:t,state:"completed"});let s;this.searchStatus={from:0,restore:t,state:0===e?"searching":"paging"};try{yield this.beatmapsetSearch.get(this.filters,e)}catch(r){s=0!==r.readyState?r:null}Object(a.u)(()=>{this.searchStatus={error:s,from:e,restore:t,state:"completed"},this.currentResultSet=this.beatmapsetSearch.getResultSet(this.filters)})}))}updateFilters(e){this.filters.update(e)}filterChangedSearch(){const t=Object(n.route)("beatmapsets.index",this.filters.queryParams);e.controller.advanceHistory(t),this.search()}restoreStateFromUrl(){const e=Object(c.a)().href,t=BeatmapsetFilter.filtersFromUrl(e);null!=this.filtersObserver&&this.filtersObserver(),this.filters=new i.a(e),this.filtersObserver=Object(a.r)(this.filters,this.filterChangedHandler),this.isExpanded=Object(o.intersection)(Object.keys(t),BeatmapsetFilter.expand).length>0}}u([a.q],p.prototype,"advancedSearch",void 0),u([a.q],p.prototype,"currentResultSet",void 0),u([a.q],p.prototype,"filters",void 0),u([a.q],p.prototype,"isExpanded",void 0),u([a.q],p.prototype,"searchStatus",void 0),u([a.h],p.prototype,"currentBeatmapsetIds",null),u([a.h],p.prototype,"error",null),u([a.h],p.prototype,"hasMore",null),u([a.h],p.prototype,"isBusy",null),u([a.h],p.prototype,"isPaging",null),u([a.h],p.prototype,"isSupporterMissing",null),u([a.h],p.prototype,"recommendedDifficulty",null),u([a.h],p.prototype,"supporterRequiredFilterText",null),u([a.f],p.prototype,"cancel",null),u([a.f],p.prototype,"loadMore",null),u([a.f],p.prototype,"restoreTurbolinks",null),u([a.f],p.prototype,"search",null),u([a.f],p.prototype,"updateFilters",null),u([a.f],p.prototype,"restoreStateFromUrl",null)}).call(this,s("dMdw"))},znlW:function(e,t,s){"use strict";var r=s("lv9K"),i=s("KUml"),n=s("f4vq"),o=s("VbpL"),a=s("L2k0"),l=s("0h6b"),c=s("7nlf"),u=s("BvKu"),d=s("/G9H"),p=s("hc33");function m(e){return d.createElement("div",{className:"btn-circle btn-circle--page-toggle btn-circle--page-toggle-detail",title:osu.trans("common.buttons.show_more_options")},d.createElement(u.a,null,t=>d.createElement("div",{className:"simple-menu"},d.createElement(c.a,{modifiers:"inline",onClick:t,userId:e.user.id,wrapperClass:"simple-menu__item"}),d.createElement(p.a,{className:"simple-menu__item",icon:!0,onFormClose:t,reportableId:e.user.id.toString(),reportableType:"user",user:e.user}))))}var h=s("HGQb");let b=class extends d.Component{render(){return d.createElement(d.Fragment,null,d.createElement("div",{className:"profile-detail-bar__entry"},d.createElement(o.a,{alwaysVisible:!0,followers:this.props.user.follower_count,modifiers:"profile-page",userId:this.props.user.id})),this.renderNonBotButtons())}renderNonBotButtons(){return this.props.user.is_bot?null:d.createElement(d.Fragment,null,d.createElement("div",{className:"profile-detail-bar__entry"},d.createElement(a.a,{alwaysVisible:!0,followers:this.props.user.mapping_follower_count,modifiers:"profile-page",showFollowerCounter:!0,userId:this.props.user.id})),(null==n.a.currentUser||n.a.currentUser.id!==this.props.user.id&&!Object(h.a)(this.props.user))&&d.createElement("div",{className:"profile-detail-bar__entry"},d.createElement("a",{className:"user-action-button user-action-button--profile-page",href:Object(l.route)("messages.users.show",{user:this.props.user.id}),title:osu.trans("users.card.send_message")},d.createElement("i",{className:"fas fa-envelope"}))),(e=this.props.user,null!=n.a.currentUser&&n.a.currentUser.id!==e.id&&d.createElement("div",{className:"profile-detail-bar__entry"},d.createElement(m,{user:this.props.user}))));var e}};var f=b=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o}([i.b],b),v=s("bTQa"),g=s("BOGZ"),y=s("jpbm"),_=s("vqG7"),w=s("thX6"),O=s("Q3zR"),j=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};let E=class extends d.Component{constructor(e){super(e),Object.defineProperty(this,"handleExpanderClick",{enumerable:!0,configurable:!0,writable:!0,value:()=>{n.a.userPreferences.set("ranking_expanded",!n.a.userPreferences.get("ranking_expanded"))}}),Object(r.p)(this)}get isExpanded(){return n.a.userPreferences.get("ranking_expanded")}render(){return d.createElement("div",{className:"profile-detail"},d.createElement("div",{className:"profile-detail-bar"},this.renderExpander(),d.createElement("div",{className:"profile-detail-bar__column"},d.createElement(f,{user:this.props.user})),d.createElement("div",{className:"profile-detail-bar__column profile-detail-bar__column--right"},this.renderUser(),this.renderModding())),this.renderExpandedDetails())}renderExpandedDetails(){return this.props.user.is_bot||"user"!==this.props.type?null:d.createElement("div",{className:this.isExpanded?"":"hidden"},d.createElement("div",{className:"profile-detail__row profile-detail__row--top"},d.createElement("div",{className:"profile-detail__col profile-detail__col--top-left"},d.createElement("div",{className:"profile-detail__top-left-item"},d.createElement(g.a,{stats:this.props.stats})),d.createElement("div",{className:"profile-detail__top-left-item"},d.createElement(v.a,{userAchievements:this.props.userAchievements})),d.createElement("div",{className:"profile-detail__top-left-item"},d.createElement(y.a,{stats:this.props.stats}))),d.createElement("div",{className:"profile-detail__col"},d.createElement(O.a,{stats:this.props.stats}))),d.createElement("div",{className:"profile-detail__row"},d.createElement("div",{className:"profile-detail__col profile-detail__col--bottom-left"},this.props.stats.is_ranked?d.createElement(w.a,{rankHistory:this.props.user.rank_history,stats:this.props.stats}):d.createElement("div",{className:"profile-detail__empty-chart"},osu.trans("users.show.extra.unranked"))),d.createElement("div",{className:"profile-detail__col profile-detail__col--bottom-right"},d.createElement("div",{className:"profile-detail__bottom-right-item"},d.createElement(_.a,{modifiers:"large",stats:this.props.stats,type:"global"})),d.createElement("div",{className:"profile-detail__bottom-right-item"},d.createElement(_.a,{stats:this.props.stats,type:"country"})))))}renderExpander(){if(this.props.user.is_bot||"user"!==this.props.type)return null;const e=this.isExpanded?"fas fa-chevron-up":"fas fa-chevron-down";return d.createElement("div",{className:"profile-detail-bar__page-toggle"},d.createElement("button",{className:"btn-circle btn-circle--page-toggle",onClick:this.handleExpanderClick,title:osu.trans(`common.buttons.${this.isExpanded?"collapse":"expand"}`)},d.createElement("span",{className:e})))}renderModding(){return this.props.user.is_bot||"modding"!==this.props.type?null:d.createElement(d.Fragment,null,d.createElement("div",{className:"profile-detail-bar__entry"},d.createElement(_.a,{stats:this.props.stats,type:"global"})),d.createElement("div",{className:"profile-detail-bar__entry"},d.createElement(_.a,{stats:this.props.stats,type:"country"})),d.createElement("div",{className:"profile-detail-bar__entry profile-detail-bar__entry--level"},d.createElement("div",{className:"profile-detail-bar__level",title:osu.trans("users.show.stats.level",{level:this.props.stats.level.current})},this.props.stats.level.current)))}renderUser(){return this.props.user.is_bot||"user"!==this.props.type?null:d.createElement(d.Fragment,null,this.isExpanded?d.createElement("div",{className:"profile-detail-bar__entry profile-detail-bar__entry--level-progress hidden-xs",title:osu.trans("users.show.stats.level_progress")},d.createElement("div",{className:"bar bar--user-profile"},d.createElement("div",{className:"bar__fill",style:{width:`${this.props.stats.level.progress}%`}}),d.createElement("div",{className:"bar__text"},`${this.props.stats.level.progress}%`))):d.createElement(d.Fragment,null,d.createElement("div",{className:"profile-detail-bar__entry hidden-xs"},d.createElement(_.a,{stats:this.props.stats,type:"global"})),d.createElement("div",{className:"profile-detail-bar__entry hidden-xs"},d.createElement(_.a,{stats:this.props.stats,type:"country"}))),d.createElement("div",{className:"profile-detail-bar__entry profile-detail-bar__entry--level"},d.createElement("div",{className:"profile-detail-bar__level",title:osu.trans("users.show.stats.level",{level:this.props.stats.level.current})},this.props.stats.level.current)))}};j([r.h],E.prototype,"isExpanded",null),E=j([i.b],E);t.a=E},zr5c:function(e,t,s){"use strict";s.d(t,"a",(function(){return u}));var r=s("sHNI"),i=s("/G9H"),n=s("tSlR"),o=s("dTpI"),a=s("TezV"),l=s("ss8h");const c=["praise","problem","suggestion"];class u extends i.Component{constructor(){super(...arguments),Object.defineProperty(this,"select",{enumerable:!0,configurable:!0,writable:!0,value:e=>{const t=o.b.findPath(this.context,this.props.element);n.h.setNodes(this.context,{discussionType:e},{at:t})}})}render(){const e=c.map(e=>({icon:i.createElement("span",{className:`beatmap-discussion-message-type beatmap-discussion-message-type--${e}`},i.createElement("i",{className:r.a[e]})),id:e,label:osu.trans(`beatmaps.discussions.message_type.${e}`)}));return i.createElement(a.a,{disabled:this.props.disabled,menuOptions:e,onSelect:this.select,selected:this.props.element.discussionType})}}Object.defineProperty(u,"contextType",{enumerable:!0,configurable:!0,writable:!0,value:l.a})},zrLC:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return l}));var r=s("ueqr"),i=s("0h6b"),n=s("lv9K"),o=s("/jJF"),a=function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o};class l{constructor(){Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"updatingOptions",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.current=Object.assign({},r.a,this.fromStorage()),Object(n.p)(this)}get(e){return this.current[e]}set(t,s){if(this.current[t]!==s&&(this.current[t]=s,localStorage.userPreferences=JSON.stringify(this.current),null!=this.user))return this.updatingOptions=!0,e.ajax(Object(i.route)("account.options"),{data:{user_profile_customization:{[t]:s}},dataType:"JSON",method:"PUT"}).done(t=>{e.publish("user:update",t)}).fail(Object(o.c)()).always(()=>{this.updatingOptions=!1})}setUser(e){this.user=e,null==e||this.updatingOptions||(this.current=null==e?void 0:e.user_preferences)}fromStorage(){try{const e=JSON.parse(localStorage.userPreferences);if(null!=e&&"object"==typeof e)return e}catch(e){}return{}}}a([n.q],l.prototype,"current",void 0),a([n.f],l.prototype,"set",null),a([n.f],l.prototype,"setUser",null)}).call(this,s("5wds"))}}]);
//# sourceMappingURL=commons.6612e33d.js.map